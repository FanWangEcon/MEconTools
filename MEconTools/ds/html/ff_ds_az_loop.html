
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>FF_DS_AZ_LOOP (Looped Discrete Choice) Dynamic Savings Distribution</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-07-23"><meta name="DC.source" content="ff_ds_az_loop.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>FF_DS_AZ_LOOP (Looped Discrete Choice) Dynamic Savings Distribution</h1><!--introduction--><pre>  For the AZ model, dynamic savings with Shocks. Looped distributional
  solution for discrete asset choices. Policy function maps to
  state-space. Given Shock transition and policy function, the model
  generates various joint discrete random variables. Distributions over
  consumption, savings, cash-on-hand, income, etc...</pre><pre>  This function assumes that savings choices are on the savings grid.</pre><pre>  * MP_PARAMS controls model preference, prices, shock and asset grid
  parameters.
  * MP_SUPPORT controls convergence criterion, printing and summary
  controls</pre><pre>  % Some MP_PARAMS that can be modified, see below
  mp_params = containers.Map('KeyType','char', 'ValueType','any');
  mp_params('fl_crra') = 1.5;
  mp_params('fl_beta') = 0.95;
  mp_params('fl_w') = 1.05;
  mp_params('fl_r') = 0.03;
  mp_params('it_a_n') = 25;
  mp_params('it_z_n') = 5;</pre><pre>  mp_support = containers.Map('KeyType','char', 'ValueType','any');
  mp_support('it_maxiter_ds') = 500;
  mp_support('fl_tol_ds') = 10e-5;
  % printer various information
  mp_support('bl_timer') = true;
  mp_support('bl_print_params') = false;
  mp_support('bl_print_iterinfo') = false;
  % These names must match keys of mp_solu: faz= joint distribution over
  a and z, fa=marginal distribution over a, fz= the statationary
  distribution of the z shock process, v=value, ap=savings choice,
  c=consumption, y=income, coh=cash-on-hand (income + savings),
  savefraccoh = ap/coh.
  % generate distributional mass for what faz joint mass, fa mass over
  savings, fz, mass over shocks
  mp_support('ls_dsout') = {'faz', 'fa', 'fz'};
  % Solution outcomes for statistics: must include ap for distribution
  mp_support('ls_slout') = {'ap', 'v', 'c', 'y', 'coh', 'savefraccoh'};
  % present which distribution: only faz is allowed
  mp_support_ext('ls_ddsna') = {'faz'};
  % which distributional outcomes to graph: faz or fa allowed
  mp_support_ext('ls_ddgrh') = {'faz', 'fa', 'fz'};</pre><pre>  [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP() default savings and shock
  model distributional simulation.</pre><pre>  [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS) change model
  parameters through MP_PARAMS</pre><pre>  [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS, MP_SUPPORT)
  change various printing, storaging, graphing, convergence etc controls
  through MP_SUPPORT</pre><pre>  [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS, MP_SUPPORT,
  MP_SUPPORT_GRAPH) also changing graphing options, see the
  FF_GRAPH_GRID function for what key value paris can be specified.</pre><pre>  [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS, MP_SUPPORT,
  MP_SUPPORT_GRAPH, MP_VALPOL) Solve the distributional problem given
  provided MP_VALPOL which is the map that is the output of VFI. This
  should generally not be called, the function should solve for value
  and policy function given new parameters.</pre><pre>  see also FX_DS_AZ_LOOP, FF_DS_AZ_CTS_LOOP, FF_DS_AZ_CTS_VEC,
  FF_GRAPH_GRID</pre><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Set Default and Parse Inputs</a></li><li><a href="#4">Default Model Parameters</a></li><li><a href="#5">Parse mp_params</a></li><li><a href="#6">Generate A and Z Grids</a></li><li><a href="#7">Default Support Parameters</a></li><li><a href="#8">Solve the Value Function</a></li><li><a href="#9">Initialize Matrix</a></li><li><a href="#10">Start Timer</a></li><li><a href="#11">Iterate and Get Distribution</a></li><li><a href="#12">Timer Stop</a></li><li><a href="#13">Results for Printing, and Graphing</a></li><li><a href="#14">Show Value Function Convergence Information</a></li><li><a href="#15">ls_ddcmd summary</a></li><li><a href="#16">ls_ddsna summarize full</a></li><li><a href="#17">ls_ffgrh graph</a></li><li><a href="#18">Store Results for Output</a></li><li><a href="#19">Distributional Statistics</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [mp_valpoldist_out, flag] = ff_ds_az_loop(varargin)
</pre><h2 id="3">Set Default and Parse Inputs</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(varargin))

    <span class="keyword">if</span> (length(varargin) == 1)
        [mp_params_ext] = varargin{:};
    <span class="keyword">elseif</span> (length(varargin) == 2)
        [mp_params_ext, mp_support_ext] = varargin{:};
    <span class="keyword">elseif</span> (length(varargin) == 3)
        [mp_params_ext, mp_support_ext, mp_support_graph_ext] = varargin{:};
    <span class="keyword">elseif</span> (length(varargin) == 4)
        [mp_params_ext, mp_support_ext, mp_support_graph_ext, mp_valpol] = varargin{:};
    <span class="keyword">end</span>

<span class="keyword">else</span>
    close <span class="string">all</span>;

    mp_params_ext = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
<span class="comment">%     mp_params_ext('solu_method') = 'bisec_vec';</span>
<span class="comment">%     mp_params_ext('solu_method') = 'mzoom_vec';</span>
    mp_params_ext(<span class="string">'solu_method'</span>) = <span class="string">'vec'</span>;

    mp_support_ext = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);

    mp_support_ext(<span class="string">'bl_timer'</span>) = true;
    mp_support_ext(<span class="string">'bl_print_params'</span>) = true;
    mp_support_ext(<span class="string">'bl_print_iterinfo'</span>) = true;

    <span class="comment">%savings, fz, mass over shocks</span>
    mp_support_ext(<span class="string">'ls_dsout'</span>) = {<span class="string">'faz'</span>, <span class="string">'fa'</span>, <span class="string">'fz'</span>};
    <span class="comment">% Solution outcomes for statistics: must include ap for distribution</span>
    mp_support_ext(<span class="string">'ls_slout'</span>) = {<span class="string">'ap'</span>, <span class="string">'v'</span>, <span class="string">'c'</span>, <span class="string">'y'</span>, <span class="string">'coh'</span>, <span class="string">'savefraccoh'</span>};
    <span class="comment">% outcome for ff_container_map_display</span>
    mp_support_ext(<span class="string">'ls_ddcmd'</span>) = {<span class="string">'faz'</span>, <span class="string">'fa'</span>, <span class="string">'fz'</span>};
    <span class="comment">% which distributional outcomes to graph</span>
    mp_support_ext(<span class="string">'ls_ddgrh'</span>) = {<span class="string">'faz'</span>, <span class="string">'fa'</span>, <span class="string">'fz'</span>};
    mp_support_ext(<span class="string">'ddcmd_opt_it_row_n_keep'</span>) = 75;
    mp_support_ext(<span class="string">'ddcmd_opt_it_col_n_keep'</span>) = 9;

<span class="keyword">end</span>
</pre><h2 id="4">Default Model Parameters</h2><p>Parameters for both VFI and Dist</p><pre class="codeinput">mp_params = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
mp_params(<span class="string">'solu_method'</span>) = <span class="string">'bisec'</span>;

mp_params(<span class="string">'fl_crra'</span>) = 1.5;
mp_params(<span class="string">'fl_beta'</span>) = 0.95;

mp_params(<span class="string">'fl_w'</span>) = 1.40;
mp_params(<span class="string">'fl_r'</span>) = 0.04;

mp_params(<span class="string">'fl_a_min'</span>) = 0;
mp_params(<span class="string">'fl_a_max'</span>) = 50;
mp_params(<span class="string">'it_a_n'</span>) = 100;
mp_params(<span class="string">'st_grid_type'</span>) = <span class="string">'grid_powerspace'</span>;

mp_params(<span class="string">'fl_z_persist'</span>) = 0.80;
mp_params(<span class="string">'fl_shk_std'</span>) = 0.20;
mp_params(<span class="string">'it_z_n'</span>) = 7;

<span class="comment">% override default support_map values</span>
<span class="keyword">if</span> (length(varargin)&gt;=1 || isempty(varargin))
    mp_params = [mp_params; mp_params_ext];
<span class="keyword">end</span>
</pre><h2 id="5">Parse mp_params</h2><pre class="codeinput">params_group = values(mp_params, {<span class="string">'solu_method'</span>});
[solu_method] = params_group{:};
params_group = values(mp_params, {<span class="string">'fl_a_min'</span>, <span class="string">'fl_a_max'</span>, <span class="string">'it_a_n'</span>, <span class="string">'st_grid_type'</span>});
[fl_a_min, fl_a_max, it_a_n, st_grid_type] = params_group{:};
params_group = values(mp_params, {<span class="string">'fl_z_persist'</span>, <span class="string">'fl_shk_std'</span>, <span class="string">'it_z_n'</span>});
[fl_z_persist, fl_shk_std, it_z_n] = params_group{:};
</pre><h2 id="6">Generate A and Z Grids</h2><p>Same min and max and grid points</p><pre class="codeinput">[ar_a] = ff_saveborr_grid(fl_a_min, fl_a_max, it_a_n, st_grid_type);
ar_a = ar_a';

<span class="comment">% shock vector and transition, normalize mean exp(shk) to 1</span>
[ar_z, mt_z_trans] = ffy_rouwenhorst(fl_z_persist, fl_shk_std, it_z_n);
<span class="comment">% [ar_z, mt_z_trans] = ffy_tauchen(fl_z_persist, fl_shk_std, it_z_n);</span>
<span class="comment">% normalize mean of exp to 1, fl_shk_std does not shift mean.</span>
ar_z_stationary = mt_z_trans^1000;
ar_z_stationary = ar_z_stationary(1,:);
fl_labor_agg = ar_z_stationary*exp(ar_z);
ar_z = exp(ar_z')/fl_labor_agg;
</pre><h2 id="7">Default Support Parameters</h2><p>support_map</p><pre class="codeinput">mp_support = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);

<span class="comment">% Iteration Control</span>
mp_support(<span class="string">'it_maxiter_ds'</span>) = 500;
mp_support(<span class="string">'fl_tol_ds'</span>) = 1e-5;

<span class="comment">% printer various information</span>
mp_support(<span class="string">'bl_timer'</span>) = true;
mp_support(<span class="string">'bl_print_params'</span>) = false;
mp_support(<span class="string">'bl_print_iterinfo'</span>) = false;

<span class="comment">% These names must match keys of mp_solu:</span>
<span class="comment">%savings, fz, mass over shocks</span>
mp_support(<span class="string">'ls_dsout'</span>) = {<span class="string">'faz'</span>, <span class="string">'fa'</span>};
<span class="comment">% Solution outcomes for statistics: must include ap for distribution</span>
mp_support(<span class="string">'ls_stout'</span>) = {<span class="string">'ap'</span>, <span class="string">'v'</span>, <span class="string">'c'</span>, <span class="string">'y'</span>, <span class="string">'coh'</span>, <span class="string">'savefraccoh'</span>};
<span class="comment">% outcome for ff_container_map_display</span>
mp_support(<span class="string">'ls_ddcmd'</span>) = {<span class="string">'faz'</span>, <span class="string">'fa'</span>, <span class="string">'fz'</span>};
<span class="comment">% present which distribution: only faz is allowed</span>
mp_support(<span class="string">'ls_ddsna'</span>) = {<span class="string">'faz'</span>};
<span class="comment">% which distributional outcomes to graph: faz or fa allowed</span>
mp_support(<span class="string">'ls_ddgrh'</span>) = {<span class="string">'faz'</span>, <span class="string">'fa'</span>};
mp_support(<span class="string">'ddcmd_opt_it_row_n_keep'</span>) = 10;
mp_support(<span class="string">'ddcmd_opt_it_col_n_keep'</span>) = 9;

<span class="comment">% override default support_map values</span>
<span class="keyword">if</span> (length(varargin)&gt;=2 || isempty(varargin))
    mp_support = [mp_support; mp_support_ext];
<span class="keyword">end</span>

<span class="comment">% Parse mp_support</span>
params_group = values(mp_support, {<span class="string">'it_maxiter_ds'</span>, <span class="string">'fl_tol_ds'</span>});
[it_maxiter_ds, fl_tol_ds] = params_group{:};
params_group = values(mp_support, {<span class="string">'bl_timer'</span>, <span class="string">'bl_print_iterinfo'</span>});
[bl_timer, bl_print_iterinfo] = params_group{:};
params_group = values(mp_support, {<span class="string">'ls_stout'</span>, <span class="string">'ls_dsout'</span>, <span class="string">'ls_ddcmd'</span>, <span class="string">'ls_ddsna'</span>, <span class="string">'ls_ddgrh'</span>, <span class="keyword">...</span>
    <span class="string">'ddcmd_opt_it_row_n_keep'</span>, <span class="string">'ddcmd_opt_it_col_n_keep'</span>});
[ls_stout, ls_dsout, ls_ddcmd, ls_ddsna, ls_ddgrh, <span class="keyword">...</span>
    ddcmd_opt_it_row_n_keep, ddcmd_opt_it_col_n_keep] = params_group{:};
</pre><h2 id="8">Solve the Value Function</h2><pre class="codeinput"><span class="keyword">if</span> (length(varargin) ~= 4)

    mp_support(<span class="string">'ls_slout'</span>) = mp_support(<span class="string">'ls_stout'</span>);

    <span class="keyword">if</span> (strcmp(solu_method, <span class="string">'bisec_loop'</span>))
        [mp_valpol] = ff_vfi_az_bisec_loop(mp_params, mp_support);
    <span class="keyword">elseif</span> (strcmp(solu_method, <span class="string">'bisec_vec'</span>))
        [mp_valpol] = ff_vfi_az_bisec_vec(mp_params, mp_support);
    <span class="keyword">elseif</span> (strcmp(solu_method, <span class="string">'mzoom_loop'</span>))
        [mp_valpol] = ff_vfi_az_mzoom_loop(mp_params, mp_support);
    <span class="keyword">elseif</span> (strcmp(solu_method, <span class="string">'mzoom_vec'</span>))
        [mp_valpol] = ff_vfi_az_mzoom_vec(mp_params, mp_support);
    <span class="keyword">elseif</span> (strcmp(solu_method, <span class="string">'loop'</span>))
        [mp_valpol] = ff_vfi_az_loop(mp_params, mp_support);
    <span class="keyword">elseif</span> (strcmp(solu_method, <span class="string">'vec'</span>))
        [mp_valpol] = ff_vfi_az_vec(mp_params, mp_support);
    <span class="keyword">end</span>
<span class="comment">%     params_group = values(mp_valpol_out, mp_support_ext('ls_slout'));</span>
<span class="comment">%     [ls_slout, ls_ffcmd, ls_ffsna, ls_ffgrh] = params_group{:};</span>

<span class="keyword">end</span>

mt_aprime = mp_valpol(<span class="string">'ap'</span>);
</pre><pre class="codeoutput">ff_vfi_az_bisec_loop, it_iter:1, fl_diff:34.289
ff_vfi_az_bisec_loop, it_iter:2, fl_diff:25.3225
ff_vfi_az_bisec_loop, it_iter:3, fl_diff:20.9288
ff_vfi_az_bisec_loop, it_iter:4, fl_diff:17.9361
ff_vfi_az_bisec_loop, it_iter:5, fl_diff:15.6881
ff_vfi_az_bisec_loop, it_iter:6, fl_diff:13.9099
ff_vfi_az_bisec_loop, it_iter:7, fl_diff:12.4557
ff_vfi_az_bisec_loop, it_iter:8, fl_diff:11.237
ff_vfi_az_bisec_loop, it_iter:9, fl_diff:10.1995
ff_vfi_az_bisec_loop, it_iter:10, fl_diff:9.3022
ff_vfi_az_bisec_loop, it_iter:11, fl_diff:8.5194
ff_vfi_az_bisec_loop, it_iter:12, fl_diff:7.8306
ff_vfi_az_bisec_loop, it_iter:13, fl_diff:7.2177
ff_vfi_az_bisec_loop, it_iter:14, fl_diff:6.6717
ff_vfi_az_bisec_loop, it_iter:15, fl_diff:6.184
ff_vfi_az_bisec_loop, it_iter:16, fl_diff:5.7438
ff_vfi_az_bisec_loop, it_iter:17, fl_diff:5.341
ff_vfi_az_bisec_loop, it_iter:18, fl_diff:4.9701
ff_vfi_az_bisec_loop, it_iter:19, fl_diff:4.6287
ff_vfi_az_bisec_loop, it_iter:20, fl_diff:4.3163
ff_vfi_az_bisec_loop, it_iter:21, fl_diff:4.0301
ff_vfi_az_bisec_loop, it_iter:22, fl_diff:3.7679
ff_vfi_az_bisec_loop, it_iter:23, fl_diff:3.5273
ff_vfi_az_bisec_loop, it_iter:24, fl_diff:3.3055
ff_vfi_az_bisec_loop, it_iter:25, fl_diff:3.1008
ff_vfi_az_bisec_loop, it_iter:26, fl_diff:2.9109
ff_vfi_az_bisec_loop, it_iter:27, fl_diff:2.7362
ff_vfi_az_bisec_loop, it_iter:28, fl_diff:2.5744
ff_vfi_az_bisec_loop, it_iter:29, fl_diff:2.4231
ff_vfi_az_bisec_loop, it_iter:30, fl_diff:2.2815
ff_vfi_az_bisec_loop, it_iter:31, fl_diff:2.1498
ff_vfi_az_bisec_loop, it_iter:32, fl_diff:2.0256
ff_vfi_az_bisec_loop, it_iter:33, fl_diff:1.9085
ff_vfi_az_bisec_loop, it_iter:34, fl_diff:1.7983
ff_vfi_az_bisec_loop, it_iter:35, fl_diff:1.6946
ff_vfi_az_bisec_loop, it_iter:36, fl_diff:1.5971
ff_vfi_az_bisec_loop, it_iter:37, fl_diff:1.5054
ff_vfi_az_bisec_loop, it_iter:38, fl_diff:1.4193
ff_vfi_az_bisec_loop, it_iter:39, fl_diff:1.3385
ff_vfi_az_bisec_loop, it_iter:40, fl_diff:1.2625
ff_vfi_az_bisec_loop, it_iter:41, fl_diff:1.1912
ff_vfi_az_bisec_loop, it_iter:42, fl_diff:1.1241
ff_vfi_az_bisec_loop, it_iter:43, fl_diff:1.0611
ff_vfi_az_bisec_loop, it_iter:44, fl_diff:1.002
ff_vfi_az_bisec_loop, it_iter:45, fl_diff:0.94638
ff_vfi_az_bisec_loop, it_iter:46, fl_diff:0.89412
ff_vfi_az_bisec_loop, it_iter:47, fl_diff:0.84489
ff_vfi_az_bisec_loop, it_iter:48, fl_diff:0.7985
ff_vfi_az_bisec_loop, it_iter:49, fl_diff:0.75475
ff_vfi_az_bisec_loop, it_iter:50, fl_diff:0.71346
ff_vfi_az_bisec_loop, it_iter:51, fl_diff:0.6745
ff_vfi_az_bisec_loop, it_iter:52, fl_diff:0.6377
ff_vfi_az_bisec_loop, it_iter:53, fl_diff:0.60297
ff_vfi_az_bisec_loop, it_iter:54, fl_diff:0.57016
ff_vfi_az_bisec_loop, it_iter:55, fl_diff:0.53917
ff_vfi_az_bisec_loop, it_iter:56, fl_diff:0.50992
ff_vfi_az_bisec_loop, it_iter:57, fl_diff:0.4823
ff_vfi_az_bisec_loop, it_iter:58, fl_diff:0.4562
ff_vfi_az_bisec_loop, it_iter:59, fl_diff:0.43154
ff_vfi_az_bisec_loop, it_iter:60, fl_diff:0.40825
ff_vfi_az_bisec_loop, it_iter:61, fl_diff:0.38625
ff_vfi_az_bisec_loop, it_iter:62, fl_diff:0.36545
ff_vfi_az_bisec_loop, it_iter:63, fl_diff:0.34581
ff_vfi_az_bisec_loop, it_iter:64, fl_diff:0.32724
ff_vfi_az_bisec_loop, it_iter:65, fl_diff:0.3097
ff_vfi_az_bisec_loop, it_iter:66, fl_diff:0.29313
ff_vfi_az_bisec_loop, it_iter:67, fl_diff:0.27746
ff_vfi_az_bisec_loop, it_iter:68, fl_diff:0.26265
ff_vfi_az_bisec_loop, it_iter:69, fl_diff:0.24866
ff_vfi_az_bisec_loop, it_iter:70, fl_diff:0.23542
ff_vfi_az_bisec_loop, it_iter:71, fl_diff:0.22292
ff_vfi_az_bisec_loop, it_iter:72, fl_diff:0.2111
ff_vfi_az_bisec_loop, it_iter:73, fl_diff:0.19992
ff_vfi_az_bisec_loop, it_iter:74, fl_diff:0.18935
ff_vfi_az_bisec_loop, it_iter:75, fl_diff:0.17935
ff_vfi_az_bisec_loop, it_iter:76, fl_diff:0.16989
ff_vfi_az_bisec_loop, it_iter:77, fl_diff:0.16094
ff_vfi_az_bisec_loop, it_iter:78, fl_diff:0.15248
ff_vfi_az_bisec_loop, it_iter:79, fl_diff:0.14447
ff_vfi_az_bisec_loop, it_iter:80, fl_diff:0.1369
ff_vfi_az_bisec_loop, it_iter:81, fl_diff:0.12974
ff_vfi_az_bisec_loop, it_iter:82, fl_diff:0.12295
ff_vfi_az_bisec_loop, it_iter:83, fl_diff:0.11654
ff_vfi_az_bisec_loop, it_iter:84, fl_diff:0.11046
ff_vfi_az_bisec_loop, it_iter:85, fl_diff:0.10471
ff_vfi_az_bisec_loop, it_iter:86, fl_diff:0.099265
ff_vfi_az_bisec_loop, it_iter:87, fl_diff:0.09411
ff_vfi_az_bisec_loop, it_iter:88, fl_diff:0.089228
ff_vfi_az_bisec_loop, it_iter:89, fl_diff:0.084606
ff_vfi_az_bisec_loop, it_iter:90, fl_diff:0.080229
ff_vfi_az_bisec_loop, it_iter:91, fl_diff:0.076083
ff_vfi_az_bisec_loop, it_iter:92, fl_diff:0.072155
ff_vfi_az_bisec_loop, it_iter:93, fl_diff:0.068435
ff_vfi_az_bisec_loop, it_iter:94, fl_diff:0.06491
ff_vfi_az_bisec_loop, it_iter:95, fl_diff:0.061571
ff_vfi_az_bisec_loop, it_iter:96, fl_diff:0.058406
ff_vfi_az_bisec_loop, it_iter:97, fl_diff:0.055408
ff_vfi_az_bisec_loop, it_iter:98, fl_diff:0.052566
ff_vfi_az_bisec_loop, it_iter:99, fl_diff:0.049872
ff_vfi_az_bisec_loop, it_iter:100, fl_diff:0.047319
ff_vfi_az_bisec_loop, it_iter:101, fl_diff:0.044899
ff_vfi_az_bisec_loop, it_iter:102, fl_diff:0.042604
ff_vfi_az_bisec_loop, it_iter:103, fl_diff:0.040429
ff_vfi_az_bisec_loop, it_iter:104, fl_diff:0.038366
ff_vfi_az_bisec_loop, it_iter:105, fl_diff:0.03641
ff_vfi_az_bisec_loop, it_iter:106, fl_diff:0.034556
ff_vfi_az_bisec_loop, it_iter:107, fl_diff:0.032797
ff_vfi_az_bisec_loop, it_iter:108, fl_diff:0.031129
ff_vfi_az_bisec_loop, it_iter:109, fl_diff:0.029546
ff_vfi_az_bisec_loop, it_iter:110, fl_diff:0.028046
ff_vfi_az_bisec_loop, it_iter:111, fl_diff:0.026622
ff_vfi_az_bisec_loop, it_iter:112, fl_diff:0.025271
ff_vfi_az_bisec_loop, it_iter:113, fl_diff:0.02399
ff_vfi_az_bisec_loop, it_iter:114, fl_diff:0.022774
ff_vfi_az_bisec_loop, it_iter:115, fl_diff:0.021621
ff_vfi_az_bisec_loop, it_iter:116, fl_diff:0.020527
ff_vfi_az_bisec_loop, it_iter:117, fl_diff:0.019488
ff_vfi_az_bisec_loop, it_iter:118, fl_diff:0.018503
ff_vfi_az_bisec_loop, it_iter:119, fl_diff:0.017567
ff_vfi_az_bisec_loop, it_iter:120, fl_diff:0.01668
ff_vfi_az_bisec_loop, it_iter:121, fl_diff:0.015838
ff_vfi_az_bisec_loop, it_iter:122, fl_diff:0.015038
ff_vfi_az_bisec_loop, it_iter:123, fl_diff:0.014279
ff_vfi_az_bisec_loop, it_iter:124, fl_diff:0.013559
ff_vfi_az_bisec_loop, it_iter:125, fl_diff:0.012876
ff_vfi_az_bisec_loop, it_iter:126, fl_diff:0.012227
ff_vfi_az_bisec_loop, it_iter:127, fl_diff:0.011611
ff_vfi_az_bisec_loop, it_iter:128, fl_diff:0.011026
ff_vfi_az_bisec_loop, it_iter:129, fl_diff:0.010471
ff_vfi_az_bisec_loop, it_iter:130, fl_diff:0.0099436
ff_vfi_az_bisec_loop, it_iter:131, fl_diff:0.0094432
ff_vfi_az_bisec_loop, it_iter:132, fl_diff:0.0089681
ff_vfi_az_bisec_loop, it_iter:133, fl_diff:0.0085171
ff_vfi_az_bisec_loop, it_iter:134, fl_diff:0.0080888
ff_vfi_az_bisec_loop, it_iter:135, fl_diff:0.0076822
ff_vfi_az_bisec_loop, it_iter:136, fl_diff:0.0072961
ff_vfi_az_bisec_loop, it_iter:137, fl_diff:0.0069295
ff_vfi_az_bisec_loop, it_iter:138, fl_diff:0.0065814
ff_vfi_az_bisec_loop, it_iter:139, fl_diff:0.0062508
ff_vfi_az_bisec_loop, it_iter:140, fl_diff:0.005937
ff_vfi_az_bisec_loop, it_iter:141, fl_diff:0.0056389
ff_vfi_az_bisec_loop, it_iter:142, fl_diff:0.0053558
ff_vfi_az_bisec_loop, it_iter:143, fl_diff:0.005087
ff_vfi_az_bisec_loop, it_iter:144, fl_diff:0.0048318
ff_vfi_az_bisec_loop, it_iter:145, fl_diff:0.0045894
ff_vfi_az_bisec_loop, it_iter:146, fl_diff:0.0043591
ff_vfi_az_bisec_loop, it_iter:147, fl_diff:0.0041405
ff_vfi_az_bisec_loop, it_iter:148, fl_diff:0.0039328
ff_vfi_az_bisec_loop, it_iter:149, fl_diff:0.0037356
ff_vfi_az_bisec_loop, it_iter:150, fl_diff:0.0035483
ff_vfi_az_bisec_loop, it_iter:151, fl_diff:0.0033705
ff_vfi_az_bisec_loop, it_iter:152, fl_diff:0.0032015
ff_vfi_az_bisec_loop, it_iter:153, fl_diff:0.0030411
ff_vfi_az_bisec_loop, it_iter:154, fl_diff:0.0028887
ff_vfi_az_bisec_loop, it_iter:155, fl_diff:0.0027439
ff_vfi_az_bisec_loop, it_iter:156, fl_diff:0.0026064
ff_vfi_az_bisec_loop, it_iter:157, fl_diff:0.0024758
ff_vfi_az_bisec_loop, it_iter:158, fl_diff:0.0023518
ff_vfi_az_bisec_loop, it_iter:159, fl_diff:0.002234
ff_vfi_az_bisec_loop, it_iter:160, fl_diff:0.0021221
ff_vfi_az_bisec_loop, it_iter:161, fl_diff:0.0020158
ff_vfi_az_bisec_loop, it_iter:162, fl_diff:0.0019149
ff_vfi_az_bisec_loop, it_iter:163, fl_diff:0.001819
ff_vfi_az_bisec_loop, it_iter:164, fl_diff:0.0017279
ff_vfi_az_bisec_loop, it_iter:165, fl_diff:0.0016414
ff_vfi_az_bisec_loop, it_iter:166, fl_diff:0.0015592
ff_vfi_az_bisec_loop, it_iter:167, fl_diff:0.0014812
ff_vfi_az_bisec_loop, it_iter:168, fl_diff:0.001407
ff_vfi_az_bisec_loop, it_iter:169, fl_diff:0.0013366
ff_vfi_az_bisec_loop, it_iter:170, fl_diff:0.0012697
ff_vfi_az_bisec_loop, it_iter:171, fl_diff:0.0012061
ff_vfi_az_bisec_loop, it_iter:172, fl_diff:0.0011458
ff_vfi_az_bisec_loop, it_iter:173, fl_diff:0.0010884
ff_vfi_az_bisec_loop, it_iter:174, fl_diff:0.001034
ff_vfi_az_bisec_loop, it_iter:175, fl_diff:0.00098221
ff_vfi_az_bisec_loop, it_iter:176, fl_diff:0.00093306
ff_vfi_az_bisec_loop, it_iter:177, fl_diff:0.00088637
ff_vfi_az_bisec_loop, it_iter:178, fl_diff:0.00084201
ff_vfi_az_bisec_loop, it_iter:179, fl_diff:0.00079988
ff_vfi_az_bisec_loop, it_iter:180, fl_diff:0.00075986
ff_vfi_az_bisec_loop, it_iter:181, fl_diff:0.00072184
ff_vfi_az_bisec_loop, it_iter:182, fl_diff:0.00068573
ff_vfi_az_bisec_loop, it_iter:183, fl_diff:0.00065142
ff_vfi_az_bisec_loop, it_iter:184, fl_diff:0.00061883
ff_vfi_az_bisec_loop, it_iter:185, fl_diff:0.00058787
ff_vfi_az_bisec_loop, it_iter:186, fl_diff:0.00055846
ff_vfi_az_bisec_loop, it_iter:187, fl_diff:0.00053053
ff_vfi_az_bisec_loop, it_iter:188, fl_diff:0.00050399
ff_vfi_az_bisec_loop, it_iter:189, fl_diff:0.00047878
ff_vfi_az_bisec_loop, it_iter:190, fl_diff:0.00045483
ff_vfi_az_bisec_loop, it_iter:191, fl_diff:0.00043208
ff_vfi_az_bisec_loop, it_iter:192, fl_diff:0.00041046
ff_vfi_az_bisec_loop, it_iter:193, fl_diff:0.00038993
ff_vfi_az_bisec_loop, it_iter:194, fl_diff:0.00037043
ff_vfi_az_bisec_loop, it_iter:195, fl_diff:0.0003519
ff_vfi_az_bisec_loop, it_iter:196, fl_diff:0.0003343
ff_vfi_az_bisec_loop, it_iter:197, fl_diff:0.00031758
ff_vfi_az_bisec_loop, it_iter:198, fl_diff:0.0003017
ff_vfi_az_bisec_loop, it_iter:199, fl_diff:0.00028661
ff_vfi_az_bisec_loop, it_iter:200, fl_diff:0.00027227
ff_vfi_az_bisec_loop, it_iter:201, fl_diff:0.00025866
ff_vfi_az_bisec_loop, it_iter:202, fl_diff:0.00024572
ff_vfi_az_bisec_loop, it_iter:203, fl_diff:0.00023343
ff_vfi_az_bisec_loop, it_iter:204, fl_diff:0.00022176
ff_vfi_az_bisec_loop, it_iter:205, fl_diff:0.00021067
ff_vfi_az_bisec_loop, it_iter:206, fl_diff:0.00020013
ff_vfi_az_bisec_loop, it_iter:207, fl_diff:0.00019012
ff_vfi_az_bisec_loop, it_iter:208, fl_diff:0.00018061
ff_vfi_az_bisec_loop, it_iter:209, fl_diff:0.00017158
ff_vfi_az_bisec_loop, it_iter:210, fl_diff:0.000163
ff_vfi_az_bisec_loop, it_iter:211, fl_diff:0.00015485
ff_vfi_az_bisec_loop, it_iter:212, fl_diff:0.00014711
ff_vfi_az_bisec_loop, it_iter:213, fl_diff:0.00013975
ff_vfi_az_bisec_loop, it_iter:214, fl_diff:0.00013276
ff_vfi_az_bisec_loop, it_iter:215, fl_diff:0.00012612
ff_vfi_az_bisec_loop, it_iter:216, fl_diff:0.00011982
ff_vfi_az_bisec_loop, it_iter:217, fl_diff:0.00011382
ff_vfi_az_bisec_loop, it_iter:218, fl_diff:0.00010813
ff_vfi_az_bisec_loop, it_iter:219, fl_diff:0.00010272
ff_vfi_az_bisec_loop, it_iter:220, fl_diff:9.7588e-05
ff_vfi_az_bisec_loop, it_iter:221, fl_diff:9.2708e-05
ff_vfi_az_bisec_loop, it_iter:222, fl_diff:8.8072e-05
ff_vfi_az_bisec_loop, it_iter:223, fl_diff:8.3668e-05
ff_vfi_az_bisec_loop, it_iter:224, fl_diff:7.9485e-05
ff_vfi_az_bisec_loop, it_iter:225, fl_diff:7.551e-05
ff_vfi_az_bisec_loop, it_iter:226, fl_diff:7.1734e-05
ff_vfi_az_bisec_loop, it_iter:227, fl_diff:6.8147e-05
ff_vfi_az_bisec_loop, it_iter:228, fl_diff:6.474e-05
ff_vfi_az_bisec_loop, it_iter:229, fl_diff:6.1502e-05
ff_vfi_az_bisec_loop, it_iter:230, fl_diff:5.8427e-05
ff_vfi_az_bisec_loop, it_iter:231, fl_diff:5.5505e-05
ff_vfi_az_bisec_loop, it_iter:232, fl_diff:5.273e-05
ff_vfi_az_bisec_loop, it_iter:233, fl_diff:5.0093e-05
ff_vfi_az_bisec_loop, it_iter:234, fl_diff:4.7589e-05
ff_vfi_az_bisec_loop, it_iter:235, fl_diff:4.5209e-05
ff_vfi_az_bisec_loop, it_iter:236, fl_diff:4.2948e-05
ff_vfi_az_bisec_loop, it_iter:237, fl_diff:4.0801e-05
ff_vfi_az_bisec_loop, it_iter:238, fl_diff:3.8761e-05
ff_vfi_az_bisec_loop, it_iter:239, fl_diff:3.6823e-05
ff_vfi_az_bisec_loop, it_iter:240, fl_diff:3.4981e-05
ff_vfi_az_bisec_loop, it_iter:241, fl_diff:3.3232e-05
ff_vfi_az_bisec_loop, it_iter:242, fl_diff:3.1571e-05
ff_vfi_az_bisec_loop, it_iter:243, fl_diff:2.9992e-05
ff_vfi_az_bisec_loop, it_iter:244, fl_diff:2.8492e-05
ff_vfi_az_bisec_loop, it_iter:245, fl_diff:2.7068e-05
ff_vfi_az_bisec_loop, it_iter:246, fl_diff:2.5714e-05
ff_vfi_az_bisec_loop, it_iter:247, fl_diff:2.4429e-05
ff_vfi_az_bisec_loop, it_iter:248, fl_diff:2.3207e-05
ff_vfi_az_bisec_loop, it_iter:249, fl_diff:2.2047e-05
ff_vfi_az_bisec_loop, it_iter:250, fl_diff:2.0944e-05
ff_vfi_az_bisec_loop, it_iter:251, fl_diff:1.9897e-05
ff_vfi_az_bisec_loop, it_iter:252, fl_diff:1.8902e-05
ff_vfi_az_bisec_loop, it_iter:253, fl_diff:1.7957e-05
ff_vfi_az_bisec_loop, it_iter:254, fl_diff:1.7059e-05
ff_vfi_az_bisec_loop, it_iter:255, fl_diff:1.6206e-05
ff_vfi_az_bisec_loop, it_iter:256, fl_diff:1.5396e-05
ff_vfi_az_bisec_loop, it_iter:257, fl_diff:1.4626e-05
ff_vfi_az_bisec_loop, it_iter:258, fl_diff:1.3895e-05
ff_vfi_az_bisec_loop, it_iter:259, fl_diff:1.32e-05
ff_vfi_az_bisec_loop, it_iter:260, fl_diff:1.254e-05
ff_vfi_az_bisec_loop, it_iter:261, fl_diff:1.1913e-05
ff_vfi_az_bisec_loop, it_iter:262, fl_diff:1.1317e-05
ff_vfi_az_bisec_loop, it_iter:263, fl_diff:1.0751e-05
ff_vfi_az_bisec_loop, it_iter:264, fl_diff:1.0214e-05
ff_vfi_az_bisec_loop, it_iter:265, fl_diff:9.7032e-06
ff_vfi_az_bisec_loop, it_iter:266, fl_diff:9.218e-06
Elapsed time is 0.183005 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_params Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                    i     idx    value
                    __    ___    _____

    fl_a_max         1     1       50 
    fl_a_min         2     2        0 
    fl_beta          3     3     0.95 
    fl_crra          4     4      1.5 
    fl_r             5     5     0.04 
    fl_shk_std       6     6      0.2 
    fl_w             7     7      1.4 
    fl_z_persist     8     8      0.8 
    it_a_n           9     9      100 
    it_z_n          10    10        7 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_params String
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                     i     idx          string      
                    ___    ____    _________________

    solu_method     "1"    "11"    "vec"            
    st_grid_type    "2"    "12"    "grid_powerspace"

pos = 15 ; key = ls_ddsna
    'faz'

pos = 17 ; key = ls_ffcmd
    'ap'

pos = 18 ; key = ls_ffgrh
pos = 19 ; key = ls_ffsna
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_support Scalars
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                               i     idx    value 
                               __    ___    ______

    bl_print_iterinfo           1     1          1
    bl_print_params             2     2          1
    bl_timer                    3     3          1
    ddcmd_opt_it_col_n_keep     4     4          9
    ddcmd_opt_it_row_n_keep     5     5         75
    ffsna_opt_it_col_n_keep     6     6          9
    ffsna_opt_it_row_n_keep     7     7         10
    fl_lowestc                  8     8     -1e+10
    fl_tol_ds                   9     9      1e-05
    fl_tol_val                 10    10      1e-05
    it_maxiter_ds              11    11        500
    it_maxiter_val             12    12        500

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_support String
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                 i     idx               string          
                ___    ____    __________________________

    ls_ddcmd    "1"    "13"    "faz;fa;fz"               
    ls_ddgrh    "2"    "14"    "faz;fa;fz"               
    ls_dsout    "3"    "16"    "faz;fa;fz"               
    ls_slout    "4"    "20"    "ap;v;c;y;coh;savefraccoh"
    ls_stout    "5"    "21"    "ap;v;c;y;coh;savefraccoh"

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Value Function Iteration Per Iteration Changes
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n): percentage of state space points conditional on shock where the policy function is changing across iterations
                  valgap      polgap     z_0_41816    z_0_54897    z_0_72069    z_0_94612    z_1_2421    z_1_6306    z_2_1407
                __________    _______    _________    _________    _________    _________    ________    ________    ________

    iter=1          34.289          0         0            0            0            0            0           0           0  
    iter=2          25.322      277.4      0.92         0.92         0.94            1            1           1           1  
    iter=3          20.929     92.733      0.85         0.84         0.87            1            1           1           1  
    iter=4          17.936     46.304      0.73         0.85         0.84         0.89            1           1           1  
    iter=5          15.688     27.525      0.74         0.72         0.78         0.84         0.85        0.99           1  
    iter=6           13.91     18.948       0.6         0.57         0.66         0.68         0.78        0.83        0.92  
    iter=7          12.456     13.255      0.44         0.44          0.5         0.54         0.56        0.66        0.69  
    iter=8          11.237     10.001      0.26         0.26         0.33         0.38         0.49        0.54        0.58  
    iter=9            10.2     8.3459      0.22         0.28         0.27         0.29         0.33        0.35        0.45  
    iter=10         9.3022     6.4369      0.11         0.26         0.19         0.26         0.29        0.29        0.36  
    iter=11         8.5194     6.7961      0.12         0.21         0.16         0.19         0.19        0.26        0.28  
    iter=12         7.8306     4.0701      0.23         0.09         0.08         0.12          0.2        0.27        0.22  
    iter=13         7.2177     4.2137      0.13          0.1         0.09         0.16         0.17        0.15        0.23  
    iter=14         6.6717     4.2145      0.11          0.1         0.08         0.13         0.09        0.12         0.2  
    iter=15          6.184     4.3187       0.1         0.09         0.07         0.08         0.12        0.14        0.15  
    iter=16         5.7438      3.992      0.09         0.03            0         0.05         0.09        0.13        0.12  
    iter=17          5.341     2.6714         0            0            0         0.08         0.11        0.11        0.09  
    iter=18         4.9701     2.4872         0         0.01            0         0.06         0.08        0.06        0.08  
    iter=19         4.6287     2.6982         0            0         0.12         0.07         0.09        0.06        0.08  
    iter=20         4.3163     2.4189      0.01            0         0.15         0.07         0.04        0.05        0.04  
    iter=21         4.0301     2.7372         0            0         0.09         0.06         0.02        0.09        0.12  
    iter=22         3.7679     3.4505         0            0         0.09         0.06         0.03        0.04        0.07  
    iter=23         3.5273     2.6704         0            0         0.08         0.01         0.03        0.05        0.02  
    iter=24         3.3055     3.0985         0            0         0.08            0         0.03        0.04        0.04  
    iter=25         3.1008     2.4261         0         0.01         0.05         0.01         0.01        0.02        0.05  
    iter=26         2.9109     2.7049         0          0.1            0            0         0.03        0.07        0.02  
    iter=27         2.7362     4.4409         0         0.21            0         0.01         0.02        0.05        0.02  
    iter=28         2.5744     2.2918         0         0.05         0.01         0.01         0.03        0.02        0.02  
    iter=29         2.4231     2.1533         0         0.02            0            0         0.02        0.04        0.04  
    iter=30         2.2815     4.3567      0.15         0.01            0            0         0.02        0.03        0.01  
    iter=31         2.1498     2.4368      0.07         0.01            0            0         0.02        0.01        0.03  
    iter=32         2.0256     1.5316      0.03         0.01            0            0         0.02           0        0.03  
    iter=33         1.9085     1.2249      0.02         0.01            0            0         0.02        0.01        0.02  
    iter=34         1.7983     1.2729      0.01            0         0.01            0         0.02           0        0.02  
    iter=35         1.6946     1.3216      0.01         0.01            0            0         0.02        0.01           0  
    iter=36         1.5971      1.017      0.01            0            0            0         0.01           0        0.03  
    iter=37         1.5054     1.6114      0.01         0.02            0            0         0.02        0.02        0.01  
    iter=38         1.4193     1.6916         0            0            0            0         0.02           0        0.02  
    iter=39         1.3385     1.0491      0.01            0            0            0         0.01           0        0.01  
    iter=40         1.2625     1.5221         0            0            0            0         0.02        0.01        0.02  
    iter=41         1.1912     1.5737      0.01         0.01            0         0.01         0.02        0.01        0.01  
    iter=42         1.1241     1.1403         0            0            0            0         0.01           0        0.01  
    iter=43         1.0611     1.6521         0            0            0            0         0.02           0        0.02  
    iter=44          1.002     1.7052         0            0            0            0         0.02        0.01        0.02  
    iter=45        0.94638      1.234      0.01            0            0            0         0.01           0        0.01  
    iter=46        0.89412     1.2531         0            0            0            0         0.01        0.01        0.01  
    iter=47        0.84489     1.1219         0            0            0            0            0           0        0.01  
    iter=48         0.7985      0.664         0            0            0            0         0.01        0.01           0  
    iter=49        0.75475    0.19503         0            0            0            0            0        0.01           0  
    iter=50        0.71346     1.1403         0         0.01            0            0            0           0        0.01  
    iter=51         0.6745    0.64861      0.01            0            0            0            0           0           0  
    iter=52         0.6377    0.11898         0            0            0            0            0        0.01           0  
    iter=53        0.60297     1.1589         0            0            0            0            0           0        0.01  
    iter=54        0.57016          0         0            0            0            0            0           0           0  
    iter=55        0.53917     0.6795         0            0            0            0            0        0.01        0.01  
    iter=56        0.50992      1.211         0            0            0            0            0           0        0.02  
    iter=57         0.4823          0         0            0            0            0            0           0           0  
    iter=58         0.4562          0         0            0            0            0            0           0           0  
    iter=59        0.43154          0         0            0            0            0            0           0           0  
    iter=60        0.40825     1.1963         0            0            0            0            0           0        0.01  
    iter=61        0.38625          0         0            0            0            0            0           0           0  
    iter=62        0.36545          0         0            0            0            0            0           0           0  
    iter=63        0.34581          0         0            0            0            0            0           0           0  
    iter=64        0.32724          0         0            0            0            0            0           0           0  
    iter=65         0.3097     1.2151         0            0            0            0            0           0        0.01  
    iter=66        0.29313          0         0            0            0            0            0           0           0  
    iter=67        0.27746    0.36776         0            0            0            0            0        0.01           0  
    iter=68        0.26265          0         0            0            0            0            0           0           0  
    iter=69        0.24866    0.44641         0            0            0            0            0           0        0.01  
    iter=70        0.23542          0         0            0            0            0            0           0           0  
    iter=71        0.22292      1.234         0            0            0            0            0           0        0.01  
    iter=72         0.2111    0.69512      0.01            0            0            0            0        0.01           0  
    iter=73        0.19992          0         0            0            0            0            0           0           0  
    iter=74        0.18935          0         0            0            0            0            0           0           0  
    iter=75        0.17935          0         0            0            0            0            0           0           0  
    iter=76        0.16989          0         0            0            0            0            0           0           0  
    iter=77        0.16094      0.102         0            0            0            0            0        0.01           0  
    iter=78        0.15248          0         0            0            0            0            0           0           0  
    iter=79        0.14447          0         0            0            0            0            0           0           0  
    iter=80         0.1369          0         0            0            0            0            0           0           0  
    iter=81        0.12974     1.2531         0            0            0            0            0           0        0.01  
    iter=82        0.12295          0         0            0            0            0            0           0           0  
    iter=83        0.11654          0         0            0            0            0            0           0           0  
    iter=84        0.11046          0         0            0            0            0            0           0           0  
    iter=85        0.10471          0         0            0            0            0            0           0           0  
    iter=86       0.099265          0         0            0            0            0            0           0           0  
    iter=87        0.09411          0         0            0            0            0            0           0           0  
    iter=88       0.089228          0         0            0            0            0            0           0           0  
    iter=89       0.084606          0         0            0            0            0            0           0           0  
    iter=90       0.080229          0         0            0            0            0            0           0           0  
    iter=91       0.076083          0         0            0            0            0            0           0           0  
    iter=92       0.072155          0         0            0            0            0            0           0           0  
    iter=93       0.068435          0         0            0            0            0            0           0           0  
    iter=94        0.06491          0         0            0            0            0            0           0           0  
    iter=95       0.061571          0         0            0            0            0            0           0           0  
    iter=96       0.058406          0         0            0            0            0            0           0           0  
    iter=97       0.055408          0         0            0            0            0            0           0           0  
    iter=98       0.052566          0         0            0            0            0            0           0           0  
    iter=99       0.049872          0         0            0            0            0            0           0           0  
    iter=100      0.047319          0         0            0            0            0            0           0           0  
    iter=101      0.044899          0         0            0            0            0            0           0           0  
    iter=102      0.042604          0         0            0            0            0            0           0           0  
    iter=103      0.040429          0         0            0            0            0            0           0           0  
    iter=104      0.038366          0         0            0            0            0            0           0           0  
    iter=105       0.03641          0         0            0            0            0            0           0           0  
    iter=106      0.034556          0         0            0            0            0            0           0           0  
    iter=107      0.032797          0         0            0            0            0            0           0           0  
    iter=108      0.031129          0         0            0            0            0            0           0           0  
    iter=109      0.029546          0         0            0            0            0            0           0           0  
    iter=110      0.028046          0         0            0            0            0            0           0           0  
    iter=111      0.026622          0         0            0            0            0            0           0           0  
    iter=112      0.025271          0         0            0            0            0            0           0           0  
    iter=113       0.02399          0         0            0            0            0            0           0           0  
    iter=114      0.022774          0         0            0            0            0            0           0           0  
    iter=115      0.021621          0         0            0            0            0            0           0           0  
    iter=116      0.020527          0         0            0            0            0            0           0           0  
    iter=117      0.019488          0         0            0            0            0            0           0           0  
    iter=118      0.018503          0         0            0            0            0            0           0           0  
    iter=119      0.017567          0         0            0            0            0            0           0           0  
    iter=120       0.01668          0         0            0            0            0            0           0           0  
    iter=121      0.015838          0         0            0            0            0            0           0           0  
    iter=122      0.015038          0         0            0            0            0            0           0           0  
    iter=123      0.014279          0         0            0            0            0            0           0           0  
    iter=124      0.013559          0         0            0            0            0            0           0           0  
    iter=125      0.012876          0         0            0            0            0            0           0           0  
    iter=126      0.012227          0         0            0            0            0            0           0           0  
    iter=127      0.011611          0         0            0            0            0            0           0           0  
    iter=128      0.011026          0         0            0            0            0            0           0           0  
    iter=129      0.010471          0         0            0            0            0            0           0           0  
    iter=130     0.0099436          0         0            0            0            0            0           0           0  
    iter=131     0.0094432          0         0            0            0            0            0           0           0  
    iter=132     0.0089681          0         0            0            0            0            0           0           0  
    iter=133     0.0085171          0         0            0            0            0            0           0           0  
    iter=134     0.0080888          0         0            0            0            0            0           0           0  
    iter=135     0.0076822          0         0            0            0            0            0           0           0  
    iter=136     0.0072961          0         0            0            0            0            0           0           0  
    iter=137     0.0069295          0         0            0            0            0            0           0           0  
    iter=138     0.0065814          0         0            0            0            0            0           0           0  
    iter=139     0.0062508          0         0            0            0            0            0           0           0  
    iter=140      0.005937          0         0            0            0            0            0           0           0  
    iter=141     0.0056389          0         0            0            0            0            0           0           0  
    iter=142     0.0053558          0         0            0            0            0            0           0           0  
    iter=143      0.005087          0         0            0            0            0            0           0           0  
    iter=144     0.0048318          0         0            0            0            0            0           0           0  
    iter=145     0.0045894          0         0            0            0            0            0           0           0  
    iter=146     0.0043591          0         0            0            0            0            0           0           0  
    iter=147     0.0041405          0         0            0            0            0            0           0           0  
    iter=148     0.0039328          0         0            0            0            0            0           0           0  
    iter=149     0.0037356          0         0            0            0            0            0           0           0  
    iter=150     0.0035483          0         0            0            0            0            0           0           0  
    iter=151     0.0033705          0         0            0            0            0            0           0           0  
    iter=152     0.0032015          0         0            0            0            0            0           0           0  
    iter=153     0.0030411          0         0            0            0            0            0           0           0  
    iter=154     0.0028887          0         0            0            0            0            0           0           0  
    iter=155     0.0027439          0         0            0            0            0            0           0           0  
    iter=156     0.0026064          0         0            0            0            0            0           0           0  
    iter=157     0.0024758          0         0            0            0            0            0           0           0  
    iter=158     0.0023518          0         0            0            0            0            0           0           0  
    iter=159      0.002234          0         0            0            0            0            0           0           0  
    iter=160     0.0021221          0         0            0            0            0            0           0           0  
    iter=161     0.0020158          0         0            0            0            0            0           0           0  
    iter=162     0.0019149          0         0            0            0            0            0           0           0  
    iter=163      0.001819          0         0            0            0            0            0           0           0  
    iter=164     0.0017279          0         0            0            0            0            0           0           0  
    iter=165     0.0016414          0         0            0            0            0            0           0           0  
    iter=166     0.0015592          0         0            0            0            0            0           0           0  
    iter=167     0.0014812          0         0            0            0            0            0           0           0  
    iter=168      0.001407          0         0            0            0            0            0           0           0  
    iter=169     0.0013366          0         0            0            0            0            0           0           0  
    iter=170     0.0012697          0         0            0            0            0            0           0           0  
    iter=171     0.0012061          0         0            0            0            0            0           0           0  
    iter=172     0.0011458          0         0            0            0            0            0           0           0  
    iter=173     0.0010884          0         0            0            0            0            0           0           0  
    iter=174      0.001034          0         0            0            0            0            0           0           0  
    iter=175    0.00098221          0         0            0            0            0            0           0           0  
    iter=176    0.00093306          0         0            0            0            0            0           0           0  
    iter=177    0.00088637          0         0            0            0            0            0           0           0  
    iter=178    0.00084201          0         0            0            0            0            0           0           0  
    iter=179    0.00079988          0         0            0            0            0            0           0           0  
    iter=180    0.00075986          0         0            0            0            0            0           0           0  
    iter=181    0.00072184          0         0            0            0            0            0           0           0  
    iter=182    0.00068573          0         0            0            0            0            0           0           0  
    iter=183    0.00065142          0         0            0            0            0            0           0           0  
    iter=184    0.00061883          0         0            0            0            0            0           0           0  
    iter=185    0.00058787          0         0            0            0            0            0           0           0  
    iter=186    0.00055846          0         0            0            0            0            0           0           0  
    iter=187    0.00053053          0         0            0            0            0            0           0           0  
    iter=188    0.00050399          0         0            0            0            0            0           0           0  
    iter=189    0.00047878          0         0            0            0            0            0           0           0  
    iter=190    0.00045483          0         0            0            0            0            0           0           0  
    iter=191    0.00043208          0         0            0            0            0            0           0           0  
    iter=192    0.00041046          0         0            0            0            0            0           0           0  
    iter=193    0.00038993          0         0            0            0            0            0           0           0  
    iter=194    0.00037043          0         0            0            0            0            0           0           0  
    iter=195     0.0003519          0         0            0            0            0            0           0           0  
    iter=196     0.0003343          0         0            0            0            0            0           0           0  
    iter=197    0.00031758          0         0            0            0            0            0           0           0  
    iter=198     0.0003017          0         0            0            0            0            0           0           0  
    iter=199    0.00028661          0         0            0            0            0            0           0           0  
    iter=200    0.00027227          0         0            0            0            0            0           0           0  
    iter=201    0.00025866          0         0            0            0            0            0           0           0  
    iter=202    0.00024572          0         0            0            0            0            0           0           0  
    iter=203    0.00023343          0         0            0            0            0            0           0           0  
    iter=204    0.00022176          0         0            0            0            0            0           0           0  
    iter=205    0.00021067          0         0            0            0            0            0           0           0  
    iter=206    0.00020013          0         0            0            0            0            0           0           0  
    iter=207    0.00019012          0         0            0            0            0            0           0           0  
    iter=208    0.00018061          0         0            0            0            0            0           0           0  
    iter=209    0.00017158          0         0            0            0            0            0           0           0  
    iter=210      0.000163          0         0            0            0            0            0           0           0  
    iter=211    0.00015485          0         0            0            0            0            0           0           0  
    iter=212    0.00014711          0         0            0            0            0            0           0           0  
    iter=213    0.00013975          0         0            0            0            0            0           0           0  
    iter=214    0.00013276          0         0            0            0            0            0           0           0  
    iter=215    0.00012612          0         0            0            0            0            0           0           0  
    iter=216    0.00011982          0         0            0            0            0            0           0           0  
    iter=217    0.00011382          0         0            0            0            0            0           0           0  
    iter=218    0.00010813          0         0            0            0            0            0           0           0  
    iter=219    0.00010272          0         0            0            0            0            0           0           0  
    iter=220    9.7588e-05          0         0            0            0            0            0           0           0  
    iter=221    9.2708e-05          0         0            0            0            0            0           0           0  
    iter=222    8.8072e-05          0         0            0            0            0            0           0           0  
    iter=223    8.3668e-05          0         0            0            0            0            0           0           0  
    iter=224    7.9485e-05          0         0            0            0            0            0           0           0  
    iter=225     7.551e-05          0         0            0            0            0            0           0           0  
    iter=226    7.1734e-05          0         0            0            0            0            0           0           0  
    iter=227    6.8147e-05          0         0            0            0            0            0           0           0  
    iter=228     6.474e-05          0         0            0            0            0            0           0           0  
    iter=229    6.1502e-05          0         0            0            0            0            0           0           0  
    iter=230    5.8427e-05          0         0            0            0            0            0           0           0  
    iter=231    5.5505e-05          0         0            0            0            0            0           0           0  
    iter=232     5.273e-05          0         0            0            0            0            0           0           0  
    iter=233    5.0093e-05          0         0            0            0            0            0           0           0  
    iter=234    4.7589e-05          0         0            0            0            0            0           0           0  
    iter=235    4.5209e-05          0         0            0            0            0            0           0           0  
    iter=236    4.2948e-05          0         0            0            0            0            0           0           0  
    iter=237    4.0801e-05          0         0            0            0            0            0           0           0  
    iter=238    3.8761e-05          0         0            0            0            0            0           0           0  
    iter=239    3.6823e-05          0         0            0            0            0            0           0           0  
    iter=240    3.4981e-05          0         0            0            0            0            0           0           0  
    iter=241    3.3232e-05          0         0            0            0            0            0           0           0  
    iter=242    3.1571e-05          0         0            0            0            0            0           0           0  
    iter=243    2.9992e-05          0         0            0            0            0            0           0           0  
    iter=244    2.8492e-05          0         0            0            0            0            0           0           0  
    iter=245    2.7068e-05          0         0            0            0            0            0           0           0  
    iter=246    2.5714e-05          0         0            0            0            0            0           0           0  
    iter=247    2.4429e-05          0         0            0            0            0            0           0           0  
    iter=248    2.3207e-05          0         0            0            0            0            0           0           0  
    iter=249    2.2047e-05          0         0            0            0            0            0           0           0  
    iter=250    2.0944e-05          0         0            0            0            0            0           0           0  
    iter=251    1.9897e-05          0         0            0            0            0            0           0           0  
    iter=252    1.8902e-05          0         0            0            0            0            0           0           0  
    iter=253    1.7957e-05          0         0            0            0            0            0           0           0  
    iter=254    1.7059e-05          0         0            0            0            0            0           0           0  
    iter=255    1.6206e-05          0         0            0            0            0            0           0           0  
    iter=256    1.5396e-05          0         0            0            0            0            0           0           0  
    iter=257    1.4626e-05          0         0            0            0            0            0           0           0  
    iter=258    1.3895e-05          0         0            0            0            0            0           0           0  
    iter=259      1.32e-05          0         0            0            0            0            0           0           0  
    iter=260     1.254e-05          0         0            0            0            0            0           0           0  
    iter=261    1.1913e-05          0         0            0            0            0            0           0           0  
    iter=262    1.1317e-05          0         0            0            0            0            0           0           0  
    iter=263    1.0751e-05          0         0            0            0            0            0           0           0  
    iter=264    1.0214e-05          0         0            0            0            0            0           0           0  
    iter=265    9.7032e-06          0         0            0            0            0            0           0           0  
    iter=266     9.218e-06          0         0            0            0            0            0           0           0  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          i    idx    ndim    numel    rowN    colN     sum      mean      std      coefvari    min    max
          _    ___    ____    _____    ____    ____    _____    ______    ______    ________    ___    ___

    ap    1     1      2       700     100      7      10003    14.291    14.535     1.0171      0     50 

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1        c2          c3           c4         c5         c6        c7  
            ______    ______    __________    ________    _______    ______    ______

    r1           0         0             0    0.092813    0.31242    0.7048    1.3008
    r2           0         0             0    0.092813    0.31242    0.7048    1.3008
    r3           0         0             0    0.092813    0.31242    0.7048    1.3008
    r4           0         0             0    0.092813    0.31242    0.7048    1.3008
    r5           0         0    0.00051272    0.092813    0.31242    0.7048    1.3008
    r96     43.924    43.924        43.924      43.924     45.102    45.102    46.298
    r97     45.102    45.102        45.102      45.102     46.298    46.298    47.513
    r98     46.298    46.298        46.298      46.298     47.513    47.513    48.747
    r99     47.513    47.513        47.513      47.513     48.747    48.747        50
    r100    48.747    48.747        48.747      48.747         50        50        50

</pre><h2 id="9">Initialize Matrix</h2><pre class="codeinput">mt_dist_az_init = ones(length(ar_a),it_z_n)/length(ar_a)/it_z_n;
mt_dist_az_cur = mt_dist_az_init;
mt_dist_az_zeros = zeros(length(ar_a),it_z_n);

ar_dist_diff_norm = zeros([it_maxiter_ds, 1]);
mt_dist_perc_change = zeros([it_maxiter_ds, it_z_n]);
</pre><h2 id="10">Start Timer</h2><pre class="codeinput"><span class="keyword">if</span> (bl_timer)
    tic
<span class="keyword">end</span>
</pre><h2 id="11">Iterate and Get Distribution</h2><p>initialize</p><pre class="codeinput">it_iter = 0;

<span class="comment">% After converge, one more iteration to store results</span>
bl_continue = true;
bl_converged = false;

<span class="comment">% Loop 0, continuous VFI iteration until convergence</span>
<span class="keyword">while</span> bl_continue
    it_iter = it_iter + 1;

    <span class="comment">% initialize empty</span>
    mt_dist_az = mt_dist_az_zeros;

    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:it_z_n

        <span class="comment">% loop 2: over endogenous states</span>
        <span class="keyword">for</span> it_a_j = 1:length(ar_a)

            <span class="comment">% f(a'|a) = 1 for only one a'</span>
            <span class="comment">% get lowe rand higher index</span>
            fl_aprime = mt_aprime(it_a_j, it_z_i);
            it_aprime_idx = find(ar_a == fl_aprime);

            <span class="comment">% loop 3: loop over future shocks</span>
            <span class="comment">% E_{a,z}(f(a',z'|a,z)*f(a,z))</span>
            <span class="keyword">for</span> it_zp_q = 1:it_z_n

                <span class="comment">% current probablity at (a,z)</span>
                fl_cur_za_prob = mt_dist_az_cur(it_a_j, it_z_i);

                <span class="comment">% f(z'|z) transition</span>
                fl_ztoz_trans =  mt_z_trans(it_z_i, it_zp_q);

                <span class="comment">% f(a',z'|a,z)*f(a,z)</span>
                fl_zfromza = fl_cur_za_prob*fl_ztoz_trans;

                <span class="comment">% cumulating</span>
                mt_dist_az(it_aprime_idx, it_zp_q) = mt_dist_az(it_aprime_idx, it_zp_q) + fl_zfromza;

            <span class="keyword">end</span>
        <span class="keyword">end</span>

    <span class="keyword">end</span>

    <span class="comment">% Difference across iterations</span>
    fl_diff = norm(mt_dist_az-mt_dist_az_cur);
    <span class="keyword">if</span> (bl_print_iterinfo)
        ar_dist_diff_norm(it_iter) = fl_diff;
        mt_dist_perc_change(it_iter, :) = sum((abs(mt_dist_az - mt_dist_az_cur) &gt; fl_tol_ds))/(it_a_n);
    <span class="keyword">end</span>

    <span class="comment">% Update</span>
    mt_dist_az_cur = mt_dist_az;

    <span class="comment">% Update Continue Criterion</span>
    <span class="keyword">if</span> bl_converged
        bl_continue = false;
    <span class="keyword">elseif</span>(fl_diff &lt;= fl_tol_ds || it_iter &gt;= it_maxiter_ds)
        bl_converged = true;
        <span class="keyword">if</span> (fl_diff &lt;= fl_tol_ds)
            flag = 1;
        <span class="keyword">else</span>
            flag = 2;
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    <span class="comment">% Print Iteration Record</span>
    <span class="keyword">if</span>(bl_print_iterinfo)
        disp([<span class="string">'FF_DS_AZ_CTS_LOOP, it_iter:'</span> num2str(it_iter) <span class="keyword">...</span>
            <span class="string">', fl_diff:'</span> num2str(fl_diff)]);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">FF_DS_AZ_CTS_LOOP, it_iter:1, fl_diff:0.014186
FF_DS_AZ_CTS_LOOP, it_iter:2, fl_diff:0.011961
FF_DS_AZ_CTS_LOOP, it_iter:3, fl_diff:0.0070959
FF_DS_AZ_CTS_LOOP, it_iter:4, fl_diff:0.0048187
FF_DS_AZ_CTS_LOOP, it_iter:5, fl_diff:0.0034205
FF_DS_AZ_CTS_LOOP, it_iter:6, fl_diff:0.0026131
FF_DS_AZ_CTS_LOOP, it_iter:7, fl_diff:0.0021993
FF_DS_AZ_CTS_LOOP, it_iter:8, fl_diff:0.0020196
FF_DS_AZ_CTS_LOOP, it_iter:9, fl_diff:0.0018563
FF_DS_AZ_CTS_LOOP, it_iter:10, fl_diff:0.0017355
FF_DS_AZ_CTS_LOOP, it_iter:11, fl_diff:0.0016124
FF_DS_AZ_CTS_LOOP, it_iter:12, fl_diff:0.0015018
FF_DS_AZ_CTS_LOOP, it_iter:13, fl_diff:0.0013955
FF_DS_AZ_CTS_LOOP, it_iter:14, fl_diff:0.0013023
FF_DS_AZ_CTS_LOOP, it_iter:15, fl_diff:0.0012186
FF_DS_AZ_CTS_LOOP, it_iter:16, fl_diff:0.0011467
FF_DS_AZ_CTS_LOOP, it_iter:17, fl_diff:0.0010847
FF_DS_AZ_CTS_LOOP, it_iter:18, fl_diff:0.0010324
FF_DS_AZ_CTS_LOOP, it_iter:19, fl_diff:0.00098781
FF_DS_AZ_CTS_LOOP, it_iter:20, fl_diff:0.00095052
FF_DS_AZ_CTS_LOOP, it_iter:21, fl_diff:0.00091878
FF_DS_AZ_CTS_LOOP, it_iter:22, fl_diff:0.00089207
FF_DS_AZ_CTS_LOOP, it_iter:23, fl_diff:0.00086938
FF_DS_AZ_CTS_LOOP, it_iter:24, fl_diff:0.00085024
FF_DS_AZ_CTS_LOOP, it_iter:25, fl_diff:0.00083391
FF_DS_AZ_CTS_LOOP, it_iter:26, fl_diff:0.00081994
FF_DS_AZ_CTS_LOOP, it_iter:27, fl_diff:0.00080797
FF_DS_AZ_CTS_LOOP, it_iter:28, fl_diff:0.0007975
FF_DS_AZ_CTS_LOOP, it_iter:29, fl_diff:0.00078829
FF_DS_AZ_CTS_LOOP, it_iter:30, fl_diff:0.00078012
FF_DS_AZ_CTS_LOOP, it_iter:31, fl_diff:0.00077279
FF_DS_AZ_CTS_LOOP, it_iter:32, fl_diff:0.00076614
FF_DS_AZ_CTS_LOOP, it_iter:33, fl_diff:0.00075904
FF_DS_AZ_CTS_LOOP, it_iter:34, fl_diff:0.00075341
FF_DS_AZ_CTS_LOOP, it_iter:35, fl_diff:0.000748
FF_DS_AZ_CTS_LOOP, it_iter:36, fl_diff:0.00074295
FF_DS_AZ_CTS_LOOP, it_iter:37, fl_diff:0.00073824
FF_DS_AZ_CTS_LOOP, it_iter:38, fl_diff:0.00073367
FF_DS_AZ_CTS_LOOP, it_iter:39, fl_diff:0.00072937
FF_DS_AZ_CTS_LOOP, it_iter:40, fl_diff:0.00072526
FF_DS_AZ_CTS_LOOP, it_iter:41, fl_diff:0.00072135
FF_DS_AZ_CTS_LOOP, it_iter:42, fl_diff:0.00071758
FF_DS_AZ_CTS_LOOP, it_iter:43, fl_diff:0.00071394
FF_DS_AZ_CTS_LOOP, it_iter:44, fl_diff:0.00071037
FF_DS_AZ_CTS_LOOP, it_iter:45, fl_diff:0.00070687
FF_DS_AZ_CTS_LOOP, it_iter:46, fl_diff:0.00070338
FF_DS_AZ_CTS_LOOP, it_iter:47, fl_diff:0.00069989
FF_DS_AZ_CTS_LOOP, it_iter:48, fl_diff:0.00069623
FF_DS_AZ_CTS_LOOP, it_iter:49, fl_diff:0.00069256
FF_DS_AZ_CTS_LOOP, it_iter:50, fl_diff:0.00068874
FF_DS_AZ_CTS_LOOP, it_iter:51, fl_diff:0.00068479
FF_DS_AZ_CTS_LOOP, it_iter:52, fl_diff:0.00068062
FF_DS_AZ_CTS_LOOP, it_iter:53, fl_diff:0.00067623
FF_DS_AZ_CTS_LOOP, it_iter:54, fl_diff:0.00067159
FF_DS_AZ_CTS_LOOP, it_iter:55, fl_diff:0.00066667
FF_DS_AZ_CTS_LOOP, it_iter:56, fl_diff:0.00066146
FF_DS_AZ_CTS_LOOP, it_iter:57, fl_diff:0.00065599
FF_DS_AZ_CTS_LOOP, it_iter:58, fl_diff:0.00065021
FF_DS_AZ_CTS_LOOP, it_iter:59, fl_diff:0.00064413
FF_DS_AZ_CTS_LOOP, it_iter:60, fl_diff:0.00063773
FF_DS_AZ_CTS_LOOP, it_iter:61, fl_diff:0.00063103
FF_DS_AZ_CTS_LOOP, it_iter:62, fl_diff:0.00062402
FF_DS_AZ_CTS_LOOP, it_iter:63, fl_diff:0.00061669
FF_DS_AZ_CTS_LOOP, it_iter:64, fl_diff:0.0006091
FF_DS_AZ_CTS_LOOP, it_iter:65, fl_diff:0.00060125
FF_DS_AZ_CTS_LOOP, it_iter:66, fl_diff:0.00059316
FF_DS_AZ_CTS_LOOP, it_iter:67, fl_diff:0.00058484
FF_DS_AZ_CTS_LOOP, it_iter:68, fl_diff:0.00057631
FF_DS_AZ_CTS_LOOP, it_iter:69, fl_diff:0.00056758
FF_DS_AZ_CTS_LOOP, it_iter:70, fl_diff:0.00055868
FF_DS_AZ_CTS_LOOP, it_iter:71, fl_diff:0.00054961
FF_DS_AZ_CTS_LOOP, it_iter:72, fl_diff:0.00054041
FF_DS_AZ_CTS_LOOP, it_iter:73, fl_diff:0.00053108
FF_DS_AZ_CTS_LOOP, it_iter:74, fl_diff:0.00052165
FF_DS_AZ_CTS_LOOP, it_iter:75, fl_diff:0.00051211
FF_DS_AZ_CTS_LOOP, it_iter:76, fl_diff:0.0005025
FF_DS_AZ_CTS_LOOP, it_iter:77, fl_diff:0.00049282
FF_DS_AZ_CTS_LOOP, it_iter:78, fl_diff:0.00048309
FF_DS_AZ_CTS_LOOP, it_iter:79, fl_diff:0.00047331
FF_DS_AZ_CTS_LOOP, it_iter:80, fl_diff:0.0004635
FF_DS_AZ_CTS_LOOP, it_iter:81, fl_diff:0.00045367
FF_DS_AZ_CTS_LOOP, it_iter:82, fl_diff:0.00044382
FF_DS_AZ_CTS_LOOP, it_iter:83, fl_diff:0.00043398
FF_DS_AZ_CTS_LOOP, it_iter:84, fl_diff:0.00042415
FF_DS_AZ_CTS_LOOP, it_iter:85, fl_diff:0.00041433
FF_DS_AZ_CTS_LOOP, it_iter:86, fl_diff:0.00040455
FF_DS_AZ_CTS_LOOP, it_iter:87, fl_diff:0.0003948
FF_DS_AZ_CTS_LOOP, it_iter:88, fl_diff:0.00038511
FF_DS_AZ_CTS_LOOP, it_iter:89, fl_diff:0.00037547
FF_DS_AZ_CTS_LOOP, it_iter:90, fl_diff:0.00036589
FF_DS_AZ_CTS_LOOP, it_iter:91, fl_diff:0.00035639
FF_DS_AZ_CTS_LOOP, it_iter:92, fl_diff:0.00034697
FF_DS_AZ_CTS_LOOP, it_iter:93, fl_diff:0.00033764
FF_DS_AZ_CTS_LOOP, it_iter:94, fl_diff:0.00032841
FF_DS_AZ_CTS_LOOP, it_iter:95, fl_diff:0.00031928
FF_DS_AZ_CTS_LOOP, it_iter:96, fl_diff:0.00031026
FF_DS_AZ_CTS_LOOP, it_iter:97, fl_diff:0.00030136
FF_DS_AZ_CTS_LOOP, it_iter:98, fl_diff:0.00029259
FF_DS_AZ_CTS_LOOP, it_iter:99, fl_diff:0.00028394
FF_DS_AZ_CTS_LOOP, it_iter:100, fl_diff:0.00027543
FF_DS_AZ_CTS_LOOP, it_iter:101, fl_diff:0.00026706
FF_DS_AZ_CTS_LOOP, it_iter:102, fl_diff:0.00025884
FF_DS_AZ_CTS_LOOP, it_iter:103, fl_diff:0.00025076
FF_DS_AZ_CTS_LOOP, it_iter:104, fl_diff:0.00024283
FF_DS_AZ_CTS_LOOP, it_iter:105, fl_diff:0.00023507
FF_DS_AZ_CTS_LOOP, it_iter:106, fl_diff:0.00022746
FF_DS_AZ_CTS_LOOP, it_iter:107, fl_diff:0.00022001
FF_DS_AZ_CTS_LOOP, it_iter:108, fl_diff:0.00021272
FF_DS_AZ_CTS_LOOP, it_iter:109, fl_diff:0.0002056
FF_DS_AZ_CTS_LOOP, it_iter:110, fl_diff:0.00019864
FF_DS_AZ_CTS_LOOP, it_iter:111, fl_diff:0.00019185
FF_DS_AZ_CTS_LOOP, it_iter:112, fl_diff:0.00018523
FF_DS_AZ_CTS_LOOP, it_iter:113, fl_diff:0.00017878
FF_DS_AZ_CTS_LOOP, it_iter:114, fl_diff:0.00017249
FF_DS_AZ_CTS_LOOP, it_iter:115, fl_diff:0.00016637
FF_DS_AZ_CTS_LOOP, it_iter:116, fl_diff:0.00016042
FF_DS_AZ_CTS_LOOP, it_iter:117, fl_diff:0.00015463
FF_DS_AZ_CTS_LOOP, it_iter:118, fl_diff:0.00014901
FF_DS_AZ_CTS_LOOP, it_iter:119, fl_diff:0.00014354
FF_DS_AZ_CTS_LOOP, it_iter:120, fl_diff:0.00013824
FF_DS_AZ_CTS_LOOP, it_iter:121, fl_diff:0.0001331
FF_DS_AZ_CTS_LOOP, it_iter:122, fl_diff:0.00012811
FF_DS_AZ_CTS_LOOP, it_iter:123, fl_diff:0.00012328
FF_DS_AZ_CTS_LOOP, it_iter:124, fl_diff:0.0001186
FF_DS_AZ_CTS_LOOP, it_iter:125, fl_diff:0.00011407
FF_DS_AZ_CTS_LOOP, it_iter:126, fl_diff:0.00010968
FF_DS_AZ_CTS_LOOP, it_iter:127, fl_diff:0.00010544
FF_DS_AZ_CTS_LOOP, it_iter:128, fl_diff:0.00010134
FF_DS_AZ_CTS_LOOP, it_iter:129, fl_diff:9.7373e-05
FF_DS_AZ_CTS_LOOP, it_iter:130, fl_diff:9.3545e-05
FF_DS_AZ_CTS_LOOP, it_iter:131, fl_diff:8.9847e-05
FF_DS_AZ_CTS_LOOP, it_iter:132, fl_diff:8.6278e-05
FF_DS_AZ_CTS_LOOP, it_iter:133, fl_diff:8.2834e-05
FF_DS_AZ_CTS_LOOP, it_iter:134, fl_diff:7.9513e-05
FF_DS_AZ_CTS_LOOP, it_iter:135, fl_diff:7.631e-05
FF_DS_AZ_CTS_LOOP, it_iter:136, fl_diff:7.3223e-05
FF_DS_AZ_CTS_LOOP, it_iter:137, fl_diff:7.0248e-05
FF_DS_AZ_CTS_LOOP, it_iter:138, fl_diff:6.7383e-05
FF_DS_AZ_CTS_LOOP, it_iter:139, fl_diff:6.4624e-05
FF_DS_AZ_CTS_LOOP, it_iter:140, fl_diff:6.1967e-05
FF_DS_AZ_CTS_LOOP, it_iter:141, fl_diff:5.9411e-05
FF_DS_AZ_CTS_LOOP, it_iter:142, fl_diff:5.6952e-05
FF_DS_AZ_CTS_LOOP, it_iter:143, fl_diff:5.4586e-05
FF_DS_AZ_CTS_LOOP, it_iter:144, fl_diff:5.2311e-05
FF_DS_AZ_CTS_LOOP, it_iter:145, fl_diff:5.0124e-05
FF_DS_AZ_CTS_LOOP, it_iter:146, fl_diff:4.8022e-05
FF_DS_AZ_CTS_LOOP, it_iter:147, fl_diff:4.6002e-05
FF_DS_AZ_CTS_LOOP, it_iter:148, fl_diff:4.4062e-05
FF_DS_AZ_CTS_LOOP, it_iter:149, fl_diff:4.2199e-05
FF_DS_AZ_CTS_LOOP, it_iter:150, fl_diff:4.0409e-05
FF_DS_AZ_CTS_LOOP, it_iter:151, fl_diff:3.8691e-05
FF_DS_AZ_CTS_LOOP, it_iter:152, fl_diff:3.7042e-05
FF_DS_AZ_CTS_LOOP, it_iter:153, fl_diff:3.546e-05
FF_DS_AZ_CTS_LOOP, it_iter:154, fl_diff:3.3942e-05
FF_DS_AZ_CTS_LOOP, it_iter:155, fl_diff:3.2485e-05
FF_DS_AZ_CTS_LOOP, it_iter:156, fl_diff:3.1088e-05
FF_DS_AZ_CTS_LOOP, it_iter:157, fl_diff:2.9748e-05
FF_DS_AZ_CTS_LOOP, it_iter:158, fl_diff:2.8464e-05
FF_DS_AZ_CTS_LOOP, it_iter:159, fl_diff:2.7232e-05
FF_DS_AZ_CTS_LOOP, it_iter:160, fl_diff:2.6052e-05
FF_DS_AZ_CTS_LOOP, it_iter:161, fl_diff:2.4921e-05
FF_DS_AZ_CTS_LOOP, it_iter:162, fl_diff:2.3837e-05
FF_DS_AZ_CTS_LOOP, it_iter:163, fl_diff:2.2798e-05
FF_DS_AZ_CTS_LOOP, it_iter:164, fl_diff:2.1803e-05
FF_DS_AZ_CTS_LOOP, it_iter:165, fl_diff:2.085e-05
FF_DS_AZ_CTS_LOOP, it_iter:166, fl_diff:1.9938e-05
FF_DS_AZ_CTS_LOOP, it_iter:167, fl_diff:1.9064e-05
FF_DS_AZ_CTS_LOOP, it_iter:168, fl_diff:1.8227e-05
FF_DS_AZ_CTS_LOOP, it_iter:169, fl_diff:1.7426e-05
FF_DS_AZ_CTS_LOOP, it_iter:170, fl_diff:1.6659e-05
FF_DS_AZ_CTS_LOOP, it_iter:171, fl_diff:1.5925e-05
FF_DS_AZ_CTS_LOOP, it_iter:172, fl_diff:1.5222e-05
FF_DS_AZ_CTS_LOOP, it_iter:173, fl_diff:1.455e-05
FF_DS_AZ_CTS_LOOP, it_iter:174, fl_diff:1.3907e-05
FF_DS_AZ_CTS_LOOP, it_iter:175, fl_diff:1.3291e-05
FF_DS_AZ_CTS_LOOP, it_iter:176, fl_diff:1.2702e-05
FF_DS_AZ_CTS_LOOP, it_iter:177, fl_diff:1.2139e-05
FF_DS_AZ_CTS_LOOP, it_iter:178, fl_diff:1.16e-05
FF_DS_AZ_CTS_LOOP, it_iter:179, fl_diff:1.1084e-05
FF_DS_AZ_CTS_LOOP, it_iter:180, fl_diff:1.0591e-05
FF_DS_AZ_CTS_LOOP, it_iter:181, fl_diff:1.012e-05
FF_DS_AZ_CTS_LOOP, it_iter:182, fl_diff:9.6686e-06
FF_DS_AZ_CTS_LOOP, it_iter:183, fl_diff:9.2375e-06
</pre><h2 id="12">Timer Stop</h2><pre class="codeinput"><span class="keyword">if</span> (bl_timer)
    toc
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 0.148683 seconds.
</pre><h2 id="13">Results for Printing, and Graphing</h2><pre class="codeinput">mp_print_graph = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
mp_print_graph(<span class="string">'faz'</span>) = mt_dist_az;
mp_print_graph(<span class="string">'fa'</span>) = sum(mt_dist_az,2);
mp_print_graph(<span class="string">'fz'</span>) = sum(mt_dist_az,1)';
</pre><h2 id="14">Show Value Function Convergence Information</h2><pre class="codeinput"><span class="keyword">if</span> (bl_print_iterinfo)

    it_z_select = unique(round(linspace(1,length(ar_z), 7)));
    ar_z_select = ar_z(it_z_select);
    tb_dist_alliter = array2table([ar_dist_diff_norm(1:it_iter)';<span class="keyword">...</span>
        mt_dist_perc_change(1:it_iter,it_z_select)']');
    ar_st_col_zs = matlab.lang.makeValidName(strcat(<span class="string">'z='</span>, string(ar_z_select)));
    cl_col_names = [<span class="string">'distgap'</span>, ar_st_col_zs];
    cl_row_names = strcat(<span class="string">'iter='</span>, string(1:it_iter));
    tb_dist_alliter.Properties.VariableNames = cl_col_names;
    tb_dist_alliter.Properties.RowNames = cl_row_names;
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Value Function Iteration Per Iteration Changes'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'distgap = norm(mt_dist_az - mt_dist_az_cur): distributional function difference across iterations'</span>);
    disp([<span class="string">'z1 = z1 perc change: sum((abs(mt_dist_az - mt_dist_az_cur) &gt; fl_tol_ds))/(it_a_n);: percentage of state space'</span><span class="keyword">...</span>
        <span class="string">' points conditional on shock where the distribution mass is changing larger than fl_tol_ds across iterations'</span>]);
    disp(tb_dist_alliter);

<span class="keyword">end</span>
</pre><pre class="codeoutput">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Value Function Iteration Per Iteration Changes
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
distgap = norm(mt_dist_az - mt_dist_az_cur): distributional function difference across iterations
z1 = z1 perc change: sum((abs(mt_dist_az - mt_dist_az_cur) &gt; fl_tol_ds))/(it_a_n);: percentage of state space points conditional on shock where the distribution mass is changing larger than fl_tol_ds across iterations
                 distgap      z_0_41816    z_0_54897    z_0_72069    z_0_94612    z_1_2421    z_1_6306    z_2_1407
                __________    _________    _________    _________    _________    ________    ________    ________

    iter=1        0.014186         1            1            1            1            1           1           1  
    iter=2        0.011961      0.93         0.98         0.98         0.97         0.95        0.92        0.87  
    iter=3       0.0070959       0.9         0.96         0.98         0.97         0.95        0.92         0.8  
    iter=4       0.0048187      0.88         0.96         0.96         0.98         0.97        0.88        0.77  
    iter=5       0.0034205      0.86         0.92         0.95         0.97         0.94        0.88        0.74  
    iter=6       0.0026131      0.82          0.9         0.92         0.96         0.92        0.79         0.7  
    iter=7       0.0021993      0.79         0.75         0.89         0.97         0.88         0.8        0.66  
    iter=8       0.0020196      0.48         0.68         0.89          0.9         0.87         0.7         0.6  
    iter=9       0.0018563       0.1         0.61         0.69         0.91         0.66        0.63        0.28  
    iter=10      0.0017355      0.02         0.29         0.69          0.9         0.66        0.42        0.19  
    iter=11      0.0016124      0.02         0.37         0.66          0.9         0.62        0.41        0.14  
    iter=12      0.0015018      0.02         0.41         0.68         0.75         0.59         0.4        0.09  
    iter=13      0.0013955      0.02          0.4         0.67         0.71         0.58        0.34        0.01  
    iter=14      0.0013023      0.02         0.42         0.68         0.69         0.58        0.34        0.01  
    iter=15      0.0012186      0.02         0.42         0.67         0.68          0.6        0.36        0.01  
    iter=16      0.0011467      0.02         0.43         0.67         0.67          0.6        0.37        0.01  
    iter=17      0.0010847      0.02         0.44         0.66          0.7         0.63        0.38        0.01  
    iter=18      0.0010324      0.01         0.43         0.68         0.71         0.66        0.39        0.01  
    iter=19     0.00098781      0.01         0.43          0.7         0.72         0.68        0.39        0.01  
    iter=20     0.00095052      0.01         0.41         0.71         0.72         0.68        0.41        0.01  
    iter=21     0.00091878      0.01         0.42          0.7         0.74         0.69        0.44        0.01  
    iter=22     0.00089207      0.02         0.42         0.73         0.74          0.7        0.48           0  
    iter=23     0.00086938      0.02         0.41         0.72         0.77          0.7         0.5           0  
    iter=24     0.00085024      0.02          0.4         0.74         0.77         0.72         0.5           0  
    iter=25     0.00083391      0.02         0.38         0.74         0.77         0.72        0.51           0  
    iter=26     0.00081994      0.02         0.41         0.73         0.78         0.73        0.51           0  
    iter=27     0.00080797      0.02         0.43         0.74         0.78         0.74        0.52           0  
    iter=28      0.0007975      0.02         0.44         0.74         0.78         0.74        0.53           0  
    iter=29     0.00078829      0.02         0.45         0.74         0.78         0.74        0.52           0  
    iter=30     0.00078012      0.02         0.45         0.76         0.78         0.74        0.51           0  
    iter=31     0.00077279      0.02         0.45         0.75         0.79         0.75        0.51           0  
    iter=32     0.00076614      0.02         0.44         0.76         0.79         0.75        0.51           0  
    iter=33     0.00075904      0.02         0.45         0.76         0.79         0.76        0.51           0  
    iter=34     0.00075341      0.01         0.45         0.75          0.8         0.75        0.51           0  
    iter=35       0.000748      0.01         0.45         0.75          0.8         0.76        0.52           0  
    iter=36     0.00074295      0.01         0.45         0.76          0.8         0.76        0.51           0  
    iter=37     0.00073824      0.01         0.45         0.76          0.8         0.77        0.51           0  
    iter=38     0.00073367      0.01         0.46         0.76         0.81         0.76         0.5           0  
    iter=39     0.00072937      0.01         0.46         0.76         0.81         0.76        0.48           0  
    iter=40     0.00072526      0.01         0.47         0.77         0.81         0.76        0.49           0  
    iter=41     0.00072135      0.01         0.47         0.76         0.81         0.78        0.48           0  
    iter=42     0.00071758      0.01         0.49         0.77         0.82         0.76        0.49           0  
    iter=43     0.00071394      0.01         0.49         0.77         0.81         0.77        0.49           0  
    iter=44     0.00071037      0.01          0.5         0.78         0.81         0.76        0.48           0  
    iter=45     0.00070687      0.01          0.5         0.77         0.81         0.76        0.49           0  
    iter=46     0.00070338      0.01          0.5         0.78         0.81         0.75        0.48           0  
    iter=47     0.00069989      0.01         0.51         0.77          0.8         0.75        0.49           0  
    iter=48     0.00069623      0.01         0.49         0.78          0.8         0.73        0.49           0  
    iter=49     0.00069256      0.01          0.5         0.77         0.78         0.73        0.48           0  
    iter=50     0.00068874      0.01          0.5         0.77         0.78         0.72        0.47           0  
    iter=51     0.00068479      0.01         0.49         0.75         0.77         0.72        0.46           0  
    iter=52     0.00068062      0.01         0.49         0.75         0.76         0.72        0.47           0  
    iter=53     0.00067623      0.01         0.48         0.75         0.75         0.72        0.46           0  
    iter=54     0.00067159      0.01         0.49         0.74         0.74         0.71        0.45           0  
    iter=55     0.00066667      0.01         0.47         0.74         0.74         0.71        0.45           0  
    iter=56     0.00066146      0.01         0.46         0.74         0.74          0.7        0.46           0  
    iter=57     0.00065599      0.01         0.45         0.72         0.73          0.7        0.46           0  
    iter=58     0.00065021      0.01         0.45         0.73         0.73         0.69        0.44           0  
    iter=59     0.00064413      0.01         0.44         0.71         0.72          0.7        0.44           0  
    iter=60     0.00063773      0.01         0.44         0.71         0.72         0.68        0.44           0  
    iter=61     0.00063103      0.01         0.44          0.7         0.71         0.69        0.43           0  
    iter=62     0.00062402      0.01         0.44          0.7          0.7         0.68        0.43           0  
    iter=63     0.00061669      0.01         0.44         0.68          0.7         0.67        0.42           0  
    iter=64      0.0006091      0.01         0.43         0.69         0.69         0.67        0.41           0  
    iter=65     0.00060125      0.01         0.42         0.68         0.68         0.66        0.42           0  
    iter=66     0.00059316      0.01         0.41         0.69         0.67         0.65        0.41           0  
    iter=67     0.00058484      0.01         0.41         0.67         0.67         0.63        0.41           0  
    iter=68     0.00057631      0.01         0.41         0.68         0.67         0.63        0.38           0  
    iter=69     0.00056758      0.01         0.41         0.67         0.66         0.62        0.38           0  
    iter=70     0.00055868      0.01          0.4         0.65         0.66         0.62        0.38           0  
    iter=71     0.00054961      0.01          0.4         0.65         0.65         0.61        0.37           0  
    iter=72     0.00054041      0.01         0.39         0.64         0.65          0.6        0.37           0  
    iter=73     0.00053108      0.01         0.39         0.64         0.65         0.59        0.36           0  
    iter=74     0.00052165      0.01         0.39         0.63         0.65         0.59        0.34           0  
    iter=75     0.00051211      0.01         0.38         0.63         0.64         0.58        0.34           0  
    iter=76      0.0005025      0.01         0.38         0.62         0.65         0.59        0.33           0  
    iter=77     0.00049282      0.01         0.37         0.62         0.64         0.58        0.34           0  
    iter=78     0.00048309      0.01         0.35         0.61         0.64         0.57        0.33           0  
    iter=79     0.00047331      0.01         0.35         0.59         0.63         0.55        0.33           0  
    iter=80      0.0004635      0.01         0.32         0.58         0.64         0.55        0.33           0  
    iter=81     0.00045367      0.01         0.31         0.57         0.62         0.55        0.33           0  
    iter=82     0.00044382      0.01         0.31         0.58         0.61         0.55        0.33           0  
    iter=83     0.00043398      0.01          0.3         0.58         0.61         0.55        0.31           0  
    iter=84     0.00042415      0.01         0.25         0.57          0.6         0.56         0.3           0  
    iter=85     0.00041433      0.01         0.23         0.57          0.6         0.55        0.28           0  
    iter=86     0.00040455      0.01         0.18         0.56          0.6         0.55        0.27           0  
    iter=87      0.0003948      0.01         0.18         0.55         0.58         0.55        0.27           0  
    iter=88     0.00038511      0.01         0.14         0.55         0.58         0.54        0.25           0  
    iter=89     0.00037547      0.01         0.11         0.56         0.57         0.55        0.23           0  
    iter=90     0.00036589      0.01          0.1         0.55         0.56         0.55        0.18           0  
    iter=91     0.00035639      0.01         0.08         0.55         0.56         0.54        0.16           0  
    iter=92     0.00034697      0.01         0.06         0.55         0.55         0.54        0.11           0  
    iter=93     0.00033764      0.01         0.04         0.54         0.55         0.53        0.09           0  
    iter=94     0.00032841      0.01         0.01         0.54         0.55         0.52        0.08           0  
    iter=95     0.00031928      0.01         0.01         0.54         0.54         0.51        0.06           0  
    iter=96     0.00031026      0.01         0.01         0.52         0.54          0.5        0.05           0  
    iter=97     0.00030136      0.01         0.01         0.52         0.54          0.5        0.05           0  
    iter=98     0.00029259      0.01         0.01         0.51         0.54         0.49        0.05           0  
    iter=99     0.00028394      0.01         0.01         0.51         0.54         0.49        0.05           0  
    iter=100    0.00027543      0.01         0.01          0.5         0.53         0.49        0.05           0  
    iter=101    0.00026706      0.01         0.01         0.48         0.53         0.48        0.05           0  
    iter=102    0.00025884      0.01         0.01         0.47         0.53         0.47        0.05           0  
    iter=103    0.00025076      0.01         0.01         0.46         0.51         0.45        0.04           0  
    iter=104    0.00024283      0.01         0.01         0.44          0.5         0.44        0.04           0  
    iter=105    0.00023507      0.01         0.01         0.43         0.49         0.43        0.03           0  
    iter=106    0.00022746      0.01         0.01         0.43         0.48         0.41        0.02           0  
    iter=107    0.00022001      0.01         0.01         0.39         0.48         0.38        0.02           0  
    iter=108    0.00021272      0.01         0.01         0.37         0.47         0.37        0.02           0  
    iter=109     0.0002056      0.01         0.01         0.35         0.45         0.36        0.02           0  
    iter=110    0.00019864      0.01         0.01         0.34         0.44         0.33        0.02           0  
    iter=111    0.00019185      0.01         0.01         0.33         0.43         0.31        0.02           0  
    iter=112    0.00018523      0.01         0.01         0.31         0.43         0.28        0.01           0  
    iter=113    0.00017878      0.01         0.01         0.31         0.42         0.27           0           0  
    iter=114    0.00017249      0.01         0.01         0.28         0.42         0.26           0           0  
    iter=115    0.00016637      0.01         0.01         0.24         0.41         0.24           0           0  
    iter=116    0.00016042      0.01         0.01          0.2          0.4         0.23           0           0  
    iter=117    0.00015463      0.01         0.01         0.19         0.37          0.2           0           0  
    iter=118    0.00014901      0.01         0.01         0.15         0.36         0.18           0           0  
    iter=119    0.00014354      0.01         0.01         0.12         0.35         0.11           0           0  
    iter=120    0.00013824      0.01         0.01         0.07         0.34         0.08           0           0  
    iter=121     0.0001331      0.01         0.01         0.06         0.33         0.08           0           0  
    iter=122    0.00012811      0.01         0.01         0.04         0.32         0.07           0           0  
    iter=123    0.00012328      0.01         0.01         0.04         0.27         0.06           0           0  
    iter=124     0.0001186      0.01         0.01         0.03         0.24         0.05           0           0  
    iter=125    0.00011407      0.01         0.01         0.03         0.21         0.05           0           0  
    iter=126    0.00010968      0.01         0.01         0.01         0.16         0.05           0           0  
    iter=127    0.00010544      0.01         0.01         0.01         0.09         0.04           0           0  
    iter=128    0.00010134         0         0.01         0.01         0.09         0.03           0           0  
    iter=129    9.7373e-05         0         0.01         0.01         0.07         0.02           0           0  
    iter=130    9.3545e-05         0         0.01         0.01         0.07         0.02           0           0  
    iter=131    8.9847e-05         0         0.01         0.01         0.06         0.01           0           0  
    iter=132    8.6278e-05         0         0.01         0.01         0.06         0.01           0           0  
    iter=133    8.2834e-05         0         0.01         0.01         0.05            0           0           0  
    iter=134    7.9513e-05         0         0.01         0.01         0.04            0           0           0  
    iter=135     7.631e-05         0         0.01         0.01         0.03            0           0           0  
    iter=136    7.3223e-05         0         0.01         0.01         0.03            0           0           0  
    iter=137    7.0248e-05         0         0.01         0.01         0.03            0           0           0  
    iter=138    6.7383e-05         0         0.01         0.01         0.03            0           0           0  
    iter=139    6.4624e-05         0         0.01         0.01         0.03            0           0           0  
    iter=140    6.1967e-05         0         0.01         0.01         0.03            0           0           0  
    iter=141    5.9411e-05         0         0.01         0.01         0.02            0           0           0  
    iter=142    5.6952e-05         0         0.01         0.01         0.02            0           0           0  
    iter=143    5.4586e-05         0         0.01         0.01         0.02            0           0           0  
    iter=144    5.2311e-05         0         0.01         0.01         0.01            0           0           0  
    iter=145    5.0124e-05         0         0.01         0.01            0            0           0           0  
    iter=146    4.8022e-05         0         0.01         0.01            0            0           0           0  
    iter=147    4.6002e-05         0         0.01         0.01            0            0           0           0  
    iter=148    4.4062e-05         0         0.01         0.01            0            0           0           0  
    iter=149    4.2199e-05         0         0.01         0.01            0            0           0           0  
    iter=150    4.0409e-05         0         0.01         0.01            0            0           0           0  
    iter=151    3.8691e-05         0         0.01         0.01            0            0           0           0  
    iter=152    3.7042e-05         0         0.01         0.01            0            0           0           0  
    iter=153     3.546e-05         0         0.01         0.01            0            0           0           0  
    iter=154    3.3942e-05         0         0.01         0.01            0            0           0           0  
    iter=155    3.2485e-05         0         0.01         0.01            0            0           0           0  
    iter=156    3.1088e-05         0         0.01         0.01            0            0           0           0  
    iter=157    2.9748e-05         0         0.01         0.01            0            0           0           0  
    iter=158    2.8464e-05         0         0.01         0.01            0            0           0           0  
    iter=159    2.7232e-05         0         0.01         0.01            0            0           0           0  
    iter=160    2.6052e-05         0         0.01         0.01            0            0           0           0  
    iter=161    2.4921e-05         0         0.01         0.01            0            0           0           0  
    iter=162    2.3837e-05         0         0.01         0.01            0            0           0           0  
    iter=163    2.2798e-05         0            0         0.01            0            0           0           0  
    iter=164    2.1803e-05         0            0         0.01            0            0           0           0  
    iter=165     2.085e-05         0            0         0.01            0            0           0           0  
    iter=166    1.9938e-05         0            0         0.01            0            0           0           0  
    iter=167    1.9064e-05         0            0         0.01            0            0           0           0  
    iter=168    1.8227e-05         0            0            0            0            0           0           0  
    iter=169    1.7426e-05         0            0            0            0            0           0           0  
    iter=170    1.6659e-05         0            0            0            0            0           0           0  
    iter=171    1.5925e-05         0            0            0            0            0           0           0  
    iter=172    1.5222e-05         0            0            0            0            0           0           0  
    iter=173     1.455e-05         0            0            0            0            0           0           0  
    iter=174    1.3907e-05         0            0            0            0            0           0           0  
    iter=175    1.3291e-05         0            0            0            0            0           0           0  
    iter=176    1.2702e-05         0            0            0            0            0           0           0  
    iter=177    1.2139e-05         0            0            0            0            0           0           0  
    iter=178      1.16e-05         0            0            0            0            0           0           0  
    iter=179    1.1084e-05         0            0            0            0            0           0           0  
    iter=180    1.0591e-05         0            0            0            0            0           0           0  
    iter=181     1.012e-05         0            0            0            0            0           0           0  
    iter=182    9.6686e-06         0            0            0            0            0           0           0  
    iter=183    9.2375e-06         0            0            0            0            0           0           0  

</pre><h2 id="15">ls_ddcmd summary</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(ls_ddcmd))
    mp_ddcmd = containers.Map(ls_ddcmd, values(mp_print_graph, ls_ddcmd));
    ff_container_map_display(mp_ddcmd, ddcmd_opt_it_row_n_keep, ddcmd_opt_it_col_n_keep);
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ddcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
           i    idx    ndim    numel    rowN    colN    sum      mean          std       coefvari       min          max   
           _    ___    ____    _____    ____    ____    ___    _________    _________    ________    __________    ________

    fa     1     1      2       100     100      1       1          0.01     0.012361     1.2361     1.7738e-10    0.070205
    faz    2     2      2       700     100      7       1     0.0014286    0.0027729     1.9411     7.3737e-15    0.028803
    fz     3     3      2         7       7      1       1       0.14286      0.11742    0.82196       0.015625      0.3125

xxx TABLE:fa xxxxxxxxxxxxxxxxxx
                c1    
            __________

    r1        0.070205
    r2       0.0026063
    r3      0.00020168
    r4       0.0026396
    r5       0.0052393
    r6       0.0055235
    r7       0.0079419
    r8       0.0071686
    r9        0.018778
    r10       0.011256
    r11       0.016463
    r12       0.018347
    r13       0.014787
    r14       0.017291
    r15       0.016447
    r16       0.029029
    r17       0.016512
    r18       0.020928
    r19       0.020306
    r20       0.017774
    r21       0.026554
    r22       0.021295
    r23       0.021552
    r24       0.025873
    r25       0.020906
    r26       0.035863
    r27       0.026356
    r28       0.045469
    r29       0.024615
    r30       0.027716
    r31       0.021314
    r32       0.022997
    r33       0.020143
    r34       0.024318
    r35       0.027234
    r36       0.024739
    r37       0.026157
    r38       0.035256
    r63      0.0010231
    r64     0.00087329
    r65     0.00081427
    r66     0.00069488
    r67     0.00058254
    r68     0.00087855
    r69      0.0002046
    r70     0.00012544
    r71     7.6934e-05
    r72     4.7201e-05
    r73     2.8971e-05
    r74      1.779e-05
    r75      1.093e-05
    r76     6.7196e-06
    r77      4.134e-06
    r78     2.5455e-06
    r79     1.5689e-06
    r80     9.6803e-07
    r81      5.981e-07
    r82     3.7011e-07
    r83     2.2944e-07
    r84     1.4254e-07
    r85     8.8764e-08
    r86     5.5432e-08
    r87     3.4727e-08
    r88     2.1834e-08
    r89     1.3783e-08
    r90     8.7382e-09
    r91     5.5658e-09
    r92     3.5625e-09
    r93     2.2914e-09
    r94     1.4809e-09
    r95     9.6136e-10
    r96     6.2651e-10
    r97     4.0964e-10
    r98     2.6874e-10
    r99     1.7738e-10
    r100    2.2109e-10

xxx TABLE:faz xxxxxxxxxxxxxxxxxx
                c1            c2            c3            c4            c5            c6            c7    
            __________    __________    __________    __________    __________    __________    __________

    r1       0.0057675      0.024017      0.028803     0.0099944     0.0015142    0.00010665    2.8716e-06
    r2        1.71e-05     0.0003154     0.0015231    0.00063848    0.00010429    7.6468e-06    2.1111e-07
    r3      0.00010718    7.1455e-05    1.9849e-05    2.9405e-06    2.4505e-07    1.0891e-08    2.0168e-10
    r4      1.7319e-05    0.00031943     0.0015426    0.00064666    0.00010562    7.7447e-06    2.1381e-07
    r5      0.00027437     0.0011601     0.0026067     0.0010228    0.00016314    1.1818e-05    3.2388e-07
    r6      0.00014574     0.0015931       0.00264    0.00098064    0.00015285    1.0932e-05     2.972e-07
    r7      0.00034468     0.0019673     0.0038837     0.0014927    0.00023608    1.7022e-05    4.6516e-07
    r8       0.0003032     0.0019074     0.0034377     0.0013007     0.0002044    1.4687e-05    4.0046e-07
    r9       0.0002017    0.00099895     0.0055075     0.0091312      0.002649    0.00027996    1.0105e-05
    r10     0.00035738     0.0020865     0.0046962     0.0032694    0.00076975    7.4179e-05    2.5428e-06
    r11     0.00034878     0.0020868     0.0051983     0.0067367     0.0018883    0.00019709    7.0696e-06
    r12     0.00026752     0.0022056     0.0060205     0.0075332     0.0020947    0.00021787    7.7998e-06
    r13     0.00029716     0.0020802     0.0048733     0.0057736     0.0015914    0.00016499    5.8974e-06
    r14     0.00036322     0.0021119     0.0060114     0.0058408     0.0025614    0.00038428    1.8207e-05
    r15     0.00034899     0.0021563     0.0047673     0.0055552     0.0030894    0.00050534    2.4937e-05
    r16      0.0001759     0.0022477      0.007388      0.013235     0.0052387    0.00071281    3.1593e-05
    r17     0.00024026     0.0016958     0.0048351     0.0057058     0.0034302     0.0005762    2.8793e-05
    r18     0.00039563     0.0023573     0.0054466     0.0070201      0.004825    0.00084035    4.2643e-05
    r19     0.00032661     0.0021383     0.0054212     0.0068772     0.0046136    0.00087948    4.9405e-05
    r20     0.00021128     0.0014896     0.0053637      0.006192     0.0035799    0.00087711    6.0961e-05
    r21     0.00038931     0.0025059     0.0056009     0.0089378     0.0074776     0.0015507    9.1433e-05
    r22      0.0002984      0.002131     0.0065003     0.0071816     0.0040008     0.0011014     8.188e-05
    r23     0.00021087    0.00087663     0.0045749     0.0076089     0.0063517     0.0017978     0.0001311
    r24     0.00034236     0.0028801      0.007691     0.0083836     0.0047719     0.0016569    0.00014765
    r25     0.00026882     0.0016856     0.0048537     0.0070838     0.0054833     0.0014241     0.0001063
    r26     0.00032524     0.0027723     0.0087578      0.012277     0.0091086     0.0024146    0.00020825
    r27     0.00021589     0.0015035      0.004809     0.0086353     0.0079689     0.0029478    0.00027553
    r28     0.00026868     0.0023195     0.0091661      0.020328      0.010633     0.0025228    0.00022999
    r29     0.00022264     0.0012959     0.0041496     0.0082157     0.0082337     0.0022888    0.00020841
    r30      0.0001977     0.0018278      0.005164     0.0078409     0.0079453     0.0042509    0.00048927
    r31     0.00019826     0.0011086     0.0032743     0.0069349     0.0068337     0.0026233    0.00034138
    r32     0.00024287     0.0017966     0.0050774     0.0071096     0.0061357      0.002339    0.00029586
    r33     9.8792e-05     0.0010612     0.0022052     0.0065733     0.0063645     0.0033967    0.00044343
    r34     0.00021685     0.0016699     0.0052261     0.0079152     0.0062699     0.0025836    0.00043597
    r35     0.00019675      0.001566     0.0051436     0.0081491     0.0071839     0.0043489    0.00064625
    r36     0.00017406     0.0014238     0.0049992     0.0083098     0.0068091     0.0026356    0.00038782
    r37     0.00015423     0.0012757     0.0047097     0.0087027     0.0072618     0.0035866    0.00046602
    r38     0.00013612     0.0010808     0.0039952     0.0096366      0.015022     0.0046115    0.00077329
    r63     2.6437e-06     3.523e-05    0.00012767    0.00025515    0.00031608    0.00021932     6.698e-05
    r64     3.3858e-06    2.9457e-05     0.0001084    0.00022111    0.00027213    0.00018613     5.267e-05
    r65     2.4006e-06    2.2789e-05    9.0418e-05    0.00019433    0.00024692    0.00018105    7.6372e-05
    r66     1.5236e-06    1.6314e-05    7.2847e-05    0.00017007    0.00022191    0.00015934    5.2882e-05
    r67     8.2583e-07    1.0089e-05    5.4526e-05    0.00014938    0.00019372    0.00013508    3.8917e-05
    r68     4.0526e-07    4.8064e-06    3.1446e-05    0.00013928     0.0003479    0.00030564    4.9063e-05
    r69     2.3514e-07    2.4317e-06    1.1845e-05    3.5459e-05    6.5328e-05    5.9251e-05     3.005e-05
    r70      1.446e-07    1.4941e-06    7.2715e-06    2.1753e-05    4.0056e-05    3.6314e-05    1.8408e-05
    r71      8.899e-08    9.1854e-07    4.4663e-06    1.3351e-05    2.4569e-05    2.2262e-05    1.1279e-05
    r72     5.4815e-08    5.6511e-07    2.7448e-06    8.1973e-06    1.5075e-05    1.3651e-05    6.9125e-06
    r73     3.3799e-08    3.4797e-07     1.688e-06    5.0358e-06    9.2536e-06    8.3742e-06    4.2376e-06
    r74     2.0866e-08    2.1447e-07    1.0389e-06    3.0954e-06    5.6829e-06     5.139e-06    2.5985e-06
    r75       1.29e-08    1.3234e-07    6.3993e-07     1.904e-06    3.4919e-06     3.155e-06     1.594e-06
    r76     7.9886e-09    8.1771e-08     3.946e-07    1.1721e-06     2.147e-06    1.9379e-06    9.7814e-07
    r77     4.9567e-09    5.0604e-08    2.4362e-07    7.2224e-07    1.3211e-06    1.1911e-06    6.0049e-07
    r78     3.0824e-09    3.1374e-08    1.5062e-07    4.4551e-07    8.1354e-07     7.325e-07    3.6883e-07
    r79     1.9219e-09    1.9493e-08    9.3282e-08    2.7517e-07    5.0149e-07    4.5083e-07    2.2666e-07
    r80      1.202e-09    1.2141e-08    5.7883e-08    1.7021e-07    3.0949e-07    2.7772e-07    1.3939e-07
    r81     7.5429e-10    7.5837e-09    3.5998e-08    1.0547e-07    1.9126e-07    1.7126e-07     8.578e-08
    r82     4.7519e-10    4.7525e-09    2.2446e-08    6.5483e-08    1.1838e-07    1.0574e-07    5.2835e-08
    r83     3.0065e-10    2.9892e-09    1.4039e-08    4.0754e-08    7.3406e-08    6.5377e-08    3.2576e-08
    r84     1.9111e-10    1.8879e-09    8.8101e-09    2.5433e-08    4.5616e-08    4.0489e-08    2.0109e-08
    r85     1.2209e-10    1.1977e-09    5.5502e-09    1.5921e-08    2.8418e-08    2.5124e-08     1.243e-08
    r86     7.8403e-11     7.635e-10    3.5114e-09    1.0002e-08    1.7755e-08    1.5626e-08    7.6959e-09
    r87     5.0608e-11    4.8918e-10    2.2318e-09    6.3088e-09     1.113e-08    9.7434e-09    4.7738e-09
    r88     3.2827e-11    3.1503e-10    1.4255e-09    3.9966e-09    7.0025e-09    6.0939e-09    2.9677e-09
    r89     2.1385e-11    2.0388e-10    9.1507e-10    2.5438e-09    4.4243e-09    3.8245e-09    1.8496e-09
    r90     1.3977e-11    1.3254e-10    5.9041e-10    1.6273e-09    2.8082e-09    2.4096e-09    1.1562e-09
    r91     9.1488e-12     8.647e-11    3.8276e-10    1.0464e-09    1.7912e-09    1.5247e-09    7.2516e-10
    r92     5.9818e-12    5.6537e-11     2.492e-10     6.763e-10    1.1486e-09    9.6934e-10    4.5655e-10
    r93     3.8902e-12    3.6963e-11    1.6277e-10    4.3928e-10    7.4045e-10    6.1941e-10    2.8867e-10
    r94     2.4991e-12    2.4077e-11    1.0651e-10    2.8661e-10    4.7993e-10    3.9792e-10    1.8338e-10
    r95     1.5672e-12    1.5533e-11    6.9656e-11    1.8773e-10    3.1273e-10    2.5705e-10    1.1709e-10
    r96     9.3908e-13    9.8154e-12    4.5365e-11    1.2338e-10    2.0484e-10      1.67e-10    7.5175e-11
    r97     5.1575e-13    5.9413e-12    2.9212e-11    8.1376e-11    1.3492e-10    1.0914e-10    4.8544e-11
    r98      2.377e-13    3.2709e-12    1.8276e-11    5.4021e-11    8.9558e-11    7.1835e-11    3.1544e-11
    r99     7.3757e-14    1.4177e-12    1.0468e-11    3.6518e-11    6.0423e-11    4.7826e-11     2.065e-11
    r100    7.3737e-15    2.7453e-13    3.9159e-12    2.6115e-11    7.7589e-11    7.6043e-11    3.7149e-11

xxx TABLE:fz xxxxxxxxxxxxxxxxxx
             c1   
          ________

    r1    0.015625
    r2     0.09375
    r3     0.23438
    r4      0.3125
    r5     0.23438
    r6     0.09375
    r7    0.015625

</pre><h2 id="16">ls_ddsna summarize full</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(ls_ddsna))

    <span class="comment">% container map subseting</span>
    mp_ddsna = containers.Map(ls_ddsna, values(mp_print_graph, ls_ddsna));

    <span class="comment">% ff_summ_nd_array parameters</span>
    it_aggd = 0;
    bl_row = 1;
    ar_permute = [2,1];
    ar_st_stats = [<span class="string">"mean"</span>];
    bl_print_table = true;
    cl_mp_datasetdesc = {};
    cl_mp_datasetdesc{1} = containers.Map({<span class="string">'name'</span>, <span class="string">'labval'</span>}, {<span class="string">'a'</span>, ar_a});
    cl_mp_datasetdesc{2} = containers.Map({<span class="string">'name'</span>, <span class="string">'labval'</span>}, {<span class="string">'z'</span>, ar_z});

    <span class="comment">% summarize</span>
    param_map_keys = keys(mp_ddsna);
    param_map_vals = values(mp_ddsna);
    <span class="keyword">for</span> i = 1:length(mp_ddsna)
        st_mt_name = param_map_keys{i};
        mt_cur = param_map_vals{i};
        st_title = [<span class="string">'FF_DS_AZ_LOOP, outcome='</span> st_mt_name];
        ff_summ_nd_array(st_title, mt_cur, <span class="keyword">...</span>
            bl_print_table, ar_st_stats, it_aggd, bl_row, <span class="keyword">...</span>
            cl_mp_datasetdesc, ar_permute);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">xxx  FF_DS_AZ_LOOP, outcome=faz  xxxxxxxxxxxxxxxxxxxxxxxxxxx
    group        a         mean_z_0_41816    mean_z_0_54897    mean_z_0_72069    mean_z_0_94612    mean_z_1_2421    mean_z_1_6306    mean_z_2_1407
    _____    __________    ______________    ______________    ______________    ______________    _____________    _____________    _____________

       1              0       0.0057675          0.024017          0.028803         0.0099944        0.0015142       0.00010665       2.8716e-06  
       2     0.00051272        1.71e-05         0.0003154         0.0015231        0.00063848       0.00010429       7.6468e-06       2.1111e-07  
       3      0.0029004      0.00010718        7.1455e-05        1.9849e-05        2.9405e-06       2.4505e-07       1.0891e-08       2.0168e-10  
       4      0.0079925      1.7319e-05        0.00031943         0.0015426        0.00064666       0.00010562       7.7447e-06       2.1381e-07  
       5       0.016407      0.00027437         0.0011601         0.0026067         0.0010228       0.00016314       1.1818e-05       3.2388e-07  
       6       0.028662      0.00014574         0.0015931           0.00264        0.00098064       0.00015285       1.0932e-05        2.972e-07  
       7       0.045213      0.00034468         0.0019673         0.0038837         0.0014927       0.00023608       1.7022e-05       4.6516e-07  
       8        0.06647       0.0003032         0.0019074         0.0034377         0.0013007        0.0002044       1.4687e-05       4.0046e-07  
       9       0.092813       0.0002017        0.00099895         0.0055075         0.0091312         0.002649       0.00027996       1.0105e-05  
      10        0.12459      0.00035738         0.0020865         0.0046962         0.0032694       0.00076975       7.4179e-05       2.5428e-06  
      11        0.16214      0.00034878         0.0020868         0.0051983         0.0067367        0.0018883       0.00019709       7.0696e-06  
      12        0.20576      0.00026752         0.0022056         0.0060205         0.0075332        0.0020947       0.00021787       7.7998e-06  
      13        0.25576      0.00029716         0.0020802         0.0048733         0.0057736        0.0015914       0.00016499       5.8974e-06  
      14        0.31242      0.00036322         0.0021119         0.0060114         0.0058408        0.0025614       0.00038428       1.8207e-05  
      15        0.37601      0.00034899         0.0021563         0.0047673         0.0055552        0.0030894       0.00050534       2.4937e-05  
      16         0.4468       0.0001759         0.0022477          0.007388          0.013235        0.0052387       0.00071281       3.1593e-05  
      17        0.52503      0.00024026         0.0016958         0.0048351         0.0057058        0.0034302        0.0005762       2.8793e-05  
      18        0.61095      0.00039563         0.0023573         0.0054466         0.0070201         0.004825       0.00084035       4.2643e-05  
      19         0.7048      0.00032661         0.0021383         0.0054212         0.0068772        0.0046136       0.00087948       4.9405e-05  
      20         0.8068      0.00021128         0.0014896         0.0053637          0.006192        0.0035799       0.00087711       6.0961e-05  
      21        0.91719      0.00038931         0.0025059         0.0056009         0.0089378        0.0074776        0.0015507       9.1433e-05  
      22         1.0362       0.0002984          0.002131         0.0065003         0.0071816        0.0040008        0.0011014        8.188e-05  
      23          1.164      0.00021087        0.00087663         0.0045749         0.0076089        0.0063517        0.0017978        0.0001311  
      24         1.3008      0.00034236         0.0028801          0.007691         0.0083836        0.0047719        0.0016569       0.00014765  
      25         1.4468      0.00026882         0.0016856         0.0048537         0.0070838        0.0054833        0.0014241        0.0001063  
      26         1.6023      0.00032524         0.0027723         0.0087578          0.012277        0.0091086        0.0024146       0.00020825  
      27         1.7673      0.00021589         0.0015035          0.004809         0.0086353        0.0079689        0.0029478       0.00027553  
      28         1.9422      0.00026868         0.0023195         0.0091661          0.020328         0.010633        0.0025228       0.00022999  
      29          2.127      0.00022264         0.0012959         0.0041496         0.0082157        0.0082337        0.0022888       0.00020841  
      30         2.3221       0.0001977         0.0018278          0.005164         0.0078409        0.0079453        0.0042509       0.00048927  
      31         2.5275      0.00019826         0.0011086         0.0032743         0.0069349        0.0068337        0.0026233       0.00034138  
      32         2.7434      0.00024287         0.0017966         0.0050774         0.0071096        0.0061357         0.002339       0.00029586  
      33           2.97      9.8792e-05         0.0010612         0.0022052         0.0065733        0.0063645        0.0033967       0.00044343  
      34         3.2075      0.00021685         0.0016699         0.0052261         0.0079152        0.0062699        0.0025836       0.00043597  
      35          3.456      0.00019675          0.001566         0.0051436         0.0081491        0.0071839        0.0043489       0.00064625  
      36         3.7158      0.00017406         0.0014238         0.0049992         0.0083098        0.0068091        0.0026356       0.00038782  
      37         3.9869      0.00015423         0.0012757         0.0047097         0.0087027        0.0072618        0.0035866       0.00046602  
      38         4.2696      0.00013612         0.0010808         0.0039952         0.0096366         0.015022        0.0046115       0.00077329  
      39          4.564      0.00012107        0.00094859         0.0031233         0.0053521        0.0053278        0.0030085       0.00059413  
      40         4.8702      0.00011013        0.00086915         0.0028937         0.0051351        0.0057474        0.0035345       0.00051967  
      41         5.1884      9.6572e-05        0.00078777         0.0026703         0.0045859        0.0045121        0.0025046       0.00045833  
      42         5.5188      8.7248e-05        0.00071724         0.0024861          0.004433         0.004792        0.0029365       0.00065424  
      43         5.8615      7.3683e-05        0.00063402         0.0022921           0.00408        0.0040599        0.0023849       0.00076949  
      44         6.2166      6.6555e-05        0.00056571         0.0021021         0.0039827        0.0041424        0.0024034       0.00044712  
      45         6.5844      5.3727e-05        0.00047499         0.0018336         0.0038695        0.0051934        0.0036298       0.00066694  
      46         6.9649        5.02e-05        0.00041706         0.0015413         0.0031592        0.0041201        0.0028759       0.00065233  
      47         7.3583      3.8515e-05        0.00034461         0.0013104         0.0026286        0.0033055        0.0022294       0.00043087  
      48         7.7647      3.8762e-05        0.00031645         0.0011393           0.00224        0.0027425        0.0018681        0.0005056  
      49         8.1844      2.6869e-05        0.00025079        0.00098735         0.0019468        0.0023577        0.0016074       0.00047379  
      50         8.6173      3.0342e-05        0.00024501         0.0008739         0.0017069        0.0020226        0.0013372       0.00033837  
      51         9.0637      1.7937e-05        0.00017156        0.00075296         0.0015224        0.0018647        0.0013561       0.00061275  
      52         9.5237      2.4004e-05        0.00019187        0.00066939         0.0013385         0.001643        0.0011091       0.00027161  
      53         9.9975      1.2847e-05        9.4195e-05        0.00056233         0.0011703        0.0014546         0.001041       0.00040151  
      54         10.485      1.8923e-05         0.0001564        0.00052384         0.0010185        0.0012564       0.00085472       0.00021477  
      55         10.987      1.6042e-05        0.00013374        0.00044905          0.000876        0.0010896       0.00077274       0.00027162  
      56         11.502      1.3754e-05        0.00011429        0.00038438        0.00075093       0.00093238       0.00063898       0.00016642  
      57         12.032      1.1496e-05        9.7466e-05        0.00032874        0.00064337       0.00080245       0.00056592       0.00018781  
      58         12.577      9.9225e-06        8.3154e-05          0.000281        0.00055042       0.00068505        0.0004715       0.00012676  
      59         13.136      8.0066e-06        7.0638e-05        0.00024013        0.00047107       0.00058769       0.00041255       0.00013186  
      60         13.709      7.0727e-06        6.0133e-05        0.00020517        0.00040307       0.00050167         0.000346       9.5318e-05  
      61         14.298      5.1804e-06        5.0627e-05        0.00017528        0.00034534       0.00043007       0.00030052       9.3589e-05  
      62         14.901      4.9433e-06        4.2878e-05        0.00014971        0.00029628       0.00036781       0.00025348       7.1043e-05  
      63         15.519      2.6437e-06         3.523e-05        0.00012767        0.00025515       0.00031608       0.00021932        6.698e-05  
      64         16.152      3.3858e-06        2.9457e-05         0.0001084        0.00022111       0.00027213       0.00018613        5.267e-05  
      65         16.801      2.4006e-06        2.2789e-05        9.0418e-05        0.00019433       0.00024692       0.00018105       7.6372e-05  
      66         17.465      1.5236e-06        1.6314e-05        7.2847e-05        0.00017007       0.00022191       0.00015934       5.2882e-05  
      67         18.144      8.2583e-07        1.0089e-05        5.4526e-05        0.00014938       0.00019372       0.00013508       3.8917e-05  
      68         18.839      4.0526e-07        4.8064e-06        3.1446e-05        0.00013928        0.0003479       0.00030564       4.9063e-05  
      69          19.55      2.3514e-07        2.4317e-06        1.1845e-05        3.5459e-05       6.5328e-05       5.9251e-05        3.005e-05  
      70         20.277       1.446e-07        1.4941e-06        7.2715e-06        2.1753e-05       4.0056e-05       3.6314e-05       1.8408e-05  
      71          21.02       8.899e-08        9.1854e-07        4.4663e-06        1.3351e-05       2.4569e-05       2.2262e-05       1.1279e-05  
      72         21.778      5.4815e-08        5.6511e-07        2.7448e-06        8.1973e-06       1.5075e-05       1.3651e-05       6.9125e-06  
      73         22.553      3.3799e-08        3.4797e-07         1.688e-06        5.0358e-06       9.2536e-06       8.3742e-06       4.2376e-06  
      74         23.345      2.0866e-08        2.1447e-07        1.0389e-06        3.0954e-06       5.6829e-06        5.139e-06       2.5985e-06  
      75         24.152        1.29e-08        1.3234e-07        6.3993e-07         1.904e-06       3.4919e-06        3.155e-06        1.594e-06  
      76         24.977      7.9886e-09        8.1771e-08         3.946e-07        1.1721e-06        2.147e-06       1.9379e-06       9.7814e-07  
      77         25.818      4.9567e-09        5.0604e-08        2.4362e-07        7.2224e-07       1.3211e-06       1.1911e-06       6.0049e-07  
      78         26.675      3.0824e-09        3.1374e-08        1.5062e-07        4.4551e-07       8.1354e-07        7.325e-07       3.6883e-07  
      79          27.55      1.9219e-09        1.9493e-08        9.3282e-08        2.7517e-07       5.0149e-07       4.5083e-07       2.2666e-07  
      80         28.441       1.202e-09        1.2141e-08        5.7883e-08        1.7021e-07       3.0949e-07       2.7772e-07       1.3939e-07  
      81          29.35      7.5429e-10        7.5837e-09        3.5998e-08        1.0547e-07       1.9126e-07       1.7126e-07        8.578e-08  
      82         30.276      4.7519e-10        4.7525e-09        2.2446e-08        6.5483e-08       1.1838e-07       1.0574e-07       5.2835e-08  
      83         31.219      3.0065e-10        2.9892e-09        1.4039e-08        4.0754e-08       7.3406e-08       6.5377e-08       3.2576e-08  
      84         32.179      1.9111e-10        1.8879e-09        8.8101e-09        2.5433e-08       4.5616e-08       4.0489e-08       2.0109e-08  
      85         33.157      1.2209e-10        1.1977e-09        5.5502e-09        1.5921e-08       2.8418e-08       2.5124e-08        1.243e-08  
      86         34.153      7.8403e-11         7.635e-10        3.5114e-09        1.0002e-08       1.7755e-08       1.5626e-08       7.6959e-09  
      87         35.166      5.0608e-11        4.8918e-10        2.2318e-09        6.3088e-09        1.113e-08       9.7434e-09       4.7738e-09  
      88         36.198      3.2827e-11        3.1503e-10        1.4255e-09        3.9966e-09       7.0025e-09       6.0939e-09       2.9677e-09  
      89         37.247      2.1385e-11        2.0388e-10        9.1507e-10        2.5438e-09       4.4243e-09       3.8245e-09       1.8496e-09  
      90         38.314      1.3977e-11        1.3254e-10        5.9041e-10        1.6273e-09       2.8082e-09       2.4096e-09       1.1562e-09  
      91         39.399      9.1488e-12         8.647e-11        3.8276e-10        1.0464e-09       1.7912e-09       1.5247e-09       7.2516e-10  
      92         40.503      5.9818e-12        5.6537e-11         2.492e-10         6.763e-10       1.1486e-09       9.6934e-10       4.5655e-10  
      93         41.625      3.8902e-12        3.6963e-11        1.6277e-10        4.3928e-10       7.4045e-10       6.1941e-10       2.8867e-10  
      94         42.765      2.4991e-12        2.4077e-11        1.0651e-10        2.8661e-10       4.7993e-10       3.9792e-10       1.8338e-10  
      95         43.924      1.5672e-12        1.5533e-11        6.9656e-11        1.8773e-10       3.1273e-10       2.5705e-10       1.1709e-10  
      96         45.102      9.3908e-13        9.8154e-12        4.5365e-11        1.2338e-10       2.0484e-10         1.67e-10       7.5175e-11  
      97         46.298      5.1575e-13        5.9413e-12        2.9212e-11        8.1376e-11       1.3492e-10       1.0914e-10       4.8544e-11  
      98         47.513       2.377e-13        3.2709e-12        1.8276e-11        5.4021e-11       8.9558e-11       7.1835e-11       3.1544e-11  
      99         48.747      7.3757e-14        1.4177e-12        1.0468e-11        3.6518e-11       6.0423e-11       4.7826e-11        2.065e-11  
     100             50      7.3737e-15        2.7453e-13        3.9159e-12        2.6115e-11       7.7589e-11       7.6043e-11       3.7149e-11  

</pre><h2 id="17">ls_ffgrh graph</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(ls_ddgrh))

    <span class="comment">% container map subseting</span>
    mp_ddgrh = containers.Map(ls_ddgrh, values(mp_print_graph, ls_ddgrh));

    <span class="comment">% container map settings</span>
    mp_support_graph = containers.Map(<span class="string">'KeyType'</span>, <span class="string">'char'</span>, <span class="string">'ValueType'</span>, <span class="string">'any'</span>);
    mp_support_graph(<span class="string">'st_legend_loc'</span>) = <span class="string">'best'</span>;
    mp_support_graph(<span class="string">'bl_graph_logy'</span>) = true; <span class="comment">% do not log</span>
    mp_support_graph(<span class="string">'st_rowvar_name'</span>) = <span class="string">'shock='</span>;
    mp_support_graph(<span class="string">'it_legend_select'</span>) = 11; <span class="comment">% how many shock legends to show</span>
    mp_support_graph(<span class="string">'st_rounding'</span>) = <span class="string">'6.2f'</span>; <span class="comment">% format shock legend</span>

    <span class="comment">% Overide graph options here with external parameters</span>
    <span class="keyword">if</span> (length(varargin)&gt;=3)
        mp_support_graph = [mp_support_graph; mp_support_graph_ext];
    <span class="keyword">end</span>

    <span class="comment">% summarize</span>
    param_map_keys = keys(mp_ddgrh);
    param_map_vals = values(mp_ddgrh);
    <span class="keyword">for</span> i = 1:length(mp_ddgrh)
        <span class="comment">% Get matrix and key</span>
        st_mt_name = param_map_keys{i};
        mt_cur = param_map_vals{i};

        <span class="keyword">if</span> (strcmp(st_mt_name, <span class="string">'faz'</span>))

            <span class="comment">% First Show F(a,z) as Y</span>
            <span class="comment">% Color</span>
            mp_support_graph(<span class="string">'cl_colors'</span>) = <span class="string">'copper'</span>; <span class="comment">% any predefined matlab colormap</span>
            <span class="comment">% Update Title and Y label</span>
            mp_support_graph(<span class="string">'cl_st_graph_title'</span>) = {[<span class="string">'f(a,z), savings state =x, shock state = color, joint'</span>]};
            mp_support_graph(<span class="string">'cl_st_ytitle'</span>) = {[<span class="string">'f(a,z) joint mass'</span>]};
            mp_support_graph(<span class="string">'cl_st_xtitle'</span>) = {<span class="string">'savings states, a'</span>};
            <span class="comment">% Call function</span>
            ff_graph_grid(mt_cur', ar_z, ar_a, mp_support_graph);

            <span class="comment">% Show F(a,z) as Scatter Size</span>
            <span class="comment">% Color</span>
            mp_support_graph(<span class="string">'cl_colors'</span>) = <span class="string">'black'</span>; <span class="comment">% any predefined matlab colormap</span>
            <span class="comment">% Update Title and Y label</span>
            mp_support_graph(<span class="string">'cl_st_graph_title'</span>) = {[<span class="string">'F(a,z), Prob Mass at State-Space as Scatter Size'</span>]};
            mp_support_graph(<span class="string">'cl_st_ytitle'</span>) = {<span class="string">'shock states, z'</span>};
            mp_support_graph(<span class="string">'cl_st_xtitle'</span>) = {<span class="string">'savings states, a'</span>};
            mp_support_graph(<span class="string">'st_rowvar_name'</span>) = <span class="string">'z ='</span>;
            mp_support_graph(<span class="string">'bl_graph_logy'</span>) = false;
            <span class="comment">% Call function distributional</span>
            ff_graph_grid(mt_cur', ar_z, ar_a, mp_support_graph, <span class="string">'dist'</span>);

        <span class="keyword">elseif</span> (strcmp(st_mt_name, <span class="string">'fa'</span>))

            <span class="comment">% Color</span>
            mp_support_graph(<span class="string">'cl_colors'</span>) = <span class="string">'lines'</span>; <span class="comment">% any predefined matlab colormap</span>
            <span class="comment">% Update Title and Y label</span>
            mp_support_graph(<span class="string">'cl_st_graph_title'</span>) = {[<span class="string">'f(a), savings state =x, marginal'</span>]};
            mp_support_graph(<span class="string">'cl_st_ytitle'</span>) = {[<span class="string">'f(a) marginal mass'</span>]};
            mp_support_graph(<span class="string">'cl_st_xtitle'</span>) = {<span class="string">'savings states, a'</span>};
            <span class="comment">% Call function</span>
            ff_graph_grid(mt_cur', [<span class="string">"shock"</span>], ar_a, mp_support_graph);

        <span class="keyword">elseif</span> (strcmp(st_mt_name, <span class="string">'fz'</span>))

            <span class="comment">% Color</span>
            mp_support_graph(<span class="string">'cl_colors'</span>) = <span class="string">'gray'</span>; <span class="comment">% any predefined matlab colormap</span>
            <span class="comment">% Update Title and Y label</span>
            mp_support_graph(<span class="string">'cl_st_graph_title'</span>) = {[<span class="string">'f(z), shock state =x, stationary'</span>]};
            mp_support_graph(<span class="string">'cl_st_ytitle'</span>) = {[<span class="string">'f(z) marginal mass'</span>]};
            mp_support_graph(<span class="string">'cl_st_xtitle'</span>) = {<span class="string">'shock states, z'</span>};
            <span class="comment">% Call function</span>
            ff_graph_grid(mt_cur', [<span class="string">"f(z)"</span>], ar_z, mp_support_graph);

        <span class="keyword">end</span>
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ds_az_loop_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ds_az_loop_02.png" alt=""> <img vspace="5" hspace="5" src="ff_ds_az_loop_03.png" alt=""> <img vspace="5" hspace="5" src="ff_ds_az_loop_04.png" alt=""> <img vspace="5" hspace="5" src="ff_ds_az_loop_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ds_az_loop_06.png" alt=""> <h2 id="18">Store Results for Output</h2><pre class="codeinput">mp_valpoldist_out = containers.Map(ls_dsout, values(mp_print_graph, ls_dsout));
</pre><h2 id="19">Distributional Statistics</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(ls_stout))

    <span class="comment">% container map subseting</span>
    mp_slout = containers.Map(ls_stout, values(mp_valpol, ls_stout));

    mp_cl_ar_xyz_of_s = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);

    param_map_keys = keys(mp_slout);
    param_map_vals = values(mp_slout);
    <span class="keyword">for</span> i = 1:length(mp_slout)
        st_mt_name = param_map_keys{i};
        mt_cur = param_map_vals{i};

        mp_cl_ar_xyz_of_s(st_mt_name) = {mt_cur(:), zeros(1)};
    <span class="keyword">end</span>

    <span class="comment">% Add Names to list</span>
    mp_cl_ar_xyz_of_s(<span class="string">'ar_st_y_name'</span>) = string(ls_stout);

    <span class="comment">% controls</span>
    mp_support = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
    mp_support(<span class="string">'ar_fl_percentiles'</span>) = [0.01 0.1 1 5 10 20 25 30 40 50 60 70 75 80 90 95 99 99.9 99.99];
    mp_support(<span class="string">'bl_display_final'</span>) = true;
    mp_support(<span class="string">'bl_display_detail'</span>) = false;
    mp_support(<span class="string">'bl_display_drvm2outcomes'</span>) = false;
    mp_support(<span class="string">'bl_display_drvstats'</span>) = false;
    mp_support(<span class="string">'bl_display_drvm2covcor'</span>) = false;

    <span class="comment">% Call Function</span>
    mp_cl_mt_xyz_of_s = ff_simu_stats(mt_dist_az(:), mp_cl_ar_xyz_of_s, mp_support);
    mp_valpoldist_out(<span class="string">'mp_cl_mt_xyz_of_s'</span>) = mp_cl_mt_xyz_of_s;
<span class="keyword">end</span>
</pre><pre class="codeoutput">xxx tb_outcomes: all stats xxx
    OriginalVariableNames         ap            v             c             y            coh        savefraccoh
    ______________________    __________    __________    __________    __________    __________    ___________

    {'mean'              }        2.7094        6.6576        1.5089        1.5084        4.2183       0.48487 
    {'sd'                }        2.8976        2.0599       0.35843       0.52611        3.2096       0.25477 
    {'coefofvar'         }        1.0694        0.3094       0.23755       0.34879       0.76088       0.52544 
    {'min'               }             0        1.6927       0.58543       0.58543       0.58543             0 
    {'max'               }            50        19.139        4.9969        4.9969        54.997       0.93121 
    {'pYis0'             }      0.070216             0             0             0             0      0.070216 
    {'pYls0'             }             0             0             0             0             0             0 
    {'pYgr0'             }       0.92978             1             1             1             1       0.92978 
    {'pYisMINY'          }      0.070216     0.0057675     0.0057675     0.0057675     0.0057675      0.070216 
    {'pYisMAXY'          }    2.1143e-10    3.7149e-11    3.7149e-11    3.7149e-11    3.7149e-11     2.065e-11 
    {'p0_01'             }             0        1.6927       0.58543       0.58543       0.58543             0 
    {'p0_1'              }             0        1.6927       0.58543       0.58543       0.58543             0 
    {'p1'                }             0        2.7674       0.76855       0.61362       0.76855             0 
    {'p5'                }             0         3.273       0.91608       0.77504         1.009             0 
    {'p10'               }       0.06647        4.0961        1.0308       0.92803        1.1055      0.067651 
    {'p20'               }       0.37601        4.8781        1.2371        1.0319         1.555       0.22796 
    {'p25'               }       0.52503        5.2636        1.2781        1.0731        1.8354       0.28067 
    {'p30'               }        0.7048        5.4822        1.3424        1.1472        2.0866       0.35907 
    {'p40'               }        1.3008        6.0574        1.3953        1.3424        2.6774       0.48584 
    {'p50'               }        1.9422         6.542        1.4931        1.4023        3.3444       0.54915 
    {'p60'               }        2.5275        7.1265        1.6174        1.4954        4.1208       0.60499 
    {'p70'               }         3.456         7.657        1.6502        1.7803        5.1554       0.67918 
    {'p75'               }        3.9869        8.0469         1.733         1.824        5.7555       0.69673 
    {'p80'               }         4.564        8.4125        1.8179        1.8875        6.1793       0.72076 
    {'p90'               }        6.5844        9.3821        1.9734        2.3349         8.568       0.76882 
    {'p95'               }        8.1844        10.225        2.1388        2.4776        10.358       0.80411 
    {'p99'               }        13.136        11.834        2.3359        3.1677        15.511       0.85404 
    {'p99_9'             }        18.839        13.486        2.7733        3.4782        21.332       0.88316 
    {'p99_99'            }        21.778        14.354        3.0939        3.7505         24.78       0.89063 
    {'fl_cov_ap'         }         8.396        5.2587       0.88866       0.93721        9.2847       0.58458 
    {'fl_cor_ap'         }             1       0.88106       0.85565       0.61478       0.99833        0.7919 
    {'fl_cov_v'          }        5.2587         4.243       0.71989       0.93806        5.9786         0.453 
    {'fl_cor_v'          }       0.88106             1       0.97505       0.86559       0.90428       0.86321 
    {'fl_cov_c'          }       0.88866       0.71989       0.12847       0.15253        1.0171      0.079518 
    {'fl_cor_c'          }       0.85565       0.97505             1       0.80886       0.88413        0.8708 
    {'fl_cov_y'          }       0.93721       0.93806       0.15253        0.2768        1.0897      0.080824 
    {'fl_cor_y'          }       0.61478       0.86559       0.80886             1       0.64534         0.603 
    {'fl_cov_coh'        }        9.2847        5.9786        1.0171        1.0897        10.302        0.6641 
    {'fl_cor_coh'        }       0.99833       0.90428       0.88413       0.64534             1       0.81215 
    {'fl_cov_savefraccoh'}       0.58458         0.453      0.079518      0.080824        0.6641      0.064906 
    {'fl_cor_savefraccoh'}        0.7919       0.86321        0.8708         0.603       0.81215             1 
    {'fracByP0_01'       }             0     0.0014664     0.0022377     0.0022385    0.00080043             0 
    {'fracByP0_1'        }             0     0.0014664     0.0022377     0.0022385    0.00080043             0 
    {'fracByP1'          }             0     0.0029302       0.01567       0.00403     0.0055106             0 
    {'fracByP5'          }             0      0.021763      0.026172       0.02466      0.015702             0 
    {'fracByP10'         }     0.0004071      0.050764      0.058937       0.05144      0.022123     0.0021411 
    {'fracByP20'         }     0.0096198        0.1171       0.13549       0.11855       0.05416      0.033082 
    {'fracByP25'         }      0.017608       0.15851       0.17677       0.15694      0.074837      0.057303 
    {'fracByP30'         }       0.02761       0.19906       0.21973       0.19018       0.09783      0.092029 
    {'fracByP40'         }      0.071719       0.28454        0.3135       0.28477       0.15542       0.18016 
    {'fracByP50'         }       0.15388       0.38017       0.40577       0.38385       0.23227       0.28549 
    {'fracByP60'         }       0.21684       0.48325       0.51534       0.46249       0.31381        0.4039 
    {'fracByP70'         }       0.32573       0.59393       0.62048       0.57438       0.42716       0.54543 
    {'fracByP75'         }       0.39815       0.65416       0.68002       0.63899        0.4882       0.60905 
    {'fracByP80'         }       0.48482       0.72413         0.732       0.69931       0.55881        0.6822 
    {'fracByP90'         }        0.6819       0.84902       0.85906        0.8281       0.73338       0.83355 
    {'fracByP95'         }       0.79123       0.91664       0.92592       0.90812       0.83969       0.91574 
    {'fracByP99'         }        0.9433       0.98136       0.98418       0.97889       0.95655       0.98225 
    {'fracByP99_9'       }       0.99595       0.99805       0.99819       0.99776       0.99501       0.99858 
    {'fracByP99_99'      }       0.99934       0.99982       0.99985        0.9998       0.99938       0.99984 

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 4
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% FF_DS_AZ_LOOP (Looped Discrete Choice) Dynamic Savings Distribution
%    For the AZ model, dynamic savings with Shocks. Looped distributional
%    solution for discrete asset choices. Policy function maps to
%    state-space. Given Shock transition and policy function, the model
%    generates various joint discrete random variables. Distributions over
%    consumption, savings, cash-on-hand, income, etc...
%
%    This function assumes that savings choices are on the savings grid. 
%
%    * MP_PARAMS controls model preference, prices, shock and asset grid
%    parameters.
%    * MP_SUPPORT controls convergence criterion, printing and summary
%    controls
%
%    % Some MP_PARAMS that can be modified, see below
%    mp_params = containers.Map('KeyType','char', 'ValueType','any');
%    mp_params('fl_crra') = 1.5;
%    mp_params('fl_beta') = 0.95;
%    mp_params('fl_w') = 1.05;
%    mp_params('fl_r') = 0.03;
%    mp_params('it_a_n') = 25;
%    mp_params('it_z_n') = 5;
%
%    mp_support = containers.Map('KeyType','char', 'ValueType','any');
%    mp_support('it_maxiter_ds') = 500;
%    mp_support('fl_tol_ds') = 10e-5;
%    % printer various information
%    mp_support('bl_timer') = true;
%    mp_support('bl_print_params') = false;
%    mp_support('bl_print_iterinfo') = false;
%    % These names must match keys of mp_solu: faz= joint distribution over
%    a and z, fa=marginal distribution over a, fz= the statationary
%    distribution of the z shock process, v=value, ap=savings choice,
%    c=consumption, y=income, coh=cash-on-hand (income + savings),
%    savefraccoh = ap/coh.
%    % generate distributional mass for what faz joint mass, fa mass over
%    savings, fz, mass over shocks
%    mp_support('ls_dsout') = {'faz', 'fa', 'fz'};
%    % Solution outcomes for statistics: must include ap for distribution
%    mp_support('ls_slout') = {'ap', 'v', 'c', 'y', 'coh', 'savefraccoh'};
%    % present which distribution: only faz is allowed
%    mp_support_ext('ls_ddsna') = {'faz'};
%    % which distributional outcomes to graph: faz or fa allowed
%    mp_support_ext('ls_ddgrh') = {'faz', 'fa', 'fz'};
%
%    [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP() default savings and shock
%    model distributional simulation.
%
%    [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS) change model
%    parameters through MP_PARAMS
%
%    [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS, MP_SUPPORT)
%    change various printing, storaging, graphing, convergence etc controls
%    through MP_SUPPORT
%
%    [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS, MP_SUPPORT,
%    MP_SUPPORT_GRAPH) also changing graphing options, see the
%    FF_GRAPH_GRID function for what key value paris can be specified.
%
%    [MP_VALPOLDIST_OUT, FLAG] = FF_DS_AZ_LOOP(MP_PARAMS, MP_SUPPORT,
%    MP_SUPPORT_GRAPH, MP_VALPOL) Solve the distributional problem given
%    provided MP_VALPOL which is the map that is the output of VFI. This
%    should generally not be called, the function should solve for value
%    and policy function given new parameters.
%
%    see also FX_DS_AZ_LOOP, FF_DS_AZ_CTS_LOOP, FF_DS_AZ_CTS_VEC,
%    FF_GRAPH_GRID
%

%%
function [mp_valpoldist_out, flag] = ff_ds_az_loop(varargin)

%% Set Default and Parse Inputs
if (~isempty(varargin))
    
    if (length(varargin) == 1)
        [mp_params_ext] = varargin{:};
    elseif (length(varargin) == 2)
        [mp_params_ext, mp_support_ext] = varargin{:};
    elseif (length(varargin) == 3)
        [mp_params_ext, mp_support_ext, mp_support_graph_ext] = varargin{:};
    elseif (length(varargin) == 4)
        [mp_params_ext, mp_support_ext, mp_support_graph_ext, mp_valpol] = varargin{:};
    end
    
else
    close all;
    
    mp_params_ext = containers.Map('KeyType','char', 'ValueType','any');    
%     mp_params_ext('solu_method') = 'bisec_vec';
%     mp_params_ext('solu_method') = 'mzoom_vec';
    mp_params_ext('solu_method') = 'vec';
    
    mp_support_ext = containers.Map('KeyType','char', 'ValueType','any');
        
    mp_support_ext('bl_timer') = true;
    mp_support_ext('bl_print_params') = true;
    mp_support_ext('bl_print_iterinfo') = true;
       
    %savings, fz, mass over shocks
    mp_support_ext('ls_dsout') = {'faz', 'fa', 'fz'};
    % Solution outcomes for statistics: must include ap for distribution
    mp_support_ext('ls_slout') = {'ap', 'v', 'c', 'y', 'coh', 'savefraccoh'};
    % outcome for ff_container_map_display
    mp_support_ext('ls_ddcmd') = {'faz', 'fa', 'fz'};
    % which distributional outcomes to graph
    mp_support_ext('ls_ddgrh') = {'faz', 'fa', 'fz'};
    mp_support_ext('ddcmd_opt_it_row_n_keep') = 75;
    mp_support_ext('ddcmd_opt_it_col_n_keep') = 9;
    
end

%% Default Model Parameters
% Parameters for both VFI and Dist
mp_params = containers.Map('KeyType','char', 'ValueType','any');
mp_params('solu_method') = 'bisec';

mp_params('fl_crra') = 1.5;
mp_params('fl_beta') = 0.95;

mp_params('fl_w') = 1.40;
mp_params('fl_r') = 0.04;

mp_params('fl_a_min') = 0;
mp_params('fl_a_max') = 50;
mp_params('it_a_n') = 100;
mp_params('st_grid_type') = 'grid_powerspace';

mp_params('fl_z_persist') = 0.80;
mp_params('fl_shk_std') = 0.20;
mp_params('it_z_n') = 7;

% override default support_map values
if (length(varargin)>=1 || isempty(varargin))
    mp_params = [mp_params; mp_params_ext];
end

%% Parse mp_params
params_group = values(mp_params, {'solu_method'});
[solu_method] = params_group{:};
params_group = values(mp_params, {'fl_a_min', 'fl_a_max', 'it_a_n', 'st_grid_type'});
[fl_a_min, fl_a_max, it_a_n, st_grid_type] = params_group{:};
params_group = values(mp_params, {'fl_z_persist', 'fl_shk_std', 'it_z_n'});
[fl_z_persist, fl_shk_std, it_z_n] = params_group{:};

%% Generate A and Z Grids
% Same min and max and grid points
[ar_a] = ff_saveborr_grid(fl_a_min, fl_a_max, it_a_n, st_grid_type);
ar_a = ar_a';

% shock vector and transition, normalize mean exp(shk) to 1
[ar_z, mt_z_trans] = ffy_rouwenhorst(fl_z_persist, fl_shk_std, it_z_n);
% [ar_z, mt_z_trans] = ffy_tauchen(fl_z_persist, fl_shk_std, it_z_n);
% normalize mean of exp to 1, fl_shk_std does not shift mean.
ar_z_stationary = mt_z_trans^1000;
ar_z_stationary = ar_z_stationary(1,:);
fl_labor_agg = ar_z_stationary*exp(ar_z);
ar_z = exp(ar_z')/fl_labor_agg;

%% Default Support Parameters
% support_map
mp_support = containers.Map('KeyType','char', 'ValueType','any');

% Iteration Control
mp_support('it_maxiter_ds') = 500;
mp_support('fl_tol_ds') = 1e-5;

% printer various information
mp_support('bl_timer') = true;
mp_support('bl_print_params') = false;
mp_support('bl_print_iterinfo') = false;

% These names must match keys of mp_solu:
%savings, fz, mass over shocks
mp_support('ls_dsout') = {'faz', 'fa'};
% Solution outcomes for statistics: must include ap for distribution
mp_support('ls_stout') = {'ap', 'v', 'c', 'y', 'coh', 'savefraccoh'};
% outcome for ff_container_map_display
mp_support('ls_ddcmd') = {'faz', 'fa', 'fz'};
% present which distribution: only faz is allowed
mp_support('ls_ddsna') = {'faz'};
% which distributional outcomes to graph: faz or fa allowed
mp_support('ls_ddgrh') = {'faz', 'fa'};
mp_support('ddcmd_opt_it_row_n_keep') = 10;
mp_support('ddcmd_opt_it_col_n_keep') = 9;

% override default support_map values
if (length(varargin)>=2 || isempty(varargin))
    mp_support = [mp_support; mp_support_ext];
end

% Parse mp_support
params_group = values(mp_support, {'it_maxiter_ds', 'fl_tol_ds'});
[it_maxiter_ds, fl_tol_ds] = params_group{:};
params_group = values(mp_support, {'bl_timer', 'bl_print_iterinfo'});
[bl_timer, bl_print_iterinfo] = params_group{:};
params_group = values(mp_support, {'ls_stout', 'ls_dsout', 'ls_ddcmd', 'ls_ddsna', 'ls_ddgrh', ...
    'ddcmd_opt_it_row_n_keep', 'ddcmd_opt_it_col_n_keep'});
[ls_stout, ls_dsout, ls_ddcmd, ls_ddsna, ls_ddgrh, ...
    ddcmd_opt_it_row_n_keep, ddcmd_opt_it_col_n_keep] = params_group{:};

%% Solve the Value Function

if (length(varargin) ~= 4)
    
    mp_support('ls_slout') = mp_support('ls_stout');
    
    if (strcmp(solu_method, 'bisec_loop'))
        [mp_valpol] = ff_vfi_az_bisec_loop(mp_params, mp_support);
    elseif (strcmp(solu_method, 'bisec_vec'))
        [mp_valpol] = ff_vfi_az_bisec_vec(mp_params, mp_support);
    elseif (strcmp(solu_method, 'mzoom_loop'))
        [mp_valpol] = ff_vfi_az_mzoom_loop(mp_params, mp_support);
    elseif (strcmp(solu_method, 'mzoom_vec'))
        [mp_valpol] = ff_vfi_az_mzoom_vec(mp_params, mp_support);
    elseif (strcmp(solu_method, 'loop'))
        [mp_valpol] = ff_vfi_az_loop(mp_params, mp_support);
    elseif (strcmp(solu_method, 'vec'))
        [mp_valpol] = ff_vfi_az_vec(mp_params, mp_support);
    end    
%     params_group = values(mp_valpol_out, mp_support_ext('ls_slout'));
%     [ls_slout, ls_ffcmd, ls_ffsna, ls_ffgrh] = params_group{:};
    
end
   
mt_aprime = mp_valpol('ap');

%% Initialize Matrix
mt_dist_az_init = ones(length(ar_a),it_z_n)/length(ar_a)/it_z_n;
mt_dist_az_cur = mt_dist_az_init;
mt_dist_az_zeros = zeros(length(ar_a),it_z_n);

ar_dist_diff_norm = zeros([it_maxiter_ds, 1]);
mt_dist_perc_change = zeros([it_maxiter_ds, it_z_n]);

%% Start Timer
if (bl_timer)
    tic
end

%% Iterate and Get Distribution
% initialize
it_iter = 0;

% After converge, one more iteration to store results
bl_continue = true;
bl_converged = false;

% Loop 0, continuous VFI iteration until convergence
while bl_continue
    it_iter = it_iter + 1;
        
    % initialize empty
    mt_dist_az = mt_dist_az_zeros;
    
    % loop 1: over exogenous states
    for it_z_i = 1:it_z_n

        % loop 2: over endogenous states
        for it_a_j = 1:length(ar_a)

            % f(a'|a) = 1 for only one a'
            % get lowe rand higher index
            fl_aprime = mt_aprime(it_a_j, it_z_i);
            it_aprime_idx = find(ar_a == fl_aprime);

            % loop 3: loop over future shocks
            % E_{a,z}(f(a',z'|a,z)*f(a,z))
            for it_zp_q = 1:it_z_n
                
                % current probablity at (a,z)
                fl_cur_za_prob = mt_dist_az_cur(it_a_j, it_z_i);

                % f(z'|z) transition
                fl_ztoz_trans =  mt_z_trans(it_z_i, it_zp_q);
                
                % f(a',z'|a,z)*f(a,z)
                fl_zfromza = fl_cur_za_prob*fl_ztoz_trans;

                % cumulating
                mt_dist_az(it_aprime_idx, it_zp_q) = mt_dist_az(it_aprime_idx, it_zp_q) + fl_zfromza;
                
            end
        end

    end

    % Difference across iterations
    fl_diff = norm(mt_dist_az-mt_dist_az_cur);    
    if (bl_print_iterinfo)
        ar_dist_diff_norm(it_iter) = fl_diff;
        mt_dist_perc_change(it_iter, :) = sum((abs(mt_dist_az - mt_dist_az_cur) > fl_tol_ds))/(it_a_n);
    end
    
    % Update
    mt_dist_az_cur = mt_dist_az;   
       
    % Update Continue Criterion
    if bl_converged
        bl_continue = false;
    elseif(fl_diff <= fl_tol_ds || it_iter >= it_maxiter_ds)
        bl_converged = true;
        if (fl_diff <= fl_tol_ds) 
            flag = 1;
        else
            flag = 2;
        end
    end
    
    % Print Iteration Record
    if(bl_print_iterinfo)
        disp(['FF_DS_AZ_CTS_LOOP, it_iter:' num2str(it_iter) ...
            ', fl_diff:' num2str(fl_diff)]);
    end
    
end

%% Timer Stop
if (bl_timer)
    toc
end

%% Results for Printing, and Graphing
mp_print_graph = containers.Map('KeyType','char', 'ValueType','any');
mp_print_graph('faz') = mt_dist_az;
mp_print_graph('fa') = sum(mt_dist_az,2);
mp_print_graph('fz') = sum(mt_dist_az,1)';

%% Show Value Function Convergence Information
if (bl_print_iterinfo)
    
    it_z_select = unique(round(linspace(1,length(ar_z), 7)));
    ar_z_select = ar_z(it_z_select);
    tb_dist_alliter = array2table([ar_dist_diff_norm(1:it_iter)';...
        mt_dist_perc_change(1:it_iter,it_z_select)']');
    ar_st_col_zs = matlab.lang.makeValidName(strcat('z=', string(ar_z_select)));
    cl_col_names = ['distgap', ar_st_col_zs];
    cl_row_names = strcat('iter=', string(1:it_iter));
    tb_dist_alliter.Properties.VariableNames = cl_col_names;
    tb_dist_alliter.Properties.RowNames = cl_row_names;
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Value Function Iteration Per Iteration Changes');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('distgap = norm(mt_dist_az - mt_dist_az_cur): distributional function difference across iterations');
    disp(['z1 = z1 perc change: sum((abs(mt_dist_az - mt_dist_az_cur) > fl_tol_ds))/(it_a_n);: percentage of state space'...
        ' points conditional on shock where the distribution mass is changing larger than fl_tol_ds across iterations']);
    disp(tb_dist_alliter);
    
end

%% ls_ddcmd summary

if (~isempty(ls_ddcmd))
    mp_ddcmd = containers.Map(ls_ddcmd, values(mp_print_graph, ls_ddcmd));
    ff_container_map_display(mp_ddcmd, ddcmd_opt_it_row_n_keep, ddcmd_opt_it_col_n_keep);
end

%% ls_ddsna summarize full
if (~isempty(ls_ddsna))
    
    % container map subseting
    mp_ddsna = containers.Map(ls_ddsna, values(mp_print_graph, ls_ddsna));
    
    % ff_summ_nd_array parameters
    it_aggd = 0;
    bl_row = 1;
    ar_permute = [2,1];
    ar_st_stats = ["mean"];
    bl_print_table = true;
    cl_mp_datasetdesc = {};
    cl_mp_datasetdesc{1} = containers.Map({'name', 'labval'}, {'a', ar_a});
    cl_mp_datasetdesc{2} = containers.Map({'name', 'labval'}, {'z', ar_z});
    
    % summarize
    param_map_keys = keys(mp_ddsna);
    param_map_vals = values(mp_ddsna);
    for i = 1:length(mp_ddsna)
        st_mt_name = param_map_keys{i};
        mt_cur = param_map_vals{i};
        st_title = ['FF_DS_AZ_LOOP, outcome=' st_mt_name];
        ff_summ_nd_array(st_title, mt_cur, ...
            bl_print_table, ar_st_stats, it_aggd, bl_row, ...
            cl_mp_datasetdesc, ar_permute);
    end
    
end

%% ls_ffgrh graph
if (~isempty(ls_ddgrh))
    
    % container map subseting
    mp_ddgrh = containers.Map(ls_ddgrh, values(mp_print_graph, ls_ddgrh));
    
    % container map settings
    mp_support_graph = containers.Map('KeyType', 'char', 'ValueType', 'any');
    mp_support_graph('st_legend_loc') = 'best';
    mp_support_graph('bl_graph_logy') = true; % do not log
    mp_support_graph('st_rowvar_name') = 'shock=';
    mp_support_graph('it_legend_select') = 11; % how many shock legends to show
    mp_support_graph('st_rounding') = '6.2f'; % format shock legend
    
    % Overide graph options here with external parameters
    if (length(varargin)>=3)
        mp_support_graph = [mp_support_graph; mp_support_graph_ext];
    end
    
    % summarize
    param_map_keys = keys(mp_ddgrh);
    param_map_vals = values(mp_ddgrh);
    for i = 1:length(mp_ddgrh)
        % Get matrix and key
        st_mt_name = param_map_keys{i};
        mt_cur = param_map_vals{i};
        
        if (strcmp(st_mt_name, 'faz'))
            
            % First Show F(a,z) as Y
            % Color
            mp_support_graph('cl_colors') = 'copper'; % any predefined matlab colormap           
            % Update Title and Y label            
            mp_support_graph('cl_st_graph_title') = {['f(a,z), savings state =x, shock state = color, joint']};
            mp_support_graph('cl_st_ytitle') = {['f(a,z) joint mass']};
            mp_support_graph('cl_st_xtitle') = {'savings states, a'};
            % Call function
            ff_graph_grid(mt_cur', ar_z, ar_a, mp_support_graph);
            
            % Show F(a,z) as Scatter Size
            % Color
            mp_support_graph('cl_colors') = 'black'; % any predefined matlab colormap           
            % Update Title and Y label            
            mp_support_graph('cl_st_graph_title') = {['F(a,z), Prob Mass at State-Space as Scatter Size']};
            mp_support_graph('cl_st_ytitle') = {'shock states, z'};
            mp_support_graph('cl_st_xtitle') = {'savings states, a'};
            mp_support_graph('st_rowvar_name') = 'z =';
            mp_support_graph('bl_graph_logy') = false;
            % Call function distributional
            ff_graph_grid(mt_cur', ar_z, ar_a, mp_support_graph, 'dist');
                        
        elseif (strcmp(st_mt_name, 'fa'))
            
            % Color
            mp_support_graph('cl_colors') = 'lines'; % any predefined matlab colormap            
            % Update Title and Y label
            mp_support_graph('cl_st_graph_title') = {['f(a), savings state =x, marginal']};
            mp_support_graph('cl_st_ytitle') = {['f(a) marginal mass']};
            mp_support_graph('cl_st_xtitle') = {'savings states, a'};
            % Call function
            ff_graph_grid(mt_cur', ["shock"], ar_a, mp_support_graph);

        elseif (strcmp(st_mt_name, 'fz'))
            
            % Color
            mp_support_graph('cl_colors') = 'gray'; % any predefined matlab colormap            
            % Update Title and Y label
            mp_support_graph('cl_st_graph_title') = {['f(z), shock state =x, stationary']};
            mp_support_graph('cl_st_ytitle') = {['f(z) marginal mass']};
            mp_support_graph('cl_st_xtitle') = {'shock states, z'};
            % Call function
            ff_graph_grid(mt_cur', ["f(z)"], ar_z, mp_support_graph);
                        
        end
    end
    
end

%% Store Results for Output
mp_valpoldist_out = containers.Map(ls_dsout, values(mp_print_graph, ls_dsout));

%% Distributional Statistics
if (~isempty(ls_stout))
    
    % container map subseting
    mp_slout = containers.Map(ls_stout, values(mp_valpol, ls_stout));
    
    mp_cl_ar_xyz_of_s = containers.Map('KeyType','char', 'ValueType','any');
    
    param_map_keys = keys(mp_slout);
    param_map_vals = values(mp_slout);
    for i = 1:length(mp_slout)
        st_mt_name = param_map_keys{i};
        mt_cur = param_map_vals{i};
        
        mp_cl_ar_xyz_of_s(st_mt_name) = {mt_cur(:), zeros(1)};
    end
    
    % Add Names to list
    mp_cl_ar_xyz_of_s('ar_st_y_name') = string(ls_stout);

    % controls
    mp_support = containers.Map('KeyType','char', 'ValueType','any');
    mp_support('ar_fl_percentiles') = [0.01 0.1 1 5 10 20 25 30 40 50 60 70 75 80 90 95 99 99.9 99.99];
    mp_support('bl_display_final') = true;
    mp_support('bl_display_detail') = false;
    mp_support('bl_display_drvm2outcomes') = false;
    mp_support('bl_display_drvstats') = false;
    mp_support('bl_display_drvm2covcor') = false;

    % Call Function
    mp_cl_mt_xyz_of_s = ff_simu_stats(mt_dist_az(:), mp_cl_ar_xyz_of_s, mp_support);
    mp_valpoldist_out('mp_cl_mt_xyz_of_s') = mp_cl_mt_xyz_of_s;
end

end

##### SOURCE END #####
--></body></html>