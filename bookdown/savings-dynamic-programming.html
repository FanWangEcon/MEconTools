<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Savings Dynamic Programming | Matlab Toolbox Heterogeneous Agents Dynamic Programming</title>
  <meta name="description" content="Chapter 1 Savings Dynamic Programming | Matlab Toolbox Heterogeneous Agents Dynamic Programming" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Savings Dynamic Programming | Matlab Toolbox Heterogeneous Agents Dynamic Programming" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 1 Savings Dynamic Programming | Matlab Toolbox Heterogeneous Agents Dynamic Programming" />
  <meta name="github-repo" content="fanwangecon/MEconTools" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Savings Dynamic Programming | Matlab Toolbox Heterogeneous Agents Dynamic Programming" />
  
  <meta name="twitter:description" content="Chapter 1 Savings Dynamic Programming | Matlab Toolbox Heterogeneous Agents Dynamic Programming" />
  

<meta name="author" content="Fan Wang" />


<meta name="date" content="2020-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="summarize-policy-and-value.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92953468-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92953468-6');
</script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Matlab Toolbox Heterogeneous Agents Dynamic Programming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html"><i class="fa fa-check"></i><b>1</b> Savings Dynamic Programming</a><ul>
<li class="chapter" data-level="1.1" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#ff_vfi_az_loop-dynamic-savings-problem-loop-common-grid"><i class="fa fa-check"></i><b>1.1</b> FF_VFI_AZ_LOOP Dynamic Savings Problem Loop Common Grid</a><ul>
<li class="chapter" data-level="1.1.1" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_loop-defaults"><i class="fa fa-check"></i><b>1.1.1</b> Test FF_VFI_AZ_LOOP Defaults</a></li>
<li class="chapter" data-level="1.1.2" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_loop-speed-tests"><i class="fa fa-check"></i><b>1.1.2</b> Test FF_VFI_AZ_LOOP Speed Tests</a></li>
<li class="chapter" data-level="1.1.3" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_loop-control-outputs"><i class="fa fa-check"></i><b>1.1.3</b> Test FF_VFI_AZ_LOOP Control Outputs</a></li>
<li class="chapter" data-level="1.1.4" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_loop-change-interest-rate-and-discount"><i class="fa fa-check"></i><b>1.1.4</b> Test FF_VFI_AZ_LOOP Change Interest Rate and Discount</a></li>
<li class="chapter" data-level="1.1.5" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_loop-changing-risk-aversion"><i class="fa fa-check"></i><b>1.1.5</b> Test FF_VFI_AZ_LOOP Changing Risk Aversion</a></li>
<li class="chapter" data-level="1.1.6" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_loop-with-higher-uncertainty"><i class="fa fa-check"></i><b>1.1.6</b> Test FF_VFI_AZ_LOOP with Higher Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#ff_vfi_az_vec-dynamic-savings-problem-vectorized-common-grid"><i class="fa fa-check"></i><b>1.2</b> FF_VFI_AZ_VEC Dynamic Savings Problem Vectorized Common Grid</a><ul>
<li class="chapter" data-level="1.2.1" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_vec-defaults"><i class="fa fa-check"></i><b>1.2.1</b> Test FF_VFI_AZ_VEC Defaults</a></li>
<li class="chapter" data-level="1.2.2" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-speed-tests"><i class="fa fa-check"></i><b>1.2.2</b> Test FF_VFI_AZ_BISEC_VEC Speed Tests</a></li>
<li class="chapter" data-level="1.2.3" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_vec-control-outputs"><i class="fa fa-check"></i><b>1.2.3</b> Test FF_VFI_AZ_VEC Control Outputs</a></li>
<li class="chapter" data-level="1.2.4" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_vec-change-interest-rate-and-discount"><i class="fa fa-check"></i><b>1.2.4</b> Test FF_VFI_AZ_VEC Change Interest Rate and Discount</a></li>
<li class="chapter" data-level="1.2.5" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_vec-changing-risk-aversion"><i class="fa fa-check"></i><b>1.2.5</b> Test FF_VFI_AZ_VEC Changing Risk Aversion</a></li>
<li class="chapter" data-level="1.2.6" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_vec-with-higher-uncertainty"><i class="fa fa-check"></i><b>1.2.6</b> Test FF_VFI_AZ_VEC with Higher Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#ff_vfi_az_bisec_loop-dynamic-savings-problem-loop-continuous-choice"><i class="fa fa-check"></i><b>1.3</b> FF_VFI_AZ_BISEC_LOOP Dynamic Savings Problem Loop Continuous Choice</a><ul>
<li class="chapter" data-level="1.3.1" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_loop-defaults"><i class="fa fa-check"></i><b>1.3.1</b> Test FF_VFI_AZ_BISEC_LOOP Defaults</a></li>
<li class="chapter" data-level="1.3.2" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_loop-speed-tests"><i class="fa fa-check"></i><b>1.3.2</b> Test FF_VFI_AZ_BISEC_LOOP Speed Tests</a></li>
<li class="chapter" data-level="1.3.3" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_loop-control-outputs"><i class="fa fa-check"></i><b>1.3.3</b> Test FF_VFI_AZ_BISEC_LOOP Control Outputs</a></li>
<li class="chapter" data-level="1.3.4" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_loop-change-interest-rate-and-discount"><i class="fa fa-check"></i><b>1.3.4</b> Test FF_VFI_AZ_BISEC_LOOP Change Interest Rate and Discount</a></li>
<li class="chapter" data-level="1.3.5" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_loop-changing-risk-aversion"><i class="fa fa-check"></i><b>1.3.5</b> Test FF_VFI_AZ_BISEC_LOOP Changing Risk Aversion</a></li>
<li class="chapter" data-level="1.3.6" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_loop-with-higher-uncertainty"><i class="fa fa-check"></i><b>1.3.6</b> Test FF_VFI_AZ_BISEC_LOOP with Higher Uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#ff_vfi_az_bisec_vec-dynamic-savings-problem-vectorized-continuous-exact"><i class="fa fa-check"></i><b>1.4</b> FF_VFI_AZ_BISEC_VEC Dynamic Savings Problem Vectorized Continuous Exact</a><ul>
<li class="chapter" data-level="1.4.1" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-defaults"><i class="fa fa-check"></i><b>1.4.1</b> Test FF_VFI_AZ_BISEC_VEC Defaults</a></li>
<li class="chapter" data-level="1.4.2" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-speed-tests-1"><i class="fa fa-check"></i><b>1.4.2</b> Test FF_VFI_AZ_BISEC_VEC Speed Tests</a></li>
<li class="chapter" data-level="1.4.3" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-control-outputs"><i class="fa fa-check"></i><b>1.4.3</b> Test FF_VFI_AZ_BISEC_VEC Control Outputs</a></li>
<li class="chapter" data-level="1.4.4" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-change-interest-rate-and-discount"><i class="fa fa-check"></i><b>1.4.4</b> Test FF_VFI_AZ_BISEC_VEC Change Interest Rate and Discount</a></li>
<li class="chapter" data-level="1.4.5" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-changing-risk-aversion"><i class="fa fa-check"></i><b>1.4.5</b> Test FF_VFI_AZ_BISEC_VEC Changing Risk Aversion</a></li>
<li class="chapter" data-level="1.4.6" data-path="savings-dynamic-programming.html"><a href="savings-dynamic-programming.html#test-ff_vfi_az_bisec_vec-with-higher-uncertainty"><i class="fa fa-check"></i><b>1.4.6</b> Test FF_VFI_AZ_BISEC_VEC with Higher Uncertainty</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarize-policy-and-value.html"><a href="summarize-policy-and-value.html"><i class="fa fa-check"></i><b>2</b> Summarize Policy and Value</a><ul>
<li class="chapter" data-level="2.1" data-path="summarize-policy-and-value.html"><a href="summarize-policy-and-value.html#ff_summ_nd_array-examples"><i class="fa fa-check"></i><b>2.1</b> FF_SUMM_ND_ARRAY Examples</a><ul>
<li class="chapter" data-level="2.1.1" data-path="summarize-policy-and-value.html"><a href="summarize-policy-and-value.html#test-ff_summ_nd_array-defaults"><i class="fa fa-check"></i><b>2.1.1</b> Test FF_SUMM_ND_ARRAY Defaults</a></li>
<li class="chapter" data-level="2.1.2" data-path="summarize-policy-and-value.html"><a href="summarize-policy-and-value.html#test-ff_summ_nd_array-with-random-2-dimensional-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Test FF_SUMM_ND_ARRAY with Random 2 Dimensional Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="summarize-policy-and-value.html"><a href="summarize-policy-and-value.html#test-ff_summ_nd_array-with-random-6-dimensional-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Test FF_SUMM_ND_ARRAY with Random 6 Dimensional Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="summarize-policy-and-value.html"><a href="summarize-policy-and-value.html#test-ff_summ_nd_array-with-random-7-dimensional-matrix-with-all-parameters"><i class="fa fa-check"></i><b>2.1.4</b> Test FF_SUMM_ND_ARRAY with Random 7 Dimensional Matrix with All Parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="distributional-analysis.html"><a href="distributional-analysis.html"><i class="fa fa-check"></i><b>3</b> Distributional Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="distributional-analysis.html"><a href="distributional-analysis.html#ff_simu_stats-examples"><i class="fa fa-check"></i><b>3.1</b> FF_SIMU_STATS Examples</a><ul>
<li class="chapter" data-level="3.1.1" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_simu_stats-defaults"><i class="fa fa-check"></i><b>3.1.1</b> Test FF_SIMU_STATS Defaults</a></li>
<li class="chapter" data-level="3.1.2" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_simu_stats-four-states-points-matrix"><i class="fa fa-check"></i><b>3.1.2</b> Test FF_SIMU_STATS Four States-Points Matrix</a></li>
<li class="chapter" data-level="3.1.3" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_simu_stats-four-states-points-matrix-single-column-inputs"><i class="fa fa-check"></i><b>3.1.3</b> Test FF_SIMU_STATS Four States-Points Matrix Single Column Inputs</a></li>
<li class="chapter" data-level="3.1.4" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_simu_stats-print-many-details"><i class="fa fa-check"></i><b>3.1.4</b> Test FF_SIMU_STATS Print Many Details</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="distributional-analysis.html"><a href="distributional-analysis.html#ff_disc_rand_var_stats-examples"><i class="fa fa-check"></i><b>3.2</b> FF_DISC_RAND_VAR_STATS Examples</a><ul>
<li class="chapter" data-level="3.2.1" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_stats-defaults"><i class="fa fa-check"></i><b>3.2.1</b> Test FF_DISC_RAND_VAR_STATS Defaults</a></li>
<li class="chapter" data-level="3.2.2" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_stats-0-and-1-random-variable"><i class="fa fa-check"></i><b>3.2.2</b> Test FF_DISC_RAND_VAR_STATS 0 and 1 Random Variable</a></li>
<li class="chapter" data-level="3.2.3" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_stats-with-poisson"><i class="fa fa-check"></i><b>3.2.3</b> Test FF_DISC_RAND_VAR_STATS with Poisson</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="distributional-analysis.html"><a href="distributional-analysis.html#ff_disc_rand_var_mass2outcomes-examples"><i class="fa fa-check"></i><b>3.3</b> FF_DISC_RAND_VAR_MASS2OUTCOMES Examples</a><ul>
<li class="chapter" data-level="3.3.1" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2outcomes-defaults"><i class="fa fa-check"></i><b>3.3.1</b> Test FF_DISC_RAND_VAR_MASS2OUTCOMES Defaults</a></li>
<li class="chapter" data-level="3.3.2" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2outcomes-four-states-points"><i class="fa fa-check"></i><b>3.3.2</b> Test FF_DISC_RAND_VAR_MASS2OUTCOMES Four States-Points</a></li>
<li class="chapter" data-level="3.3.3" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2outcomes-conditional-mass-outputs"><i class="fa fa-check"></i><b>3.3.3</b> Test FF_DISC_RAND_VAR_MASS2OUTCOMES Conditional Mass Outputs</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="distributional-analysis.html"><a href="distributional-analysis.html#ff_disc_rand_var_mass2covcor-examples"><i class="fa fa-check"></i><b>3.4</b> FF_DISC_RAND_VAR_MASS2COVCOR Examples</a><ul>
<li class="chapter" data-level="3.4.1" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2covcor-defaults"><i class="fa fa-check"></i><b>3.4.1</b> Test FF_DISC_RAND_VAR_MASS2COVCOR Defaults</a></li>
<li class="chapter" data-level="3.4.2" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2covcor-four-states-points"><i class="fa fa-check"></i><b>3.4.2</b> Test FF_DISC_RAND_VAR_MASS2COVCOR Four States-Points</a></li>
<li class="chapter" data-level="3.4.3" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2covcor-two-random-vectors"><i class="fa fa-check"></i><b>3.4.3</b> Test FF_DISC_RAND_VAR_MASS2COVCOR Two Random Vectors</a></li>
<li class="chapter" data-level="3.4.4" data-path="distributional-analysis.html"><a href="distributional-analysis.html#test-ff_disc_rand_var_mass2covcor-provide-mean-and-sd"><i class="fa fa-check"></i><b>3.4.4</b> Test FF_DISC_RAND_VAR_MASS2COVCOR Provide Mean and SD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>4</b> Graphs</a><ul>
<li class="chapter" data-level="4.1" data-path="graphs.html"><a href="graphs.html#ff_graph_grid-examples-x-y-and-color-line-plots"><i class="fa fa-check"></i><b>4.1</b> FF_GRAPH_GRID Examples: X, Y and Color Line Plots</a><ul>
<li class="chapter" data-level="4.1.1" data-path="graphs.html"><a href="graphs.html#test-ff_graph_grid-defaults"><i class="fa fa-check"></i><b>4.1.1</b> Test FF_GRAPH_GRID Defaults</a></li>
<li class="chapter" data-level="4.1.2" data-path="graphs.html"><a href="graphs.html#test-ff_graph_grid-random-matrix-pick-markers-and-colors"><i class="fa fa-check"></i><b>4.1.2</b> Test FF_GRAPH_GRID Random Matrix Pick Markers and Colors</a></li>
<li class="chapter" data-level="4.1.3" data-path="graphs.html"><a href="graphs.html#test-ff_graph_grid-two-random-normal-lines-and-labels"><i class="fa fa-check"></i><b>4.1.3</b> Test FF_GRAPH_GRID Two Random Normal Lines and Labels</a></li>
<li class="chapter" data-level="4.1.4" data-path="graphs.html"><a href="graphs.html#test-ff_graph_grid-6-lines-pick-marker-and-colors"><i class="fa fa-check"></i><b>4.1.4</b> Test FF_GRAPH_GRID 6 Lines Pick Marker and Colors</a></li>
<li class="chapter" data-level="4.1.5" data-path="graphs.html"><a href="graphs.html#test-ff_graph_grid-many-lines"><i class="fa fa-check"></i><b>4.1.5</b> Test FF_GRAPH_GRID Many Lines</a></li>
<li class="chapter" data-level="4.1.6" data-path="graphs.html"><a href="graphs.html#test-ff_graph_grid-many-lines-legend-exogenous"><i class="fa fa-check"></i><b>4.1.6</b> Test FF_GRAPH_GRID Many Lines Legend Exogenous</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>5</b> Data Structures</a><ul>
<li class="chapter" data-level="5.1" data-path="data-structures.html"><a href="data-structures.html#ff_saveborr_grid-example-for-generating-asset-grid"><i class="fa fa-check"></i><b>5.1</b> FF_SAVEBORR_GRID Example for Generating Asset Grid</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-structures.html"><a href="data-structures.html#test-ff_saveborr_grid-defaults"><i class="fa fa-check"></i><b>5.1.1</b> Test FF_SAVEBORR_GRID Defaults</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-structures.html"><a href="data-structures.html#test-ff_saveborr_grid-default-linear-grid-log-grid-power-grid-threshold-grid"><i class="fa fa-check"></i><b>5.1.2</b> Test FF_SAVEBORR_GRID Default Linear Grid, Log Grid, Power Grid, Threshold Grid</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-structures.html"><a href="data-structures.html#test-ff_saveborr_grid-log-grid-changing-parameters"><i class="fa fa-check"></i><b>5.1.3</b> Test FF_SAVEBORR_GRID Log Grid Changing Parameters</a></li>
<li class="chapter" data-level="5.1.4" data-path="data-structures.html"><a href="data-structures.html#test-ff_saveborr_grid-power-grid-changing-parameters"><i class="fa fa-check"></i><b>5.1.4</b> Test FF_SAVEBORR_GRID Power Grid Changing Parameters</a></li>
<li class="chapter" data-level="5.1.5" data-path="data-structures.html"><a href="data-structures.html#test-ff_saveborr_grid-threshold-grid-changing-parameters"><i class="fa fa-check"></i><b>5.1.5</b> Test FF_SAVEBORR_GRID Threshold Grid Changing Parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="common-functions.html"><a href="common-functions.html"><i class="fa fa-check"></i><b>6</b> Common Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="common-functions.html"><a href="common-functions.html#ffy_tauchen-ar1-shock-discretization-example"><i class="fa fa-check"></i><b>6.1</b> FFY_TAUCHEN AR1 Shock Discretization Example</a><ul>
<li class="chapter" data-level="6.1.1" data-path="common-functions.html"><a href="common-functions.html#test-ffy_tauchen-defaults"><i class="fa fa-check"></i><b>6.1.1</b> Test FFY_TAUCHEN Defaults</a></li>
<li class="chapter" data-level="6.1.2" data-path="common-functions.html"><a href="common-functions.html#test-ffy_tauchen-specify-parameters"><i class="fa fa-check"></i><b>6.1.2</b> Test FFY_TAUCHEN Specify Parameters</a></li>
<li class="chapter" data-level="6.1.3" data-path="common-functions.html"><a href="common-functions.html#test-ffy_tauchen-high-persistence-low-sd"><i class="fa fa-check"></i><b>6.1.3</b> Test FFY_TAUCHEN High Persistence, Low SD</a></li>
<li class="chapter" data-level="6.1.4" data-path="common-functions.html"><a href="common-functions.html#test-ffy_tauchen-low-persistence-low-sd"><i class="fa fa-check"></i><b>6.1.4</b> Test FFY_TAUCHEN Low Persistence, Low SD</a></li>
<li class="chapter" data-level="6.1.5" data-path="common-functions.html"><a href="common-functions.html#test-ffy_tauchen-high-persistence-high-sd"><i class="fa fa-check"></i><b>6.1.5</b> Test FFY_TAUCHEN High Persistence, High SD</a></li>
<li class="chapter" data-level="6.1.6" data-path="common-functions.html"><a href="common-functions.html#test-ffy_tauchen-low-persistence-low-sd-1"><i class="fa fa-check"></i><b>6.1.6</b> Test FFY_TAUCHEN Low Persistence, Low SD</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="common-functions.html"><a href="common-functions.html#ffy_rouwenhorst-ar1-shock-discretization-example"><i class="fa fa-check"></i><b>6.2</b> FFY_ROUWENHORST AR1 Shock Discretization Example</a><ul>
<li class="chapter" data-level="6.2.1" data-path="common-functions.html"><a href="common-functions.html#test-ffy_rouwenhorst-defaults"><i class="fa fa-check"></i><b>6.2.1</b> Test FFY_ROUWENHORST Defaults</a></li>
<li class="chapter" data-level="6.2.2" data-path="common-functions.html"><a href="common-functions.html#test-ffy_rouwenhorst-specify-parameters"><i class="fa fa-check"></i><b>6.2.2</b> Test FFY_ROUWENHORST Specify Parameters</a></li>
<li class="chapter" data-level="6.2.3" data-path="common-functions.html"><a href="common-functions.html#test-ffy_rouwenhorst-high-persistence-low-sd"><i class="fa fa-check"></i><b>6.2.3</b> Test FFY_ROUWENHORST High Persistence, Low SD</a></li>
<li class="chapter" data-level="6.2.4" data-path="common-functions.html"><a href="common-functions.html#test-ffy_rouwenhorst-low-persistence-low-sd"><i class="fa fa-check"></i><b>6.2.4</b> Test FFY_ROUWENHORST Low Persistence, Low SD</a></li>
<li class="chapter" data-level="6.2.5" data-path="common-functions.html"><a href="common-functions.html#test-ffy_rouwenhorst-high-persistence-high-sd"><i class="fa fa-check"></i><b>6.2.5</b> Test FFY_ROUWENHORST High Persistence, High SD</a></li>
<li class="chapter" data-level="6.2.6" data-path="common-functions.html"><a href="common-functions.html#test-ffy_rouwenhorst-low-persistence-low-sd-1"><i class="fa fa-check"></i><b>6.2.6</b> Test FFY_ROUWENHORST Low Persistence, Low SD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="support-tools.html"><a href="support-tools.html"><i class="fa fa-check"></i><b>7</b> Support Tools</a><ul>
<li class="chapter" data-level="7.1" data-path="support-tools.html"><a href="support-tools.html#ff_container_map_display-examples"><i class="fa fa-check"></i><b>7.1</b> FF_CONTAINER_MAP_DISPLAY Examples</a><ul>
<li class="chapter" data-level="7.1.1" data-path="support-tools.html"><a href="support-tools.html#test-ff_container_map_display-defaults"><i class="fa fa-check"></i><b>7.1.1</b> Test FF_CONTAINER_MAP_DISPLAY Defaults</a></li>
<li class="chapter" data-level="7.1.2" data-path="support-tools.html"><a href="support-tools.html#test-ff_container_map_display-summarize-matrix-only"><i class="fa fa-check"></i><b>7.1.2</b> Test FF_CONTAINER_MAP_DISPLAY summarize Matrix Only</a></li>
<li class="chapter" data-level="7.1.3" data-path="support-tools.html"><a href="support-tools.html#test-ff_container_map_display-show-matrix-subset"><i class="fa fa-check"></i><b>7.1.3</b> Test FF_CONTAINER_MAP_DISPLAY Show Matrix Subset</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="index-and-code-links.html"><a href="index-and-code-links.html"><i class="fa fa-check"></i><b>A</b> Index and Code Links</a><ul>
<li class="chapter" data-level="A.1" data-path="index-and-code-links.html"><a href="index-and-code-links.html#savings-dynamic-programming-links"><i class="fa fa-check"></i><b>A.1</b> Savings Dynamic Programming links</a></li>
<li class="chapter" data-level="A.2" data-path="index-and-code-links.html"><a href="index-and-code-links.html#summarize-policy-and-value-links"><i class="fa fa-check"></i><b>A.2</b> Summarize Policy and Value links</a></li>
<li class="chapter" data-level="A.3" data-path="index-and-code-links.html"><a href="index-and-code-links.html#distributional-analysis-links"><i class="fa fa-check"></i><b>A.3</b> Distributional Analysis links</a></li>
<li class="chapter" data-level="A.4" data-path="index-and-code-links.html"><a href="index-and-code-links.html#graphs-links"><i class="fa fa-check"></i><b>A.4</b> Graphs links</a></li>
<li class="chapter" data-level="A.5" data-path="index-and-code-links.html"><a href="index-and-code-links.html#data-structures-links"><i class="fa fa-check"></i><b>A.5</b> Data Structures links</a></li>
<li class="chapter" data-level="A.6" data-path="index-and-code-links.html"><a href="index-and-code-links.html#common-functions-links"><i class="fa fa-check"></i><b>A.6</b> Common Functions links</a></li>
<li class="chapter" data-level="A.7" data-path="index-and-code-links.html"><a href="index-and-code-links.html#support-tools-links"><i class="fa fa-check"></i><b>A.7</b> Support Tools links</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://fanwangecon.github.io/M4Econ/bookdown/index.html" target="blank">M4Econ Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Matlab Toolbox Heterogeneous Agents Dynamic Programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="savings-dynamic-programming" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Savings Dynamic Programming</h1>

<div id="ff_vfi_az_loop-dynamic-savings-problem-loop-common-grid" class="section level2">
<h2><span class="header-section-number">1.1</span> FF_VFI_AZ_LOOP Dynamic Savings Problem Loop Common Grid</h2>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Toolbox (<a href="https://fanwangecon.github.io/MEconTools/bookdown">bookdown</a>), <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown</a>).</p>
</blockquote>
<p>This is the example vignette for function:
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_loop.m"><strong>ff_vfi_az_loop</strong></a>
from the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> This function
solves the dynamic programming problem for a (a,z) model. Households can
save a, and face AR(1) shock z. The problem is solved over the infinite
horizon. This is the looped code, it is slow for larger state-space
problems. The code uses common grid, with the same state space and
choice space grids.</p>
<p><strong>Links to Four Code:</strong></p>
<p>Four Core Savings/Borrowing Dynamic Programming Solution Functions that
are functions in the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> :</p>
<ul>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_loop.m"><strong>ff_vfi_az_loop</strong></a>,
slow should use for testing new models</p></li>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_vec.m"><strong>ff_vfi_az_vec</strong></a>,
fast good for many purposes</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_loop.m"><strong>ff_vfi_az_bisec_loop</strong></a>,
high precision even with small grid</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_vec.m"><strong>ff_vfi_az_bisec_vec</strong></a>,
precision and speed</p></li>
</ul>
<p>The four sample codes are written for the standard dynamic savings
problem with AR(1) shock that is one of the core problems introduced in
first sessions of graduate Economics courses. The code can be easily
adapted to accomand multiple assets, savings and borrowing, discrete and
continuous choice, etc. A large proportion of dynamic economic models
are based on the underlying structure of solving a model with endogenous
states and exogenous shocks, and that is what the (a,z) model does. In
general, one should write looped code first to make sure the economics
is correct, then vectorized code can be adopted to increase speed.</p>
<div id="test-ff_vfi_az_loop-defaults" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Test FF_VFI_AZ_LOOP Defaults</h3>
<p>Call the function with defaults. By default, shows the asset policy
function summary. Model parameters can be changed by the mp_params.</p>
<pre><code>%mp_params
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;fl_crra&#39;) = 1.5;
mp_params(&#39;fl_beta&#39;) = 0.94;
% call function
ff_vfi_az_loop(mp_params);

Elapsed time is 1.291175 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          i    idx    ndim    numel    rowN    colN     sum      mean      std     coefvari    min    max
          _    ___    ____    _____    ____    ____    _____    ______    _____    ________    ___    ___

    ap    1     1      2       700     100      7      16864    24.091    14.08    0.58446      0     50 

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7  
            _______    _______    _______    _______    _______    _______    ______

    r1            0          0          0          0          0    0.50505    2.0202
    r2            0          0          0    0.50505    0.50505     1.0101    2.5253
    r3      0.50505    0.50505    0.50505    0.50505     1.0101     1.5152    3.0303
    r4       1.0101     1.0101     1.0101     1.0101     1.5152     2.0202    3.5354
    r5       1.5152     1.5152     1.5152     1.5152     2.0202     2.5253    4.0404
    r96      45.455     45.455      45.96      45.96      45.96      46.97    48.485
    r97       45.96      45.96      45.96     46.465     46.465     47.475     48.99
    r98      46.465     46.465     46.465      46.97      46.97      47.98     48.99
    r99       46.97      46.97      46.97     47.475     47.475     48.485    49.495
    r100     47.475     47.475     47.475      47.98      47.98      48.99        50</code></pre>
</div>
<div id="test-ff_vfi_az_loop-speed-tests" class="section level3">
<h3><span class="header-section-number">1.1.2</span> Test FF_VFI_AZ_LOOP Speed Tests</h3>
<p>Call the function with different a and z grid size, print out speed:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = true;
mp_support(&#39;ls_ffcmd&#39;) = {};</code></pre>
<p>A grid 50, shock grid 5:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.223217 seconds.</code></pre>
<p>A grid 100, shock grid 7:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 7;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 1.284511 seconds.</code></pre>
<p>A grid 200, shock grid 9:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 200;
mp_params(&#39;it_z_n&#39;) = 9;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 6.325330 seconds.</code></pre>
</div>
<div id="test-ff_vfi_az_loop-control-outputs" class="section level3">
<h3><span class="header-section-number">1.1.3</span> Test FF_VFI_AZ_LOOP Control Outputs</h3>
<p>Run the function first without any outputs;</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = false;
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;</code></pre>
<p>Run the function and show policy function for savings choice. For
ls_ffcmd, ls_ffsna, ls_ffgrh, can include these: ‘v’, ‘ap’, ‘c’, ‘y’,
‘coh’, ‘savefraccoh’. These are value, aprime savings choice,
consumption, income, cash on hand, and savings fraction as cash-on-hand.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
% ls_ffcmd: summary print which outcomes
mp_support(&#39;ls_ffcmd&#39;) = {};
% ls_ffsna: detail print which outcomes
mp_support(&#39;ls_ffsna&#39;) = {&#39;ap&#39;};
% ls_ffgrh: graphical print which outcomes
mp_support(&#39;ls_ffgrh&#39;) = {&#39;ap&#39;};
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.313830 seconds.
xxx  ff_vfi_az_vec, outcome=ap  xxxxxxxxxxxxxxxxxxxxxxxxxxx
    group      a       mean_z_0_54195    mean_z_0_66401    mean_z_0_88162    mean_z_1_3095    mean_z_2_2745
    _____    ______    ______________    ______________    ______________    _____________    _____________

      1           0             0                 0                 0                0           1.0204    
      2      1.0204             0                 0            1.0204           1.0204           2.0408    
      3      2.0408        1.0204            1.0204            2.0408           2.0408           3.0612    
      4      3.0612        2.0408            2.0408            2.0408           3.0612           4.0816    
      5      4.0816        3.0612            3.0612            3.0612           4.0816            5.102    
      6       5.102        4.0816            4.0816            4.0816            5.102           6.1224    
      7      6.1224         5.102             5.102             5.102           6.1224           7.1429    
      8      7.1429        6.1224            6.1224            6.1224           7.1429           8.1633    
      9      8.1633        7.1429            7.1429            7.1429           8.1633           9.1837    
     10      9.1837        8.1633            8.1633            8.1633           9.1837           10.204    
     11      10.204        9.1837            9.1837            9.1837           10.204           11.224    
     12      11.224        10.204            10.204            10.204           11.224           12.245    
     13      12.245        11.224            11.224            11.224           12.245           13.265    
     14      13.265        12.245            12.245            12.245           12.245           14.286    
     15      14.286        13.265            13.265            13.265           13.265           15.306    
     16      15.306        14.286            14.286            14.286           14.286           15.306    
     17      16.327        15.306            15.306            15.306           15.306           16.327    
     18      17.347        16.327            16.327            16.327           16.327           17.347    
     19      18.367        17.347            17.347            17.347           17.347           18.367    
     20      19.388        18.367            18.367            18.367           18.367           19.388    
     21      20.408        19.388            19.388            19.388           19.388           20.408    
     22      21.429        19.388            20.408            20.408           20.408           21.429    
     23      22.449        20.408            21.429            21.429           21.429           22.449    
     24      23.469        21.429            22.449            22.449           22.449           23.469    
     25       24.49        22.449            22.449            23.469           23.469            24.49    
     26       25.51        23.469            23.469             24.49            24.49            25.51    
     27      26.531         24.49             24.49             25.51            25.51           26.531    
     28      27.551         25.51             25.51            26.531           26.531           27.551    
     29      28.571        26.531            26.531            27.551           27.551           28.571    
     30      29.592        27.551            27.551            28.571           28.571           29.592    
     31      30.612        28.571            28.571            28.571           29.592           30.612    
     32      31.633        29.592            29.592            29.592           30.612           31.633    
     33      32.653        30.612            30.612            30.612           31.633           32.653    
     34      33.673        31.633            31.633            31.633           32.653           33.673    
     35      34.694        32.653            32.653            32.653           33.673           34.694    
     36      35.714        33.673            33.673            33.673           34.694           35.714    
     37      36.735        34.694            34.694            34.694           35.714           36.735    
     38      37.755        35.714            35.714            35.714           36.735           37.755    
     39      38.776        36.735            36.735            36.735           37.755           38.776    
     40      39.796        37.755            37.755            37.755           38.776           39.796    
     41      40.816        38.776            38.776            38.776           39.796           40.816    
     42      41.837        39.796            39.796            39.796           40.816           41.837    
     43      42.857        40.816            40.816            40.816           41.837           42.857    
     44      43.878        41.837            41.837            41.837           41.837           42.857    
     45      44.898        42.857            42.857            42.857           42.857           43.878    
     46      45.918        43.878            43.878            43.878           43.878           44.898    
     47      46.939        44.898            44.898            44.898           44.898           45.918    
     48      47.959        45.918            45.918            45.918           45.918           46.939    
     49       48.98        46.939            46.939            46.939           46.939           47.959    
     50          50        47.959            47.959            47.959           47.959            48.98    </code></pre>
<p><img src="img/fx_vfi_az_loop_images/figure_0.png" width="500" /></p>
<p><img src="img/fx_vfi_az_loop_images/figure_1.png" width="500" /></p>
<p>Run the function and show summaries for savings and fraction of coh
saved:</p>
<pre><code>mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 9;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;ap&#39;, &#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_support(&#39;bl_vfi_store_all&#39;) = true; % store c(a,z), y(a,z)
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 1.867278 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    ap             1     1      2       900     100      9       21825      24.25     14.089      0.581      0          50
    savefraccoh    2     2      2       900     100      9      752.38    0.83597    0.13497    0.16145      0     0.91812

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8        c9  
            _______    _______    _______    _______    _______    _______    _______    ______    ______

    r1            0          0          0          0          0          0    0.50505    1.5152    3.0303
    r2            0          0          0          0    0.50505    0.50505     1.0101    1.5152    3.5354
    r3      0.50505    0.50505    0.50505    0.50505    0.50505     1.0101     1.5152    2.0202    4.0404
    r4       1.0101     1.0101     1.0101     1.0101     1.0101     1.5152     2.0202    2.5253    4.5455
    r5       1.5152     1.5152     1.5152     1.5152     1.5152     2.0202     2.5253    3.0303    5.0505
    r96      45.455     45.455     45.455      45.96      45.96      45.96     46.465    47.475    49.495
    r97       45.96      45.96      45.96     46.465     46.465     46.465      46.97     47.98    49.495
    r98      46.465     46.465     46.465     46.465      46.97      46.97     47.475    48.485        50
    r99       46.97      46.97      46.97      46.97     47.475     47.475      47.98     48.99        50
    r100     47.475     47.475     47.475     47.475      47.98      47.98     48.485    49.495        50

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8         c9   
            _______    _______    _______    _______    _______    _______    _______    _______    _______

    r1            0          0          0          0          0          0    0.24587    0.48182    0.56208
    r2            0          0          0          0     0.3075    0.25444    0.39276    0.41371    0.59831
    r3      0.30679    0.29486    0.27938    0.25939     0.2338    0.40362    0.49043     0.4833     0.6287
    r4       0.4668    0.45285    0.43438    0.40981    0.37721    0.50166    0.56006    0.53755    0.65456
    r5      0.56502    0.55132    0.53293    0.50802    0.47415    0.57101    0.61221    0.58103    0.67683
    r96     0.91292     0.9117    0.90997    0.91752    0.91364    0.90746    0.90692    0.90732    0.90699
    r97     0.91357    0.91236    0.91064    0.91812    0.91427    0.90815    0.90761    0.90799    0.89847
    r98      0.9142      0.913     0.9113    0.90882    0.91489    0.90882    0.90828    0.90865    0.89919
    r99     0.91482    0.91363    0.91195    0.90949    0.91549    0.90949    0.90894    0.90929    0.89089
    r100    0.91543    0.91425    0.91258    0.91014    0.91609    0.91013    0.90959    0.90992    0.88275</code></pre>
</div>
<div id="test-ff_vfi_az_loop-change-interest-rate-and-discount" class="section level3">
<h3><span class="header-section-number">1.1.4</span> Test FF_VFI_AZ_LOOP Change Interest Rate and Discount</h3>
<p>Show only save fraction of cash on hand:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with several different interest rates and discount
factor:</p>
<pre><code>% Lower Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.80;
mp_params(&#39;fl_r&#39;) = 0.01;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.113265 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean       std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    ______    ________    ___    _______

    savefraccoh    1     1      2       250      50      5      118.68    0.47472    0.2843    0.59887      0     0.80805

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
             c1         c2         c3         c4         c5   
           _______    _______    _______    _______    _______

    r1           0          0          0          0    0.10642
    r2           0          0          0          0     0.1064
    r3           0          0          0          0    0.10629
    r4           0          0          0          0      0.106
    r5           0          0          0          0    0.10543
    r46    0.79096    0.78787    0.78241    0.77191    0.74922
    r47    0.79553    0.79262    0.78747    0.77755    0.75606
    r48     0.7999    0.79715    0.79229     0.7829    0.76254
    r49    0.80407    0.80147    0.79687    0.78799    0.76868
    r50    0.80805    0.80559    0.80125    0.79284     0.7745

% Higher Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.95;
mp_params(&#39;fl_r&#39;) = 0.04;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.327279 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       250      50      5      160.99    0.64394    0.29947    0.46506      0     0.94888

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
             c1         c2          c3         c4         c5   
           _______    _______    ________    _______    _______

    r1           0          0    0.024103    0.18484    0.40057
    r2           0          0    0.024094     0.1848    0.40051
    r3           0          0    0.024028    0.18446    0.40008
    r4           0          0    0.046583    0.18354    0.39894
    r5           0          0    0.045925    0.24935    0.39672
    r46    0.94526    0.94167     0.93533    0.92312    0.89672
    r47    0.94628    0.94291     0.93696    0.92548    0.90059
    r48    0.94722    0.94405     0.93846    0.92766    0.90418
    r49    0.94808    0.94511     0.93984    0.92966    0.90749
    r50    0.94888    0.94608     0.94111    0.93151    0.91056</code></pre>
</div>
<div id="test-ff_vfi_az_loop-changing-risk-aversion" class="section level3">
<h3><span class="header-section-number">1.1.5</span> Test FF_VFI_AZ_LOOP Changing Risk Aversion</h3>
<p>Here, again, show fraction of coh saved in summary tabular form, but
also show it graphically.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {&#39;savefraccoh&#39;};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 5;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with different risk aversion levels, higher preferences
for risk:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_crra&#39;) = 0.5;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.581794 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      268.82    0.53764    0.29852    0.55524      0     0.86141

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3          c4         c5   
            _______    _______    _______    ________    _______

    r1            0          0          0    0.015741    0.18847
    r2            0          0          0     0.01574    0.18847
    r3            0          0          0    0.015737    0.18844
    r4            0          0          0    0.015728    0.18838
    r5            0          0          0    0.022367    0.18825
    r96     0.84455    0.84169    0.83664     0.85445    0.83255
    r97     0.84611    0.84333    0.83842     0.85626    0.83496
    r98     0.84763    0.84493    0.84016     0.85803    0.83729
    r99     0.84911    0.84648    0.84185     0.85974    0.83956
    r100    0.85055      0.848    0.84349     0.86141    0.84176</code></pre>
<p><img src="img/fx_vfi_az_loop_images/figure_2.png" width="500" /></p>
<p><img src="img/fx_vfi_az_loop_images/figure_3.png" width="500" /></p>
<p>When risk aversion increases, at every state-space point, the household
wants to save more.</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_crra&#39;) = 5;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.937495 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min     max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    ______

    savefraccoh    1     1      2       500     100      5      335.64    0.67129    0.28688    0.42735      0     0.9488

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2          c3         c4         c5   
            _______    _______    ________    _______    _______

    r1            0          0    0.078907    0.28472    0.52731
    r2            0          0    0.078904    0.28471     0.5273
    r3            0          0    0.078878    0.28465    0.52723
    r4            0          0    0.078808    0.28448    0.52705
    r5            0          0    0.078672    0.28415    0.52669
    r96     0.93086    0.92771     0.92215    0.94079    0.94593
    r97     0.93161    0.92855     0.92315    0.94183    0.94739
    r98     0.93233    0.92936     0.92411    0.94283     0.9488
    r99     0.93303    0.93015     0.92505    0.94379    0.92164
    r100    0.93371    0.93091     0.92595    0.94471    0.92317</code></pre>
<p><img src="img/fx_vfi_az_loop_images/figure_4.png" width="500" /></p>
<p><img src="img/fx_vfi_az_loop_images/figure_5.png" width="500" /></p>
</div>
<div id="test-ff_vfi_az_loop-with-higher-uncertainty" class="section level3">
<h3><span class="header-section-number">1.1.6</span> Test FF_VFI_AZ_LOOP with Higher Uncertainty</h3>
<p>Increase the standard deviation of the Shock.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 5;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Lower standard deviation of shock:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.10;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.957457 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum      mean       std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    _____    ______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      294.1    0.5882    0.32083    0.54544      0     0.92392

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3          c4         c5   
            _______    _______    _______    ________    _______

    r1            0          0          0    0.034556    0.11424
    r2            0          0          0    0.034555    0.11424
    r3            0          0          0    0.034546    0.11422
    r4            0          0          0    0.034523    0.11416
    r5            0          0          0    0.034478    0.11404
    r96     0.89673    0.89421    0.91986     0.91499    0.90808
    r97     0.89789    0.89545    0.92093      0.9162    0.90948
    r98     0.89903    0.89665    0.92196     0.91737    0.91084
    r99     0.90013    0.89782    0.92295      0.9185    0.91215
    r100    0.90119    0.89896    0.92392     0.91959    0.91342</code></pre>
<p>Higher shock standard deviation: low shock high asset save more, high
shock more asset save less, high shock low asset save more:</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.40;
ff_vfi_az_loop(mp_params, mp_support);

Elapsed time is 0.923630 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      350.37    0.70073    0.26741    0.38162      0     0.93257

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2          c3         c4         c5   
            _______    _______    ________    _______    _______

    r1            0          0    0.030722    0.36969    0.77072
    r2            0          0     0.03072    0.36967    0.77071
    r3            0          0      0.0307    0.36958    0.77068
    r4            0          0    0.030646    0.36933     0.7706
    r5            0          0    0.030543    0.36885    0.77044
    r96     0.90975    0.90819      0.9038    0.91513    0.88687
    r97     0.91053    0.90902     0.90476    0.91633    0.89076
    r98     0.91129    0.90982     0.90569     0.9175    0.86794
    r99     0.91204    0.91061      0.9066    0.91862    0.84583
    r100    0.91276    0.91138     0.90748    0.91971    0.82439</code></pre>

</div>
</div>
<div id="ff_vfi_az_vec-dynamic-savings-problem-vectorized-common-grid" class="section level2">
<h2><span class="header-section-number">1.2</span> FF_VFI_AZ_VEC Dynamic Savings Problem Vectorized Common Grid</h2>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Toolbox (<a href="https://fanwangecon.github.io/MEconTools/bookdown">bookdown</a>), <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown</a>).</p>
</blockquote>
<p>This is the example vignette for function:
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_vec.m"><strong>ff_vfi_az_vec</strong></a>
from the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> This function
solves (vectorized) the dynamic programming problem for a (a,z) model.
Households can save a, and face AR(1) shock z. The problem is solved
over the infinite horizon.</p>
<p>The code uses common grid, with the same state space and choice space
grids.
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_vec.m"><strong>ff_vfi_az_bisec_vec</strong></a>
from the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a> solves the same
problem but using continuous exact percentage asset choices, which is
more precise than the solution here, and perhaps a little bit slower.</p>
<p>This is the vectorized code, its speed is much faster than the looped
code. The function is designed to have small memory footprint and
requires low computing resources, yet is fast.</p>
<p><strong>Links to Four Code:</strong></p>
<p>Four Core Savings/Borrowing Dynamic Programming Solution Functions that
are functions in the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> :</p>
<ul>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_loop.m"><strong>ff_vfi_az_loop</strong></a>,
slow should use for testing new models</p></li>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_vec.m"><strong>ff_vfi_az_vec</strong></a>,
fast good for many purposes</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_loop.m"><strong>ff_vfi_az_bisec_loop</strong></a>,
high precision even with small grid</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_vec.m"><strong>ff_vfi_az_bisec_vec</strong></a>,
precision and speed</p></li>
</ul>
<div id="test-ff_vfi_az_vec-defaults" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Test FF_VFI_AZ_VEC Defaults</h3>
<p>Call the function with defaults. By default, shows the asset policy
function summary. Model parameters can be changed by the mp_params.</p>
<pre><code>%mp_params
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;fl_crra&#39;) = 1.5;
mp_params(&#39;fl_beta&#39;) = 0.94;
ff_vfi_az_vec(mp_params);

Elapsed time is 0.128918 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          i    idx    ndim    numel    rowN    colN     sum      mean      std     coefvari    min    max
          _    ___    ____    _____    ____    ____    _____    ______    _____    ________    ___    ___

    ap    1     1      2       700     100      7      16864    24.091    14.08    0.58446      0     50 

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7  
            _______    _______    _______    _______    _______    _______    ______

    r1            0          0          0          0          0    0.50505    2.0202
    r2            0          0          0    0.50505    0.50505     1.0101    2.5253
    r3      0.50505    0.50505    0.50505    0.50505     1.0101     1.5152    3.0303
    r4       1.0101     1.0101     1.0101     1.0101     1.5152     2.0202    3.5354
    r5       1.5152     1.5152     1.5152     1.5152     2.0202     2.5253    4.0404
    r96      45.455     45.455      45.96      45.96      45.96      46.97    48.485
    r97       45.96      45.96      45.96     46.465     46.465     47.475     48.99
    r98      46.465     46.465     46.465      46.97      46.97      47.98     48.99
    r99       46.97      46.97      46.97     47.475     47.475     48.485    49.495
    r100     47.475     47.475     47.475      47.98      47.98      48.99        50</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_vec-speed-tests" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Test FF_VFI_AZ_BISEC_VEC Speed Tests</h3>
<p>Call the function with different a and z grid size, print out speed:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = true;
mp_support(&#39;ls_ffcmd&#39;) = {};</code></pre>
<p>A grid 200, shock grid 9:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 200;
mp_params(&#39;it_z_n&#39;) = 9;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 0.220867 seconds.</code></pre>
<p>A grid 750, shock grid 15:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 15;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 3.573648 seconds.</code></pre>
<p>A grid 600, shock grid 45:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 600;
mp_params(&#39;it_z_n&#39;) = 45;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 8.398580 seconds.</code></pre>
</div>
<div id="test-ff_vfi_az_vec-control-outputs" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Test FF_VFI_AZ_VEC Control Outputs</h3>
<p>Run the function first without any outputs;</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = false;
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;</code></pre>
<p>Run the function and show policy function for savings choice. For
ls_ffcmd, ls_ffsna, ls_ffgrh, can include these: ‘v’, ‘ap’, ‘c’, ‘y’,
‘coh’, ‘savefraccoh’. These are value, aprime savings choice,
consumption, income, cash on hand, and savings fraction as cash-on-hand.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
% ls_ffcmd: summary print which outcomes
mp_support(&#39;ls_ffcmd&#39;) = {};
% ls_ffsna: detail print which outcomes
mp_support(&#39;ls_ffsna&#39;) = {&#39;savefraccoh&#39;};
% ls_ffgrh: graphical print which outcomes
mp_support(&#39;ls_ffgrh&#39;) = {&#39;savefraccoh&#39;};
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 0.014484 seconds.
xxx  ff_vfi_az_vec, outcome=savefraccoh  xxxxxxxxxxxxxxxxxxxxxxxxxxx
    group      a       mean_z_0_54195    mean_z_0_66401    mean_z_0_88162    mean_z_1_3095    mean_z_2_2745
    _____    ______    ______________    ______________    ______________    _____________    _____________

      1           0             0                 0                 0                 0           0.3505   
      2      1.0204             0                 0           0.46928           0.37487          0.51572   
      3      2.0408       0.36632           0.34687           0.63373           0.54163          0.61186   
      4      3.0612       0.53265           0.51178           0.47837           0.63592          0.67476   
      5      4.0816       0.62764           0.60816           0.57627           0.69655          0.71911   
      6       5.102       0.68908           0.67137           0.64196           0.73882          0.75206   
      7      6.1224       0.73208           0.71603           0.68909           0.76996          0.77751   
      8      7.1429       0.76386           0.74926           0.72456           0.79387          0.79776   
      9      8.1633        0.7883           0.77494           0.75221           0.81279          0.81425   
     10      9.1837       0.80769           0.79539           0.77438           0.82815          0.82795   
     11      10.204       0.82343           0.81206           0.79254           0.84086           0.8395   
     12      11.224       0.83648           0.82591            0.8077           0.85155          0.84937   
     13      12.245       0.84747           0.83759           0.82053           0.86067          0.85791   
     14      13.265       0.85685           0.84758           0.83155           0.80173          0.86537   
     15      14.286       0.86495           0.85622            0.8411           0.81288          0.87194   
     16      15.306       0.87201           0.86377           0.84947           0.82268          0.82291   
     17      16.327       0.87823           0.87043           0.85685           0.83137          0.83104   
     18      17.347       0.88374           0.87633           0.86342           0.83912          0.83834   
     19      18.367       0.88866           0.88161            0.8693           0.84608          0.84495   
     20      19.388       0.89309           0.88635            0.8746           0.85237          0.85095   
     21      20.408       0.89708           0.89064           0.87939           0.85807          0.85642   
     22      21.429       0.85567           0.89454           0.88375           0.86327          0.86143   
     23      22.449       0.86096           0.89809           0.88773           0.86803          0.86604   
     24      23.469       0.86581           0.90135           0.89138           0.87241          0.87029   
     25       24.49       0.87026           0.86502           0.89474           0.87644          0.87422   
     26       25.51       0.87436            0.8693           0.89784           0.88017          0.87787   
     27      26.531       0.87816           0.87327           0.90071           0.88362          0.88126   
     28      27.551       0.88168           0.87695           0.90338           0.88684          0.88443   
     29      28.571       0.88496           0.88037           0.90586           0.88984          0.88739   
     30      29.592       0.88802           0.88357           0.90818           0.89264          0.89017   
     31      30.612       0.89087           0.88655           0.87896           0.89527          0.89278   
     32      31.633       0.89355           0.88935           0.88197           0.89773          0.89523   
     33      32.653       0.89606           0.89198            0.8848           0.90005          0.89754   
     34      33.673       0.89843           0.89446           0.88747           0.90223          0.89972   
     35      34.694       0.90065           0.89679           0.88998           0.90429          0.90178   
     36      35.714       0.90275           0.89899           0.89235           0.90624          0.90374   
     37      36.735       0.90474           0.90107            0.8946           0.90809          0.90559   
     38      37.755       0.90662           0.90304           0.89673           0.90984          0.90735   
     39      38.776       0.90841           0.90491           0.89874            0.9115          0.90902   
     40      39.796        0.9101           0.90669           0.90066           0.91308          0.91062   
     41      40.816       0.91171           0.90838           0.90249           0.91458          0.91214   
     42      41.837       0.91325           0.90998           0.90422           0.91601          0.91359   
     43      42.857       0.91471           0.91152           0.90588           0.91738          0.91497   
     44      43.878        0.9161           0.91298           0.90746           0.89681          0.89499   
     45      44.898       0.91743           0.91438           0.90897           0.89854          0.89671   
     46      45.918       0.91871           0.91571           0.91042           0.90019          0.89836   
     47      46.939       0.91993           0.91699           0.91181           0.90178          0.89994   
     48      47.959        0.9211           0.91822           0.91313            0.9033          0.90146   
     49       48.98       0.92222           0.91939           0.91441           0.90475          0.90292   
     50          50       0.92329           0.92052           0.91563           0.90615          0.90433   </code></pre>
<p><img src="img/fx_vfi_az_vec_images/figure_0.png" width="500" /></p>
<p><img src="img/fx_vfi_az_vec_images/figure_1.png" width="500" /></p>
<p>Run the function and show summaries for savings and fraction of coh
saved:</p>
<pre><code>mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 9;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;ap&#39;, &#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_support(&#39;bl_vfi_store_all&#39;) = true; % store c(a,z), y(a,z)
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 0.127807 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    ap             1     1      2       900     100      9       21825      24.25     14.089      0.581      0          50
    savefraccoh    2     2      2       900     100      9      752.38    0.83597    0.13497    0.16145      0     0.91812

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8        c9  
            _______    _______    _______    _______    _______    _______    _______    ______    ______

    r1            0          0          0          0          0          0    0.50505    1.5152    3.0303
    r2            0          0          0          0    0.50505    0.50505     1.0101    1.5152    3.5354
    r3      0.50505    0.50505    0.50505    0.50505    0.50505     1.0101     1.5152    2.0202    4.0404
    r4       1.0101     1.0101     1.0101     1.0101     1.0101     1.5152     2.0202    2.5253    4.5455
    r5       1.5152     1.5152     1.5152     1.5152     1.5152     2.0202     2.5253    3.0303    5.0505
    r96      45.455     45.455     45.455      45.96      45.96      45.96     46.465    47.475    49.495
    r97       45.96      45.96      45.96     46.465     46.465     46.465      46.97     47.98    49.495
    r98      46.465     46.465     46.465     46.465      46.97      46.97     47.475    48.485        50
    r99       46.97      46.97      46.97      46.97     47.475     47.475      47.98     48.99        50
    r100     47.475     47.475     47.475     47.475      47.98      47.98     48.485    49.495        50

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8         c9   
            _______    _______    _______    _______    _______    _______    _______    _______    _______

    r1            0          0          0          0          0          0    0.24587    0.48182    0.56208
    r2            0          0          0          0     0.3075    0.25444    0.39276    0.41371    0.59831
    r3      0.30679    0.29486    0.27938    0.25939     0.2338    0.40362    0.49043     0.4833     0.6287
    r4       0.4668    0.45285    0.43438    0.40981    0.37721    0.50166    0.56006    0.53755    0.65456
    r5      0.56502    0.55132    0.53293    0.50802    0.47415    0.57101    0.61221    0.58103    0.67683
    r96     0.91292     0.9117    0.90997    0.91752    0.91364    0.90746    0.90692    0.90732    0.90699
    r97     0.91357    0.91236    0.91064    0.91812    0.91427    0.90815    0.90761    0.90799    0.89847
    r98      0.9142      0.913     0.9113    0.90882    0.91489    0.90882    0.90828    0.90865    0.89919
    r99     0.91482    0.91363    0.91195    0.90949    0.91549    0.90949    0.90894    0.90929    0.89089
    r100    0.91543    0.91425    0.91258    0.91014    0.91609    0.91013    0.90959    0.90992    0.88275</code></pre>
</div>
<div id="test-ff_vfi_az_vec-change-interest-rate-and-discount" class="section level3">
<h3><span class="header-section-number">1.2.4</span> Test FF_VFI_AZ_VEC Change Interest Rate and Discount</h3>
<p>Show only save fraction of cash on hand:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 9;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with several different interest rates and discount
factor:</p>
<pre><code>% Lower Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.80;
mp_params(&#39;fl_r&#39;) = 0.01;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 0.771613 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      3318.8    0.49167    0.27768    0.56477      0     0.80542

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6          c7         c8         c9   
            _______    _______    _______    _______    _______    _______    ________    _______    _______

    r1            0          0          0          0          0          0    0.023475    0.13289    0.29755
    r2            0          0          0          0          0          0    0.023475    0.13289    0.29755
    r3            0          0          0          0          0          0    0.023475    0.13289    0.29755
    r4            0          0          0          0          0          0    0.023475    0.13289    0.29755
    r5            0          0          0          0          0          0    0.023475    0.13289    0.29755
    r746     0.8044    0.80333    0.80182    0.79961    0.79626    0.79093      0.7887     0.7824    0.77641
    r747    0.80465    0.80359    0.80209    0.79989    0.79655    0.79124     0.78903    0.78277    0.77686
    r748    0.80491    0.80385    0.80235    0.80016    0.79683    0.79154     0.78936    0.78315    0.77731
    r749    0.80517    0.80411    0.80262    0.80043    0.79712    0.79185     0.78969    0.78352    0.77776
    r750    0.80542    0.80437    0.80288    0.80071     0.7974    0.79215     0.79002    0.78389    0.77821

% Higher Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.95;
mp_params(&#39;fl_r&#39;) = 0.04;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 2.484993 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      4491.9    0.66547    0.28771    0.43234      0     0.93029

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4          c5         c6         c7         c8         c9   
            _______    _______    _______    _______    ________    _______    _______    _______    _______

    r1            0          0          0          0    0.031818    0.14726    0.31047    0.48484    0.64489
    r2            0          0          0          0    0.031818    0.14726    0.31047    0.48484    0.64489
    r3            0          0          0          0    0.031818    0.14726    0.31047    0.48484    0.64489
    r4            0          0          0          0    0.031818    0.14726    0.31047    0.48484    0.64489
    r5            0          0          0          0    0.031818    0.14726    0.31047    0.48484    0.64489
    r746    0.92742       0.93     0.9283    0.92581     0.92578    0.92349    0.92443    0.91686    0.88398
    r747     0.9275    0.93007    0.92838     0.9259     0.92588    0.92361    0.92457    0.91706    0.88076
    r748    0.92757    0.93014    0.92846    0.92599     0.92598    0.92373    0.92472    0.91359    0.87757
    r749    0.92764    0.93022    0.92854    0.92608     0.92608    0.92384    0.92115    0.91014    0.87438
    r750    0.92772    0.93029    0.92862    0.92617     0.92618    0.92396     0.9213    0.90671    0.87121</code></pre>
</div>
<div id="test-ff_vfi_az_vec-changing-risk-aversion" class="section level3">
<h3><span class="header-section-number">1.2.5</span> Test FF_VFI_AZ_VEC Changing Risk Aversion</h3>
<p>Here, again, show fraction of coh saved in summary tabular form, but
also show it graphically.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {&#39;savefraccoh&#39;};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 9;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with different risk aversion levels, higher preferences
for risk:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_crra&#39;) = 0.5;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 1.991475 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean       std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    ______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      3735.9    0.55347    0.2897    0.52343      0     0.85998

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6          c7         c8         c9   
            _______    _______    _______    _______    _______    _______    ________    _______    _______

    r1            0          0          0          0          0          0    0.075021    0.22812    0.41075
    r2            0          0          0          0          0          0    0.075021    0.22812    0.41075
    r3            0          0          0          0          0          0    0.075021    0.22812    0.41075
    r4            0          0          0          0          0          0    0.075021    0.22812    0.41075
    r5            0          0          0          0          0          0    0.075021    0.22812    0.41075
    r746    0.85928    0.85816    0.85657    0.85425    0.85428     0.8522     0.84972    0.84635    0.84292
    r747    0.85946    0.85834    0.85676    0.85444    0.85449    0.85242     0.84997    0.84665     0.8433
    r748    0.85963    0.85852    0.85694    0.85464    0.85469    0.85264     0.85021    0.84694    0.84368
    r749    0.85981     0.8587    0.85713    0.85483    0.85489    0.85286     0.85046    0.84723    0.84405
    r750    0.85998    0.85888    0.85731    0.85502    0.85509    0.85307      0.8507    0.84752    0.84442</code></pre>
<p><img src="img/fx_vfi_az_vec_images/figure_2.png" width="500" /></p>
<p><img src="img/fx_vfi_az_vec_images/figure_3.png" width="500" /></p>
<p>When risk aversion increases, at every state-space point, the household
wants to save more.</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_crra&#39;) = 5;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 2.026442 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean       std      coefvari    min     max 
                   _    ___    ____    _____    ____    ____    ______    ______    _______    ________    ___    _____

    savefraccoh    1     1      2      6750     750      9      4639.3    0.6873    0.28204    0.41036      0     0.942

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3          c4           c5         c6         c7         c8         c9   
            _______    _______    _______    _________    ________    _______    _______    _______    _______

    r1            0          0          0     0.008995    0.085095    0.21314    0.37277    0.53628    0.68332
    r2            0          0          0     0.008995    0.085095    0.21314    0.37277    0.53628    0.68332
    r3            0          0          0     0.008995    0.085095    0.21314    0.37277    0.53628    0.68332
    r4            0          0          0     0.008995    0.085095    0.21314    0.37277    0.53628    0.68332
    r5            0          0          0    0.0089949    0.085094    0.21314    0.37277    0.53628    0.68332
    r746    0.94083     0.9396    0.94168      0.93912     0.93904    0.94041    0.93743    0.92949    0.89566
    r747    0.94091    0.93969    0.94176      0.93921     0.93914    0.93674    0.93758    0.92969    0.89241
    r748    0.94098    0.93977    0.94184      0.93931     0.93924    0.93686    0.93772    0.92618    0.88918
    r749    0.94106    0.93985    0.94192       0.9394     0.93934    0.93699    0.93787    0.92269    0.88596
    r750    0.94113    0.93993      0.942      0.93949     0.93944    0.93711    0.93801    0.91921    0.88275</code></pre>
<p><img src="img/fx_vfi_az_vec_images/figure_4.png" width="500" /></p>
<p><img src="img/fx_vfi_az_vec_images/figure_5.png" width="500" /></p>
</div>
<div id="test-ff_vfi_az_vec-with-higher-uncertainty" class="section level3">
<h3><span class="header-section-number">1.2.6</span> Test FF_VFI_AZ_VEC with Higher Uncertainty</h3>
<p>Increase the standard deviation of the Shock.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 9;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Lower standard deviation of shock:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.10;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 2.065989 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN    sum      mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ____    _______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      4026    0.59644    0.31533    0.52869      0     0.91423

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5          c6          c7         c8         c9   
            _______    _______    _______    _______    _______    ________    ________    _______    _______

    r1            0          0          0          0          0    0.012569    0.062884    0.13754    0.22274
    r2            0          0          0          0          0    0.012569    0.062884    0.13754    0.22274
    r3            0          0          0          0          0    0.012569    0.062884    0.13754    0.22274
    r4            0          0          0          0          0    0.012569    0.062884    0.13754    0.22274
    r5            0          0          0          0          0    0.012569    0.062884    0.13754    0.22274
    r746    0.91375    0.91251    0.91101    0.91289    0.91057     0.91138     0.91136    0.91021     0.9075
    r747    0.91387    0.91264    0.91114    0.91302    0.91072     0.91153     0.91152    0.91039    0.90769
    r748    0.91399    0.91277    0.91127    0.91315    0.91086     0.91168     0.91168    0.91056    0.90788
    r749    0.91411    0.91289     0.9114    0.91329      0.911     0.91183     0.91183    0.91073    0.90807
    r750    0.91423    0.91302    0.91153    0.91342    0.91114     0.91197     0.91199     0.9109    0.90826</code></pre>
<p>Higher shock standard deviation: low shock high asset save more, high
shock more asset save less, high shock low asset save more:</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.40;
ff_vfi_az_vec(mp_params, mp_support);

Elapsed time is 2.184888 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min     max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    ______

    savefraccoh    1     1      2      6750     750      9      4687.4    0.69442    0.27109    0.39038      0     0.9339

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4          c5         c6         c7         c8         c9   
            _______    _______    _______    _______    ________    _______    _______    _______    _______

    r1            0          0          0          0    0.030619    0.24561    0.55369    0.80189    0.46265
    r2            0          0          0          0    0.030619    0.24561    0.55369    0.80189    0.46265
    r3            0          0          0          0    0.030619     0.2456    0.55369    0.80189    0.46265
    r4            0          0          0          0    0.030619     0.2456    0.55369    0.80189    0.46265
    r5            0          0          0          0    0.030618     0.2456    0.55369    0.80189    0.46265
    r746    0.93365    0.93335     0.9328    0.93173     0.92941    0.92713    0.92079     0.8402    0.31544
    r747    0.93371    0.93341    0.93286     0.9318     0.92949    0.92723    0.92095    0.83734    0.31504
    r748    0.93378    0.93348    0.93293    0.93187     0.92957    0.92733    0.92111    0.83449    0.31463
    r749    0.93384    0.93354      0.933    0.93194     0.92965    0.92743    0.92127    0.83166    0.31423
    r750     0.9339     0.9336    0.93306    0.93201     0.92973    0.92753    0.92143    0.82883    0.31383</code></pre>

</div>
</div>
<div id="ff_vfi_az_bisec_loop-dynamic-savings-problem-loop-continuous-choice" class="section level2">
<h2><span class="header-section-number">1.3</span> FF_VFI_AZ_BISEC_LOOP Dynamic Savings Problem Loop Continuous Choice</h2>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Toolbox (<a href="https://fanwangecon.github.io/MEconTools/bookdown">bookdown</a>), <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown</a>).</p>
</blockquote>
<p>This is the example vignette for function:<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_loop.m"><strong>ff_vfi_az_bisec_loop</strong></a>from
the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> This function
solves the dynamic programming problem for a (a,z) model. Households can
save a, and face AR(1) shock z. The problem is solved over the infinite
horizon. This is the looped code, it is slow for larger state-space
problems. The code uses continuous choices, solved with bisection. The
state-space is on a grid, but choice grids are in terms of percentage of
resources to save and solved exactly.</p>
<p><strong>Links to Four Code:</strong></p>
<p>Four Core Savings/Borrowing Dynamic Programming Solution Functions that
are functions in the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> :</p>
<ul>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_loop.m"><strong>ff_vfi_az_loop</strong></a>,
slow should use for testing new models</p></li>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_vec.m"><strong>ff_vfi_az_vec</strong></a>,
fast good for many purposes</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_loop.m"><strong>ff_vfi_az_bisec_loop</strong></a>,
high precision even with small grid</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_vec.m"><strong>ff_vfi_az_bisec_vec</strong></a>,
precision and speed</p></li>
</ul>
<div id="test-ff_vfi_az_bisec_loop-defaults" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Test FF_VFI_AZ_BISEC_LOOP Defaults</h3>
<p>Call the function with defaults. By default, shows the asset policy
function summary. Model parameters can be changed by the mp_params.</p>
<pre><code>%mp_params
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;fl_crra&#39;) = 1.5;
mp_params(&#39;fl_beta&#39;) = 0.94;
% call function
ff_vfi_az_bisec_loop(mp_params);

Elapsed time is 13.575906 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          i    idx    ndim    numel    rowN    colN     sum      mean      std      coefvari    min     max  
          _    ___    ____    _____    ____    ____    _____    ______    ______    ________    ___    ______

    ap    1     1      2       700     100      7      15835    22.621    13.367    0.59091      0     47.273

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7  
            _______    _______    _______    _______    _______    _______    ______

    r1            0          0          0          0          0    0.38021    1.4609
    r2      0.19477    0.18872    0.19731    0.24709    0.41492    0.79311    1.8893
    r3      0.54595    0.54109    0.55664    0.62239    0.81173     1.2132    2.3195
    r4       1.0101     1.0101     1.0101     1.0189     1.2217     1.6363    2.7464
    r5       1.4388     1.4362      1.459     1.5151     1.6354     2.0602    3.1804
    r96      43.225     43.246       43.3     43.422     43.632     44.155    45.413
    r97       43.69      43.71     43.765     43.887     44.096     44.618    45.879
    r98      44.154     44.174     44.228     44.352     44.559     45.083    46.344
    r99      44.618     44.638     44.693     44.815     45.024     45.548    46.809
    r100      45.08     45.101     45.156      45.28     45.487     46.012    47.273</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_loop-speed-tests" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Test FF_VFI_AZ_BISEC_LOOP Speed Tests</h3>
<p>Call the function with different a and z grid size, print out speed:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = true;
mp_support(&#39;ls_ffcmd&#39;) = {};</code></pre>
<p>A grid 50, shock grid 5:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 4.733351 seconds.</code></pre>
<p>A grid 100, shock grid 7:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 7;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 13.889250 seconds.</code></pre>
<p>A grid 200, shock grid 9:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 200;
mp_params(&#39;it_z_n&#39;) = 9;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 38.195963 seconds.</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_loop-control-outputs" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Test FF_VFI_AZ_BISEC_LOOP Control Outputs</h3>
<p>Run the function first without any outputs;</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = false;
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;</code></pre>
<p>Run the function and show policy function for savings choice. For
ls_ffcmd, ls_ffsna, ls_ffgrh, can include these: ‘v’, ‘ap’, ‘c’, ‘y’,
‘coh’, ‘savefraccoh’. These are value, aprime savings choice,
consumption, income, cash on hand, and savings fraction as cash-on-hand.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
% ls_ffcmd: summary print which outcomes
mp_support(&#39;ls_ffcmd&#39;) = {};
% ls_ffsna: detail print which outcomes
mp_support(&#39;ls_ffsna&#39;) = {&#39;ap&#39;};
% ls_ffgrh: graphical print which outcomes
mp_support(&#39;ls_ffgrh&#39;) = {&#39;ap&#39;};
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 4.728102 seconds.
xxx  ff_vfi_az_vec, outcome=ap  xxxxxxxxxxxxxxxxxxxxxxxxxxx
    group      a       mean_z_0_54195    mean_z_0_66401    mean_z_0_88162    mean_z_1_3095    mean_z_2_2745
    _____    ______    ______________    ______________    ______________    _____________    _____________

      1           0             0                 0                 0                 0          0.70914   
      2      1.0204       0.58666            0.5889           0.64782           0.89696           1.5821   
      3      2.0408        1.3824            1.3926            1.4723            1.7501           2.4674   
      4      3.0612        2.2189            2.2357            2.3281            2.6228           3.3608   
      5      4.0816        3.0774            3.0995            3.2007            3.5069           4.2595   
      6       5.102        4.0815            4.0816            4.0833            4.3986           5.1595   
      7      6.1224        4.9896            5.0184            5.1021            5.2928           6.1223   
      8      7.1429        5.8564            5.8902            6.0116            6.1873           7.0951   
      9      8.1633        6.7406            6.7749            6.8956            7.1428           7.9989   
     10      9.1837        7.6346            7.6706            7.7922            8.1324           8.9028   
     11      10.204        8.5353             8.572            8.6944            9.0301           9.8113   
     12      11.224        9.4411            9.4787            9.6014            9.9343           10.726   
     13      12.245         10.35            10.389            10.512            10.845           11.644   
     14      13.265        11.263            11.302            11.427            11.761           12.565   
     15      14.286        12.245            12.245            12.344             12.68           13.488   
     16      15.306        13.224            13.264            13.265              13.6           14.413   
     17      16.327        14.141            14.182            14.286            14.523           15.339   
     18      17.347        15.052            15.097            15.228            15.446           16.327   
     19      18.367        15.971            16.014            16.147             16.37           17.311   
     20      19.388        16.889            16.933            17.065            17.347           18.233   
     21      20.408        17.811            17.856            17.989             18.34           19.157   
     22      21.429        18.735            18.779            18.912            19.265           20.083   
     23      22.449         19.66            19.705            19.838            20.187            21.01   
     24      23.469        20.586            20.632            20.765            21.113           21.938   
     25       24.49        21.513            21.559            21.693            22.041           22.869   
     26       25.51        22.449            22.488            22.622             22.97             23.8   
     27      26.531        23.469             23.47            23.551              23.9           24.732   
     28      27.551        24.418            24.464             24.49            24.831           25.665   
     29      28.571        25.348            25.394             25.51            25.763           26.599   
     30      29.592        26.276            26.325             26.46            26.696           27.551   
     31      30.612        27.203            27.252            27.392            27.629           28.572   
     32      31.633        28.135            28.182            28.321            28.571           29.514   
     33      32.653        29.067            29.115            29.251            29.592           30.446   
     34      33.673        29.998            30.047            30.185            30.542           31.379   
     35      34.694        30.931            30.979            31.118            31.476           32.312   
     36      35.714        31.866            31.913             32.05            32.407           33.246   
     37      36.735        32.799            32.848            32.985             33.34           34.182   
     38      37.755        33.733            33.782            33.921            34.276           35.118   
     39      38.776        34.694            34.718            34.856            35.211           36.054   
     40      39.796        35.714            35.714            35.792            36.145            36.99   
     41      40.816        36.651              36.7            36.735            37.082           37.929   
     42      41.837        37.587            37.636            37.755             38.02           38.865   
     43      42.857        38.523            38.573            38.712            38.957           39.805   
     44      43.878        39.457            39.508            39.648            39.894           40.816   
     45      44.898        40.391            40.441            40.585            40.832           41.788   
     46      45.918        41.328            41.379            41.519            41.836           42.727   
     47      46.939        42.266            42.316            42.455            42.816           43.665   
     48      47.959        43.204            43.254            43.393            43.754           44.601   
     49       48.98         44.14            44.191            44.332            44.693           45.539   
     50          50        45.077            45.128            45.269            45.631           46.478   </code></pre>
<p><img src="img/fx_vfi_az_bisec_loop_images/figure_0.png" width="500" /></p>
<p><img src="img/fx_vfi_az_bisec_loop_images/figure_1.png" width="500" /></p>
<p>Run the function and show summaries for savings and fraction of coh
saved:</p>
<pre><code>mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 9;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;ap&#39;, &#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_support(&#39;bl_vfi_store_all&#39;) = true; % store c(a,z), y(a,z)
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 18.110812 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    ap             1     1      2       900     100      9       20493      22.77     13.386     0.5879      0      48.391
    savefraccoh    2     2      2       900     100      9      701.94    0.77994    0.13136    0.16842      0     0.86927

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4        c5         c6         c7         c8         c9  
            _______    _______    _______    ______    _______    _______    _______    _______    ______

    r1            0          0          0         0          0          0    0.20716    0.89208    2.4759
    r2      0.19971    0.19144    0.18896    0.2007    0.24755    0.38215    0.61592     1.3126    2.9098
    r3      0.55145    0.54262    0.54255    0.5618    0.62321    0.77699     1.0303     1.7326    3.3477
    r4       1.0101     1.0101     1.0101    1.0101     1.0198     1.1844     1.5151     2.1613    3.7899
    r5       1.4445      1.436     1.4393    1.4657     1.5152     1.5944     1.9615     2.5895    4.2337
    r96      43.226     43.233     43.257    43.313     43.424     43.584     43.951     44.764    46.479
    r97       43.69     43.697     43.722    43.776     43.888     44.048     44.444     45.227     46.97
    r98      44.155     44.161     44.186    44.241     44.352     44.512     44.933     45.692    47.461
    r99      44.619     44.626      44.65    44.707     44.817     44.976     45.398     46.156    47.927
    r100     45.081     45.088     45.114    45.169      45.28     45.454     45.861     46.621    48.391

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8         c9   
            _______    _______    _______    _______    _______    _______    _______    _______    _______

    r1            0          0          0          0          0          0    0.10085    0.28368    0.45924
    r2      0.17696    0.16018    0.14648     0.1404    0.15072    0.19253    0.23949    0.35842    0.49245
    r3      0.33498    0.31679    0.30013    0.28853     0.2885    0.31047    0.33348    0.41451    0.52092
    r4      0.46678    0.45284    0.43437    0.40981    0.38082    0.39214    0.42003    0.46007    0.54576
    r5      0.53868    0.52254    0.50624    0.49144    0.47417    0.45067    0.47554    0.49651    0.56737
    r96     0.86817    0.86713    0.86597    0.86469    0.86323    0.86054    0.85786    0.85551    0.85172
    r97     0.86845    0.86744    0.86631      0.865    0.86356    0.86091     0.8588     0.8559    0.85264
    r98     0.86875    0.86774    0.86662    0.86533     0.8639    0.86128    0.85966     0.8563    0.85352
    r99     0.86903    0.86805    0.86692    0.86567    0.86424    0.86161    0.86002     0.8567    0.85395
    r100    0.86927    0.86829     0.8672    0.86594    0.86454    0.86222    0.86036    0.85709    0.85435</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_loop-change-interest-rate-and-discount" class="section level3">
<h3><span class="header-section-number">1.3.4</span> Test FF_VFI_AZ_BISEC_LOOP Change Interest Rate and Discount</h3>
<p>Show only save fraction of cash on hand:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with several different interest rates and discount
factor:</p>
<pre><code>% Lower Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.80;
mp_params(&#39;fl_r&#39;) = 0.01;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 1.421696 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       250      50      5      94.272    0.37709    0.25552    0.67761      0     0.68364

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
             c1         c2         c3         c4           c5    
           _______    _______    _______    _______    __________

    r1           0          0          0          0    0.00014733
    r2           0          0          0          0    0.00014733
    r3           0          0          0          0     0.0011239
    r4           0          0          0          0     0.0011544
    r5           0          0          0          0     0.0039009
    r46    0.67805    0.67137    0.66298     0.6526       0.64094
    r47    0.67964    0.67329    0.66536     0.6555       0.64439
    r48     0.6811    0.67506    0.66752    0.65818        0.6476
    r49    0.68242    0.67671     0.6696    0.66075       0.65059
    r50    0.68364    0.67826    0.67158    0.66319       0.65336

% Higher Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.95;
mp_params(&#39;fl_r&#39;) = 0.04;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 5.579251 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       250      50      5      146.44    0.58575    0.29994    0.51206      0     0.88761

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
             c1         c2           c3           c4         c5   
           _______    _______    __________    ________    _______

    r1           0          0             0    0.086968     0.3134
    r2           0          0             0    0.086938     0.3135
    r3           0          0             0    0.086877    0.31423
    r4           0          0             0    0.091393    0.31621
    r5           0          0    0.00036095     0.10012    0.31765
    r46    0.87894     0.8773       0.87437     0.86796    0.86643
    r47    0.88136     0.8798       0.87717     0.87083    0.86933
    r48    0.88358    0.88215       0.87983     0.87348    0.87202
    r49    0.88566    0.88432        0.8823     0.87595    0.87455
    r50    0.88761    0.88633       0.88465     0.87827    0.87687</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_loop-changing-risk-aversion" class="section level3">
<h3><span class="header-section-number">1.3.5</span> Test FF_VFI_AZ_BISEC_LOOP Changing Risk Aversion</h3>
<p>Here, again, show fraction of coh saved in summary tabular form, but
also show it graphically.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {&#39;savefraccoh&#39;};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 5;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with different risk aversion levels, higher preferences
for risk:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_crra&#39;) = 0.5;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 9.991698 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      214.05    0.42811    0.27486    0.64204      0     0.74757

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4          c5   
            _______    _______    _______    _______    ________

    r1            0          0          0          0    0.023554
    r2            0          0          0          0    0.023554
    r3            0          0          0          0    0.023554
    r4            0          0          0          0    0.023615
    r5            0          0          0          0    0.024256
    r96      0.7393    0.73551    0.73109    0.72261     0.71525
    r97     0.74049    0.73805    0.73374    0.72544     0.71702
    r98      0.7429    0.74052    0.73634    0.72825      0.7187
    r99     0.74525    0.74296    0.73887      0.731     0.72032
    r100    0.74757    0.74534    0.74113    0.73371     0.72187</code></pre>
<p><img src="img/fx_vfi_az_bisec_loop_images/figure_2.png" width="500" /></p>
<p><img src="img/fx_vfi_az_bisec_loop_images/figure_3.png" width="500" /></p>
<p>When risk aversion increases, at every state-space point, the household
wants to save more.</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_crra&#39;) = 5;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 8.955693 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      323.21    0.64642    0.28954    0.44792      0     0.92356

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2          c3         c4         c5   
            _______    _______    ________    _______    _______

    r1            0          0    0.053308    0.22219    0.44872
    r2            0          0    0.053338    0.22222    0.44875
    r3            0          0    0.053644     0.2224    0.44881
    r4            0          0    0.054498    0.22286    0.44899
    r5            0          0    0.056115    0.22378    0.44936
    r96     0.91981    0.91901     0.91813    0.91575    0.91523
    r97     0.92081    0.92002     0.91914    0.91682     0.9163
    r98     0.92176      0.921     0.92014    0.91785     0.9173
    r99     0.92268    0.92194     0.92112    0.91883    0.91831
    r100    0.92356    0.92286     0.92203    0.91981    0.91926</code></pre>
<p><img src="img/fx_vfi_az_bisec_loop_images/figure_4.png" width="500" /></p>
<p><img src="img/fx_vfi_az_bisec_loop_images/figure_5.png" width="500" /></p>
</div>
<div id="test-ff_vfi_az_bisec_loop-with-higher-uncertainty" class="section level3">
<h3><span class="header-section-number">1.3.6</span> Test FF_VFI_AZ_BISEC_LOOP with Higher Uncertainty</h3>
<p>Increase the standard deviation of the Shock.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 5;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Lower standard deviation of shock:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.10;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 10.016136 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      266.09    0.53217    0.31606    0.59389      0     0.86448

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4          c5   
            _______    _______    _______    _______    ________

    r1            0          0          0          0    0.027887
    r2            0          0          0          0    0.027887
    r3            0          0          0          0    0.027887
    r4            0          0          0          0    0.027857
    r5            0          0          0          0    0.027826
    r96     0.85941    0.85841    0.85734    0.85621     0.85218
    r97     0.86076    0.85978    0.85871    0.85764     0.85368
    r98     0.86204    0.86109    0.86008    0.85902     0.85511
    r99     0.86329    0.86234    0.86137    0.86036     0.85688
    r100    0.86448    0.86359    0.86262    0.86164     0.85862</code></pre>
<p>Higher shock standard deviation: low shock high asset save more, high
shock more asset save less, high shock low asset save more:</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.40;
ff_vfi_az_bisec_loop(mp_params, mp_support);

Elapsed time is 10.186494 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2       500     100      5      324.66    0.64932    0.26596    0.40959      0     0.88483

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5   
            _______    _______    _______    _______    _______

    r1            0          0          0    0.26564    0.67546
    r2            0          0          0    0.26568    0.67549
    r3            0          0          0    0.26586    0.67549
    r4            0          0          0    0.26635    0.67552
    r5            0          0          0    0.26732    0.67558
    r96     0.88071    0.87922    0.87495    0.86723    0.85859
    r97     0.88178    0.88032     0.8762    0.86826    0.86085
    r98     0.88282    0.88139    0.87739    0.86927    0.86317
    r99     0.88383    0.88212    0.87855    0.87028    0.86668
    r100    0.88483    0.88279    0.87937    0.87128    0.87003</code></pre>

</div>
</div>
<div id="ff_vfi_az_bisec_vec-dynamic-savings-problem-vectorized-continuous-exact" class="section level2">
<h2><span class="header-section-number">1.4</span> FF_VFI_AZ_BISEC_VEC Dynamic Savings Problem Vectorized Continuous Exact</h2>
<blockquote>
<p>Go back to <a href="http://fanwangecon.github.io/">fan</a>’s <a href="https://fanwangecon.github.io/MEconTools/">MEconTools</a> Toolbox (<a href="https://fanwangecon.github.io/MEconTools/bookdown">bookdown</a>), <a href="https://fanwangecon.github.io/M4Econ/">Matlab Code Examples</a> Repository (<a href="https://fanwangecon.github.io/M4Econ/bookdown">bookdown</a>), or <a href="https://fanwangecon.github.io/Math4Econ/">Math for Econ with Matlab</a> Repository (<a href="https://fanwangecon.github.io/Math4Econ/bookdown">bookdown</a>).</p>
</blockquote>
<p>This is the example vignette for function:
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_vec.m"><strong>ff_vfi_az_bisec_vec</strong></a>
from the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> This function
solves the dynamic programming problem for a (a,z) model. Households can
save a, and face AR(1) shock z. The problem is solved over the infinite
horizon. This is a vectorized code, it is much faster for larger
state-space problems then looped code.</p>
<p>The code uses continuous choices, solved with bi(multi)section. The
state-space is on a grid, but choice grids are in terms of percentage of
resources available, which is individual specific, to save and solved
exactly up to ((1/(2)^16)*100=0.001525878) percentage of cash on hand.
THe
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_vec.m"><strong>ff_vfi_az_vec</strong></a>
from the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a> solves the same
problem using vectorized common grid code where the choice set and state
space share the same grid.</p>
<p>This is the vectorized code, its speed is much faster than the looped
code. The function is designed to have small memory footprint and
requires low computing resources, yet is fast.</p>
<p><strong>Links to Four Code:</strong></p>
<p>Four Core Savings/Borrowing Dynamic Programming Solution Functions that
are functions in the <a href="https://fanwangecon.github.io/MEconTools/"><strong>MEconTools
Package</strong></a><strong>.</strong> :</p>
<ul>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_loop.m"><strong>ff_vfi_az_loop</strong></a>,
slow should use for testing new models</p></li>
<li><p>Common Choice and States Grid :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_vec.m"><strong>ff_vfi_az_vec</strong></a>,
fast good for many purposes</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_loop.m"><strong>ff_vfi_az_bisec_loop</strong></a>,
high precision even with small grid</p></li>
<li><p>States Grid + Continuous Exact Savings as Share of Cash-on-Hand :
<a href="https://github.com/FanWangEcon/MEconTools/blob/master/MEconTools/vfi/ff_vfi_az_bisec_vec.m"><strong>ff_vfi_az_bisec_vec</strong></a>,
precision and speed</p></li>
</ul>
<div id="test-ff_vfi_az_bisec_vec-defaults" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Test FF_VFI_AZ_BISEC_VEC Defaults</h3>
<p>Call the function with defaults. By default, shows the asset policy
function summary. Model parameters can be changed by the mp_params.</p>
<pre><code>%mp_params
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;fl_crra&#39;) = 1.5;
mp_params(&#39;fl_beta&#39;) = 0.94;
% call function
ff_vfi_az_bisec_vec(mp_params);

Elapsed time is 0.341348 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
          i    idx    ndim    numel    rowN    colN     sum      mean      std      coefvari    min     max  
          _    ___    ____    _____    ____    ____    _____    ______    ______    ________    ___    ______

    ap    1     1      2       700     100      7      15835    22.621    13.367    0.59091      0     47.273

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7  
            _______    _______    _______    _______    _______    _______    ______

    r1            0          0          0          0          0    0.38021    1.4609
    r2      0.19477    0.18872    0.19731    0.24709    0.41492    0.79311    1.8893
    r3      0.54595    0.54109    0.55664    0.62239    0.81173     1.2132    2.3195
    r4       1.0101     1.0101     1.0101     1.0189     1.2217     1.6363    2.7464
    r5       1.4388     1.4362      1.459     1.5151     1.6354     2.0602    3.1804
    r96      43.225     43.246       43.3     43.422     43.632     44.155    45.413
    r97       43.69      43.71     43.765     43.887     44.096     44.618    45.879
    r98      44.154     44.174     44.228     44.352     44.559     45.083    46.344
    r99      44.618     44.638     44.693     44.815     45.024     45.548    46.809
    r100      45.08     45.101     45.156      45.28     45.487     46.012    47.273</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_vec-speed-tests-1" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Test FF_VFI_AZ_BISEC_VEC Speed Tests</h3>
<p>Call the function with defaults. By default, shows the asset policy
function summary. Model parameters can be changed by the mp_params.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = true;
mp_support(&#39;ls_ffcmd&#39;) = {};</code></pre>
<p>A grid 50, shock grid 5:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 0.188450 seconds.</code></pre>
<p>A grid 750, shock grid 15:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 15;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 12.017243 seconds.</code></pre>
<p>A grid 600, shock grid 45:</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 600;
mp_params(&#39;it_z_n&#39;) = 45;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 22.719622 seconds.</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_vec-control-outputs" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Test FF_VFI_AZ_BISEC_VEC Control Outputs</h3>
<p>Run the function first without any outputs;</p>
<pre><code>mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 50;
mp_params(&#39;it_z_n&#39;) = 5;
mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_timer&#39;) = false;
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;</code></pre>
<p>Run the function and show policy function for savings choice. For
ls_ffcmd, ls_ffsna, ls_ffgrh, can include these: ‘v’, ‘ap’, ‘c’, ‘y’,
‘coh’, ‘savefraccoh’. These are value, aprime savings choice,
consumption, income, cash on hand, and savings fraction as cash-on-hand.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
% ls_ffcmd: summary print which outcomes
mp_support(&#39;ls_ffcmd&#39;) = {};
% ls_ffsna: detail print which outcomes
mp_support(&#39;ls_ffsna&#39;) = {&#39;savefraccoh&#39;};
% ls_ffgrh: graphical print which outcomes
mp_support(&#39;ls_ffgrh&#39;) = {&#39;savefraccoh&#39;};
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 0.160923 seconds.
xxx  ff_vfi_az_vec, outcome=savefraccoh  xxxxxxxxxxxxxxxxxxxxxxxxxxx
    group      a       mean_z_0_54195    mean_z_0_66401    mean_z_0_88162    mean_z_1_3095    mean_z_2_2745
    _____    ______    ______________    ______________    ______________    _____________    _____________

      1           0             0                 0                 0                 0          0.24358   
      2      1.0204       0.33724           0.31063           0.29793           0.32952           0.3998   
      3      2.0408       0.49626           0.47337            0.4572           0.46446          0.49318   
      4      3.0612       0.57912           0.56065            0.5457           0.54484          0.55559   
      5      4.0816       0.63096           0.61577           0.60252           0.59846          0.60036   
      6       5.102       0.68907           0.67137           0.64222           0.63694          0.63377   
      7      6.1224       0.71595            0.7043            0.6891           0.66563          0.66642   
      8      7.1429       0.73066           0.72084           0.71144           0.68766          0.69337   
      9      8.1633       0.74391           0.73503           0.72618           0.71119          0.70921   
     10      9.1837       0.75538           0.74739           0.73918           0.73335          0.72236   
     11      10.204        0.7653           0.75798           0.75032           0.74412          0.73381   
     12      11.224       0.77394           0.76719           0.75999           0.75367          0.74403   
     13      12.245       0.78147           0.77525           0.76847           0.76231          0.75306   
     14      13.265       0.78816           0.78233           0.77598           0.77006          0.76115   
     15      14.286       0.79841           0.79035           0.78266           0.77699          0.76838   
     16      15.306       0.80723           0.80201            0.7888           0.78321          0.77488   
     17      16.327       0.81135            0.8065           0.79972           0.78883          0.78077   
     18      17.347       0.81474           0.81031           0.80534           0.79386          0.78904   
     19      18.367       0.81815           0.81388           0.80918           0.79841          0.79634   
     20      19.388       0.82121           0.81715            0.8126             0.805          0.80027   
     21      20.408       0.82414           0.82026           0.81596           0.81172          0.80393   
     22      21.429       0.82685           0.82313           0.81898           0.81492          0.80732   
     23      22.449       0.82938           0.82584           0.82182           0.81776          0.81053   
     24      23.469       0.83177           0.82838            0.8245            0.8205          0.81352   
     25       24.49       0.83399           0.83073             0.827            0.8231          0.81635   
     26       25.51       0.83634           0.83296           0.82935           0.82554          0.81901   
     27      26.531       0.84156           0.83689           0.83155           0.82786          0.82151   
     28      27.551       0.84394           0.84098            0.8339           0.83003          0.82389   
     29      28.571       0.84553           0.84266           0.83875            0.8321          0.82612   
     30      29.592       0.84693           0.84425           0.84107           0.83405          0.82877   
     31      30.612       0.84821           0.84562           0.84266           0.83589          0.83326   
     32      31.633       0.84956           0.84699           0.84409           0.83787          0.83527   
     33      32.653       0.85084           0.84837           0.84547           0.84199          0.83686   
     34      33.673         0.852           0.84962           0.84684           0.84391          0.83842   
     35      34.694       0.85316           0.85081           0.84815           0.84528          0.83988   
     36      35.714       0.85429             0.852           0.84934            0.8465          0.84129   
     37      36.735       0.85532           0.85313           0.85053           0.84773          0.84266   
     38      37.755       0.85633            0.8542           0.85169           0.84895          0.84397   
     39      38.776       0.85795           0.85523           0.85279           0.85008          0.84522   
     40      39.796       0.86091           0.85767           0.85383           0.85114          0.84641   
     41      40.816       0.86176           0.85975           0.85499           0.85221           0.8476   
     42      41.837       0.86256            0.8606           0.85786           0.85325           0.8487   
     43      42.857       0.86332           0.86143           0.85917           0.85423           0.8498   
     44      43.878       0.86399           0.86216           0.85999           0.85517          0.85236   
     45      44.898       0.86463           0.86283           0.86079           0.85609          0.85401   
     46      45.918       0.86533           0.86356           0.86149           0.85831          0.85493   
     47      46.939       0.86601           0.86427           0.86219           0.85996          0.85578   
     48      47.959       0.86665           0.86494           0.86292           0.86073          0.85658   
     49       48.98       0.86723           0.86558           0.86362           0.86146          0.85737   
     50          50       0.86781           0.86619           0.86427           0.86216          0.85813   </code></pre>
<p><img src="img/fx_vfi_az_bisec_vec_images/figure_0.png" width="500" /></p>
<p><img src="img/fx_vfi_az_bisec_vec_images/figure_1.png" width="500" /></p>
<p>Run the function and show summaries for savings and fraction of coh
saved:</p>
<pre><code>mp_params(&#39;it_a_n&#39;) = 100;
mp_params(&#39;it_z_n&#39;) = 9;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;ap&#39;, &#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_support(&#39;bl_vfi_store_all&#39;) = true; % store c(a,z), y(a,z)
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 0.443544 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    ap             1     1      2       900     100      9       20493      22.77     13.386     0.5879      0      48.391
    savefraccoh    2     2      2       900     100      9      701.94    0.77994    0.13136    0.16842      0     0.86927

xxx TABLE:ap xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4        c5         c6         c7         c8         c9  
            _______    _______    _______    ______    _______    _______    _______    _______    ______

    r1            0          0          0         0          0          0    0.20716    0.89208    2.4759
    r2      0.19971    0.19144    0.18896    0.2007    0.24755    0.38215    0.61592     1.3126    2.9098
    r3      0.55145    0.54262    0.54255    0.5618    0.62321    0.77699     1.0303     1.7326    3.3477
    r4       1.0101     1.0101     1.0101    1.0101     1.0198     1.1844     1.5151     2.1613    3.7899
    r5       1.4445      1.436     1.4393    1.4657     1.5152     1.5944     1.9615     2.5895    4.2337
    r96      43.226     43.233     43.257    43.313     43.424     43.584     43.951     44.764    46.479
    r97       43.69     43.697     43.722    43.776     43.888     44.048     44.444     45.227     46.97
    r98      44.155     44.161     44.186    44.241     44.352     44.512     44.933     45.692    47.461
    r99      44.619     44.626      44.65    44.707     44.817     44.976     45.398     46.156    47.927
    r100     45.081     45.088     45.114    45.169      45.28     45.454     45.861     46.621    48.391

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8         c9   
            _______    _______    _______    _______    _______    _______    _______    _______    _______

    r1            0          0          0          0          0          0    0.10085    0.28368    0.45924
    r2      0.17696    0.16018    0.14648     0.1404    0.15072    0.19253    0.23949    0.35842    0.49245
    r3      0.33498    0.31679    0.30013    0.28853     0.2885    0.31047    0.33348    0.41451    0.52092
    r4      0.46678    0.45284    0.43437    0.40981    0.38082    0.39214    0.42003    0.46007    0.54576
    r5      0.53868    0.52254    0.50624    0.49144    0.47417    0.45067    0.47554    0.49651    0.56737
    r96     0.86817    0.86713    0.86597    0.86469    0.86323    0.86054    0.85786    0.85551    0.85172
    r97     0.86845    0.86744    0.86631      0.865    0.86356    0.86091     0.8588     0.8559    0.85264
    r98     0.86875    0.86774    0.86662    0.86533     0.8639    0.86128    0.85966     0.8563    0.85352
    r99     0.86903    0.86805    0.86692    0.86567    0.86424    0.86161    0.86002     0.8567    0.85395
    r100    0.86927    0.86829     0.8672    0.86594    0.86454    0.86222    0.86036    0.85709    0.85435</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_vec-change-interest-rate-and-discount" class="section level3">
<h3><span class="header-section-number">1.4.4</span> Test FF_VFI_AZ_BISEC_VEC Change Interest Rate and Discount</h3>
<p>Show only save fraction of cash on hand:</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 9;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with several different interest rates and discount
factor:</p>
<pre><code>% Lower Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.80;
mp_params(&#39;fl_r&#39;) = 0.01;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 2.064615 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min     max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    ______

    savefraccoh    1     1      2      6750     750      9      2573.6    0.38127    0.24694    0.64767      0     0.6869

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7          c8         c9   
            _______    _______    _______    _______    _______    _______    _______    ________    _______

    r1            0          0          0          0          0          0          0    0.014734    0.11626
    r2            0          0          0          0          0          0          0    0.014734    0.11626
    r3            0          0          0          0          0          0          0    0.014734    0.11626
    r4            0          0          0          0          0          0          0    0.014734    0.11626
    r5            0          0          0          0          0          0          0    0.014734    0.11626
    r746    0.68623    0.68354    0.68095    0.67686    0.67308    0.66722    0.66044     0.65098    0.63987
    r747    0.68663    0.68364    0.68119    0.67698     0.6732    0.66734    0.66063     0.65117    0.64009
    r748    0.68675     0.6837    0.68129    0.67711    0.67332    0.66749    0.66078     0.65138    0.64027
    r749    0.68681    0.68379    0.68141     0.6772    0.67344    0.66764    0.66096     0.65184    0.64048
    r750     0.6869    0.68385     0.6815    0.67759    0.67357    0.66777    0.66111     0.65233     0.6407

% Higher Savings Incentives
mp_params(&#39;fl_beta&#39;) = 0.95;
mp_params(&#39;fl_r&#39;) = 0.04;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 8.355503 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      4047.5    0.59963    0.28766    0.47974      0     0.88682

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5          c6         c7         c8         c9   
            _______    _______    _______    _______    _______    ________    _______    _______    _______

    r1            0          0          0          0          0    0.046381    0.17205    0.33791    0.51164
    r2            0          0          0          0          0    0.046381    0.17205    0.33791    0.51164
    r3            0          0          0          0          0    0.046381    0.17205    0.33791    0.51164
    r4            0          0          0          0          0    0.046381    0.17205    0.33791    0.51164
    r5            0          0          0          0          0    0.046381    0.17205    0.33791    0.51164
    r746    0.88633    0.88548    0.88435    0.88337    0.88194     0.88041    0.87852    0.87629    0.87345
    r747    0.88645     0.8856    0.88447    0.88349    0.88206     0.88053    0.87867    0.87644    0.87373
    r748    0.88657    0.88575    0.88459    0.88361    0.88221     0.88068    0.87882    0.87659    0.87406
    r749     0.8867    0.88587    0.88474    0.88377    0.88233     0.88084    0.87897    0.87675    0.87437
    r750    0.88682    0.88599    0.88486    0.88389    0.88248     0.88096     0.8791     0.8769    0.87482</code></pre>
</div>
<div id="test-ff_vfi_az_bisec_vec-changing-risk-aversion" class="section level3">
<h3><span class="header-section-number">1.4.5</span> Test FF_VFI_AZ_BISEC_VEC Changing Risk Aversion</h3>
<p>Here, again, show fraction of coh saved in summary tabular form, but
also show it graphically.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {&#39;savefraccoh&#39;};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 9;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Solve the model with different risk aversion levels, higher preferences
for risk:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_crra&#39;) = 0.5;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 6.947134 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      2940.8    0.43567    0.26675    0.61228      0     0.74983

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7          c8         c9   
            _______    _______    _______    _______    _______    _______    _______    ________    _______

    r1            0          0          0          0          0          0          0    0.040155    0.17657
    r2            0          0          0          0          0          0          0    0.040155    0.17657
    r3            0          0          0          0          0          0          0    0.040155    0.17657
    r4            0          0          0          0          0          0          0    0.040155    0.17657
    r5            0          0          0          0          0          0          0    0.040155    0.17657
    r746    0.74928    0.74699    0.74427    0.74165    0.73826    0.73371    0.72828     0.72074    0.71244
    r747    0.74949    0.74711     0.7444    0.74195    0.73844    0.73405    0.72847     0.72096    0.71266
    r748    0.74958    0.74723    0.74452    0.74226     0.7386    0.73432    0.72865     0.72117    0.71287
    r749    0.74971    0.74736    0.74467    0.74241    0.73875    0.73451    0.72883     0.72139    0.71308
    r750    0.74983    0.74748    0.74491    0.74253     0.7389    0.73466    0.72905     0.72178     0.7133</code></pre>
<p><img src="img/fx_vfi_az_bisec_vec_images/figure_2.png" width="500" /></p>
<p><img src="img/fx_vfi_az_bisec_vec_images/figure_3.png" width="500" /></p>
<p>When risk aversion increases, at every state-space point, the household
wants to save more.</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_crra&#39;) = 5;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 6.425400 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN    sum      mean       std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ____    _______    ______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      4449    0.65911    0.2826    0.42876      0     0.92387

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8         c9   
            _______    _______    _______    _______    _______    _______    _______    _______    _______

    r1            0          0          0          0    0.05282    0.16466    0.31347    0.47728    0.63304
    r2            0          0          0          0    0.05282    0.16466    0.31347    0.47728    0.63304
    r3            0          0          0          0    0.05282    0.16466    0.31347    0.47728    0.63304
    r4            0          0          0          0    0.05282    0.16466    0.31347    0.47728    0.63304
    r5            0          0          0          0    0.05282    0.16466    0.31347    0.47728    0.63304
    r746    0.92341    0.92298    0.92249    0.92176    0.92097     0.9202     0.9191    0.91825    0.91926
    r747    0.92353     0.9231    0.92261    0.92188    0.92109    0.92033    0.91923     0.9184    0.91956
    r748    0.92365    0.92319    0.92271      0.922    0.92121    0.92045    0.91935    0.91852    0.91987
    r749    0.92377    0.92332    0.92283    0.92213    0.92133    0.92057     0.9195    0.91868    0.92014
    r750    0.92387    0.92344    0.92295    0.92225    0.92145    0.92069    0.91962     0.9188    0.92045</code></pre>
<p><img src="img/fx_vfi_az_bisec_vec_images/figure_4.png" width="500" /></p>
<p><img src="img/fx_vfi_az_bisec_vec_images/figure_5.png" width="500" /></p>
</div>
<div id="test-ff_vfi_az_bisec_vec-with-higher-uncertainty" class="section level3">
<h3><span class="header-section-number">1.4.6</span> Test FF_VFI_AZ_BISEC_VEC with Higher Uncertainty</h3>
<p>Increase the standard deviation of the Shock.</p>
<pre><code>mp_support = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_support(&#39;bl_print_params&#39;) = false;
mp_support(&#39;bl_print_iterinfo&#39;) = false;
mp_support(&#39;ls_ffcmd&#39;) = {&#39;savefraccoh&#39;};
mp_support(&#39;ls_ffsna&#39;) = {};
mp_support(&#39;ls_ffgrh&#39;) = {};
mp_params = containers.Map(&#39;KeyType&#39;,&#39;char&#39;, &#39;ValueType&#39;,&#39;any&#39;);
mp_params(&#39;it_a_n&#39;) = 750;
mp_params(&#39;it_z_n&#39;) = 9;
mp_params(&#39;fl_a_max&#39;) = 50;
mp_params(&#39;st_grid_type&#39;) = &#39;grid_powerspace&#39;;</code></pre>
<p>Lower standard deviation of shock:</p>
<pre><code>% Lower Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.10;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 6.784360 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean        std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    _______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      3617.7    0.53596    0.31083    0.57996      0     0.86482

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7          c8          c9   
            _______    _______    _______    _______    _______    _______    _______    ________    ________

    r1            0          0          0          0          0          0          0    0.034876    0.095147
    r2            0          0          0          0          0          0          0    0.034876    0.095147
    r3            0          0          0          0          0          0          0    0.034876    0.095147
    r4            0          0          0          0          0          0          0    0.034876    0.095147
    r5            0          0          0          0          0          0          0    0.034876    0.095147
    r746     0.8642    0.86359    0.86295    0.86192    0.86124     0.8603    0.85944     0.85835     0.85694
    r747    0.86436    0.86375    0.86314     0.8621     0.8614    0.86048     0.8596     0.85853     0.85712
    r748    0.86451     0.8639    0.86329    0.86225    0.86158     0.8607    0.85978     0.85871     0.85731
    r749    0.86466    0.86408    0.86344    0.86243    0.86173    0.86091    0.85996     0.85886     0.85755
    r750    0.86482    0.86424    0.86359    0.86259    0.86192    0.86112    0.86012     0.85905     0.85783</code></pre>
<p>Higher shock standard deviation: low shock high asset save more, high
shock more asset save less, high shock low asset save more:</p>
<pre><code>% Higher Risk Aversion
mp_params(&#39;fl_shk_std&#39;) = 0.40;
ff_vfi_az_bisec_vec(mp_params, mp_support);

Elapsed time is 7.804664 seconds.
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CONTAINER NAME: mp_ffcmd ND Array (Matrix etc)
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    ndim    numel    rowN    colN     sum       mean       std      coefvari    min      max  
                   _    ___    ____    _____    ____    ____    ______    ______    _______    ________    ___    _______

    savefraccoh    1     1      2      6750     750      9      4755.4    0.7045    0.26237    0.37241      0     0.95142

xxx TABLE:savefraccoh xxxxxxxxxxxxxxxxxx
              c1         c2         c3         c4         c5         c6         c7         c8         c9   
            _______    _______    _______    _______    _______    _______    _______    _______    _______

    r1            0          0          0          0          0      0.152    0.44643    0.71928    0.92841
    r2            0          0          0          0          0      0.152    0.44643    0.71928    0.92841
    r3            0          0          0          0          0      0.152    0.44643    0.71928    0.92841
    r4            0          0          0          0          0      0.152    0.44643    0.71928    0.92841
    r5            0          0          0          0          0      0.152    0.44643    0.71928    0.92841
    r746     0.8914    0.89054    0.88944    0.88798    0.88599    0.88279    0.87788    0.87836    0.95118
    r747    0.89146     0.8906     0.8895    0.88807    0.88609    0.88288      0.878    0.87879    0.95124
    r748    0.89152    0.89066    0.88956    0.88813    0.88615    0.88297    0.87812    0.87919     0.9513
    r749    0.89158    0.89072    0.88963    0.88819    0.88624    0.88306    0.87824    0.87962    0.95136
    r750    0.89164    0.89079    0.88972    0.88828     0.8863    0.88316    0.87833    0.88001    0.95142</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summarize-policy-and-value.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Matlab-Toolbox-Heterogeneous-Agents-Dynamic-Programming.pdf", "PDF"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
